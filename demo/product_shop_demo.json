{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"489530e0-f921-48c1-82d3-0a89219e070e","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7446e4ac-c000-4a55-968e-d504af79e80e","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"93708261-023c-421f-a884-3446fc73a290","$connId":"con_3","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c879c625-2b16-49dc-ab5a-7cf78fc0d000","$typeOfContent":"","type":"SetVariable","$title":"SET service","$invalid":false,"settings":{"variable":"service","value":"Parent Flow"},"conditions":[]},{"$id":"fba3979b-6c7d-4ef0-95af-7b5fae3b6d1a","$typeOfContent":"","type":"ExecuteScript","$title":"SET channel","$invalid":false,"settings":{"function":"run","source":"function run(contactIdentity) {\n    return getUserChannel(contactIdentity);\n}\n\nfunction getUserChannel(contactIdentity) {\n    const DEFAULT_CHANNEL = 'default';\n    const CHANNEL_INDEX = 1;\n\n    const CHANNEL_IDENTIFIERS = {\n        'wa.gw.msging.net': 'whatsapp',\n        '0mn.io': 'blipchat',\n        'take.io': 'takeSMS',\n        'messenger.gw.msging.net': 'facebook',\n        'instagram.gw.msging.net': 'instagram',\n        'abs.gw.msging.net': 'teams',\n        'businessmessages.gw.msging.net': 'gbm',\n        'skype.gw.msging.net': 'skype',\n        'telegram.gw.msging.net': 'telegram',\n        'workplace.gw.msging.net': 'workplace',\n        'mailgun.gw.msging.net': 'email',\n        'pagseguro.gw.msging.net': 'pagseguro'\n    };\n\n    let contactChannelId = contactIdentity.split('@')[CHANNEL_INDEX];\n\n    return CHANNEL_IDENTIFIERS[contactChannelId] || DEFAULT_CHANNEL;\n\n}","inputVariables":["contact.identity"],"outputVariable":"channel","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"notExists","variable":"channel"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-db0ff0af-0f94-4854-a117-19b761e96e4a","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-86cf3fa1-1ce5-4abf-9be1-85e0615b1fa6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7aad46ac-6f55-4243-8f7f-11086f21b58b","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"344.859px","left":"2624px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"656443dd-50cd-41be-a11c-451a9b4ad209","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"subflow:0ed7556a-b977-476c-ab4c-3412b3057f47","typeOfStateId":"state","$connId":"con_8","$id":"20e1b01a-febf-40fa-9e12-b8b79c7788a6","conditions":[{"source":"input","comparison":"notExists","values":[]}],"$invalid":false},{"stateId":"subflow:dc478d43-d47b-4237-9fe1-a044532c4bf2","typeOfStateId":"state","$connId":"con_13","$id":"ae28b29a-b277-4757-8cd4-a423077916e0","conditions":[{"source":"context","comparison":"notEquals","values":["default"],"variable":"apiError@id"}],"$invalid":false},{"stateId":"subflow:e8652e14-7b31-4903-84ce-ee8fefe25d2b","conditions":[{"source":"input","comparison":"matches","values":[".*"],"variable":"discardMultipleMessage"}],"$id":"532e483d-704e-4311-a1e3-be320a29c6cc","$connId":"con_18","$invalid":false}],"$enteringCustomActions":[{"$id":"fcf577f1-a74d-433d-b3ea-2944a9321133","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"function run(redirect, statePreviousName) {\n\tconst DEFAULT_ORIGIN =  `Parent Flow | ${statePreviousName}`;\n\n\ttry {\n\t\tif (redirect) {\n\t\t\tredirect = JSON.parse(redirect);\n\t\t\treturn `${redirect.from.service} | ${redirect.from.stateName}`\n\t\t}\n\n\t\treturn DEFAULT_ORIGIN;\n\t}\n\tcatch(e) {\n\t\treturn DEFAULT_ORIGIN;\n\t}\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"64391e04-b74e-4445-9bcd-d25a3c02306b","$typeOfContent":"","type":"TrackEvent","$title":"Inactivity origem","$invalid":false,"settings":{"extras":{},"category":"Inactivity origem","action":"{{origin}}"},"conditions":[{"values":[],"source":"input","comparison":"notExists"}]},{"$id":"a7776974-d1da-449d-b8bd-1d322c2630df","$typeOfContent":"","type":"TrackEvent","$title":"Api error origem","$invalid":false,"settings":{"extras":{},"category":"Api error origem","action":"{{origin}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"apiError@id"}]},{"$id":"5cc83915-2170-496c-a69d-8e4f513223a2","$typeOfContent":"","type":"TrackEvent","$title":"Exception origem","$invalid":false,"settings":{"extras":{},"category":"Exception origem","action":"{{origin}}"},"conditions":[{"values":[],"source":"input","comparison":"exists"},{"values":["default"],"source":"context","comparison":"equals","variable":"apiError@id"}]}],"$leavingCustomActions":[{"$id":"bbb04708-e510-4ac7-9203-950e8e4d57c1","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9db05b6a-639f-4547-b8a6-6c00251b71ac","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-988ad2fe-df42-4c50-9fd6-dec4437889cc","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-178128af-f59d-4000-9d69-5dcb6702c536","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"345px","left":"3786.54px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"error":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8bc01586-8ac5-4f7d-8154-0eab828cda11","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"705c309a-3494-4167-8f18-0a93d47d2247","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{redirect@to.stateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3799d274-560a-4afb-8e32-8fdbde56ce76","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"error","$title":"Return to last menu or Redirect","$position":{"top":"768.5px","left":"3786.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:e8652e14-7b31-4903-84ce-ee8fefe25d2b":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"427a7302-edb9-4fe9-83bf-a07e6e7f27c7","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"error","typeOfStateId":"state","$connId":"con_23","$id":"71be1fdf-8151-4256-b231-2d4b868b34d4","conditions":[{"source":"input","comparison":"exists","values":[],"variable":"subflow@isActive"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"cf8fc7c3-8977-4f26-ae9b-43644a72e5c5","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:e8652e14-7b31-4903-84ce-ee8fefe25d2b","action":"Entering subflow - subflow:e8652e14-7b31-4903-84ce-ee8fefe25d2b","subflowDefaultAction":true},"$invalid":false},{"$id":"823f5a0d-a79a-4888-8445-3ca400effbe3","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:e8652e14-7b31-4903-84ce-ee8fefe25d2b"},"subflowDefaultAction":true},"$invalid":false},{"$id":"9b2ce488-07cd-43c8-9a2a-952a1be65168","$typeOfContent":"","type":"ExecuteScript","$title":"SET exceptionMessage","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(\n\tsubflow, \n\tlastStateWithInput, \n\tlastSubflowStateWithInput\n) {\n\tconst origin = setOrigin({\n\t\tservice: 'Cascade',\n\t\tstateId: '{{state.id}}',\n\t\tstateName: '{{state.name}}'\n\t});\n\n\t// Handle input exception  inside a subflow\n\tif (subflow) {\n\t\tsubflow = JSON.parse(subflow);\n\n\t\tif (subflow.isActive) {\n\t\t\tlastSubflowStateWithInput = JSON.parse(lastSubflowStateWithInput);\n\n\t\t\tconst destination = setDestination({\n\t\t\t\tstateId: subflow.id,\n\t\t\t\tstateName:  subflow.name,\n\t\t\t\tsubflowStateName: lastSubflowStateWithInput.name,\n\t\t\t\tsubflowStateId: lastSubflowStateWithInput.id\n\t\t\t});\n\n\t\t\treturn redirect(origin, destination, { skipCallerMessageSave: true }); \n\t\t}\n\t}\n\n\t// Handle input exception on parent flow\n\tlastStateWithInput = JSON.parse(lastStateWithInput);\n\n\tconst destination = setDestination({\n\t\tservice: 'Parent Flow',\n\t\tstateId: lastStateWithInput.id\n\t});\n\n\treturn redirect(origin, destination);\n}","inputVariables":["subflow","lastStateWithInput","lastSubflowStateWithInput"],"outputVariable":"exceptionMessage","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"fe74fb34-640e-4def-af51-524ad88fa8f3","$typeOfContent":"","type":"SetVariable","$title":"SET onCascadeHandling = true","$invalid":false,"settings":{"variable":"onCascadeHandling","value":"true"},"conditions":[]},{"$id":"12132b40-c2ed-4457-8de8-18bed87e1ff8","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"variable":"message","value":"{{redirect}}"},"conditions":[]},{"$id":"18ba06fb-dcc4-4d31-b271-aa17185f1564","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"21379887-97b8-42da-a138-392760331597","$typeOfContent":"","type":"SetVariable","$title":"SET onCascadeHandling = false","$invalid":false,"settings":{"variable":"onCascadeHandling","value":"false"},"conditions":[]},{"$id":"83ba57d0-9283-468b-8878-3d399910ba39","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e61d8887-b606-49bf-bcd4-03273c016a9e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-74e2e52e-ad9d-4091-9057-6220874802a7","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-567a1d33-aec6-4923-b392-10c891e97f4a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-bc1c0a74-fdaa-4ac2-aaf7-7b3594024608","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-31e637d0-6780-4dbd-95ed-3a1c1f9c0b6d","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:e8652e14-7b31-4903-84ce-ee8fefe25d2b","root":false,"shortNameOfSubflow":"inputhandler2","$imageUri":"https://blipmediastore.blip.ai/public-medias/Media_7f891c19-0211-469f-9fd2-2fe8ad41035d","$title":"Input Handler","$position":{"top":"513.5px","left":"3761.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:dc478d43-d47b-4237-9fe1-a044532c4bf2":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"25caec9f-d379-4974-8ccd-49483f1bd776","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"error","typeOfStateId":"state","$connId":"con_28","$id":"c0de757f-b797-42a4-b960-9ebd03971c74","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"2c8b88f4-6bfb-4784-9b16-a9941260e5ef","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:dc478d43-d47b-4237-9fe1-a044532c4bf2","action":"Entering subflow - subflow:dc478d43-d47b-4237-9fe1-a044532c4bf2","subflowDefaultAction":true},"$invalid":false},{"$id":"74e59008-f3e5-48a6-805b-c43c18792b8b","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:dc478d43-d47b-4237-9fe1-a044532c4bf2"},"subflowDefaultAction":true},"$invalid":false},{"$id":"27851fee-d11c-4653-b904-93ac0feb0211","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"variable":"message","value":"{{redirect}}"},"conditions":[]},{"$id":"3ae06673-3b8d-47c6-9737-b8dc0f99a56d","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"fbb92754-d508-411f-b2bb-9ee599ad6f47","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e2b4155e-1e1d-48c5-9795-ed24af1d2250","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-4fa04817-5f1a-444f-a32e-22ca7f1992f9","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-f607dddb-6bf2-4a00-b5c1-0c5a605ce8da","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-7a9bf804-dccc-4d18-ab98-33035581a768","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:dc478d43-d47b-4237-9fe1-a044532c4bf2","root":false,"shortNameOfSubflow":"apierrorhandler2","$imageUri":"","$title":"API Error Handler","$position":{"top":"516.5px","left":"4080.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:29f820b7-df92-4461-9987-46f0acaefc5b":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"a39b1c62-4668-446b-b1fc-1505fa39f19a","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{redirect@to.stateId}}","typeOfStateId":"variable","$id":"31af9e43-1bd0-4256-822e-d152717f079b","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"redirect@to.stateId"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6e3c3005-16c3-40c9-91ed-bee32027f0cc","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:29f820b7-df92-4461-9987-46f0acaefc5b","action":"Entering subflow - subflow:29f820b7-df92-4461-9987-46f0acaefc5b","subflowDefaultAction":true},"$invalid":false},{"$id":"936933d2-5b62-4c39-8cd6-3f95dd6557a5","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:29f820b7-df92-4461-9987-46f0acaefc5b"},"subflowDefaultAction":true},"$invalid":false},{"$id":"b5118a50-0cfc-4977-8556-d36e563f4370","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn enableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e392a959-28ff-4005-ac7f-829997fbb612","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(redirect, statePreviousName) {\n\treturn getOrigin(redirect, statePreviousName);\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5246f03e-6c29-4501-8a07-fd7ac4974bde","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"variable":"message","value":"{{redirect}}"},"conditions":[]},{"$id":"9f273ae4-173c-41c9-8f43-67fba9cab3c8","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"77c85c90-0d03-4c17-b778-94ab78d10151","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]},{"$id":"e6c848b2-1c87-4e3c-950d-6dbce56051f0","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3dad0085-890c-4a2e-b8fa-f378f9ad6314","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-78c8a779-5dfc-4fca-a75a-a30cdef3c785","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-3e66dfd4-d6db-4a33-8ecc-dd4a07074e23","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d21f0db7-5175-4580-85fd-5983ada07e66","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-3fa9dde2-a8d0-4016-8f96-2222f1ceb79a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:29f820b7-df92-4461-9987-46f0acaefc5b","root":false,"shortNameOfSubflow":"finalization2","$imageUri":"","$title":"Finalization","$position":{"top":"1189.63px","left":"3754px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:6588850e-97a3-4619-b2b7-5e7f6e9ee29c":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"23c864df-7d85-4249-a7e1-62cfd5d824e7","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{redirect@to.stateId}}","typeOfStateId":"variable","$id":"e553450c-8dae-4fec-ad52-5a6a451d3a8f","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"redirect@to.stateId"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"9d1e80cf-cf36-4f9f-8139-1673f6c16af6","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:6588850e-97a3-4619-b2b7-5e7f6e9ee29c","action":"Entering subflow - subflow:6588850e-97a3-4619-b2b7-5e7f6e9ee29c","subflowDefaultAction":true},"$invalid":false},{"$id":"62bda319-4eab-4866-ab0f-fab0c454ff7b","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:6588850e-97a3-4619-b2b7-5e7f6e9ee29c"},"subflowDefaultAction":true},"$invalid":false},{"$id":"67a4f7db-e720-4c23-8b1c-e3696c10f6a7","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn enableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"549961c3-7fec-41ab-bde7-de6c25583e1d","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(redirect, statePreviousName) {\n\treturn getOrigin(redirect, statePreviousName);\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"13f7e024-0882-4d1f-9251-47b2308afb7c","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"variable":"message","value":"{{redirect}}"},"conditions":[]},{"$id":"75a70ed2-6fe0-46b5-82c5-4c0d8685f7e9","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"3abf8407-08d9-4936-8a8f-a2931382b728","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]},{"$id":"c7b42b22-7028-4cff-ab42-9365457683b0","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cd55a13c-2fc3-4af3-b114-f68713be9880","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-72256103-3707-43d1-9f55-f2b128d100d3","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-c7a20555-3c73-471c-9e9e-efe4b12f555f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2e3b08b9-d1d0-45c0-97dd-4ae269a2f999","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0a8204b6-7582-43ee-85db-b99f3d4d7a2d","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:6588850e-97a3-4619-b2b7-5e7f6e9ee29c","root":false,"shortNameOfSubflow":"desk4","$imageUri":"https://blipmediastore.blip.ai/public-medias/Media_b13ed154-2d3e-4eb8-9c09-813f1c392d1c","$title":"Desk","$position":{"top":"1418px","left":"3754px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7446e4ac-c000-4a55-968e-d504af79e80e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c8af1115-7516-49f3-8cce-bf1897a24727","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"subflow:9f0f74c3-5b50-46ba-af50-7fcd3a3f1181","typeOfStateId":"state","$connId":"con_33","$id":"5b3b5535-db18-4890-a89a-63059e2ab43b","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"f3e2d753-d346-416a-a5ef-53e6ed653395","$typeOfContent":"","type":"ExecuteScript","$title":"SET entrypoint","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input, entrypoints) {\n\treturn verifyEntrypoints(input, entrypoints);\n}","inputVariables":["input.content","entrypoints"],"outputVariable":"entrypoint","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"60d22183-ee11-446c-963c-6ec3819cb882","$typeOfContent":"","type":"ExecuteScript","$title":"UPDATE session","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(session, entrypoint, inputContent) {\n\ttry {\n\t\tconst origin = 'Principal';\n\n\t\treturn updateSession(\n\t\t\tsession, \n\t\t\tentrypoint, \n\t\t\tinputContent,\n\t\t\torigin\n\t\t);\n\t} catch(e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["session","entrypoint","input.content"],"outputVariable":"session","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"subflow:9f0f74c3-5b50-46ba-af50-7fcd3a3f1181","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f3b55cc5-f1ed-42ee-89e1-0ee61685fd3d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"7446e4ac-c000-4a55-968e-d504af79e80e","root":false,"$title":"Verify entrypoints and save session","$position":{"top":"493px","left":"2624px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"subflow:50d68e92-815c-4421-b0a8-236d31f52afb":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"d5a59cc7-9908-4521-a319-a1d1c6b63dc9","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{redirect@to.stateId}}","typeOfStateId":"variable","$id":"57edacf7-4581-42a9-911e-d0b2a5093e36","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"redirect@to.stateId"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"4786f5f5-bb95-4c78-9b5f-69734ae692d6","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:50d68e92-815c-4421-b0a8-236d31f52afb","action":"Entering subflow - subflow:50d68e92-815c-4421-b0a8-236d31f52afb","subflowDefaultAction":true},"$invalid":false},{"$id":"acc35fe8-f444-450f-a587-2415825611a9","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:50d68e92-815c-4421-b0a8-236d31f52afb"},"subflowDefaultAction":true},"$invalid":false},{"$id":"e9fba353-8351-45de-904a-05dd624a7040","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn enableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"37f20519-a3e6-4dcf-9ebe-85ae9fd02fed","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(redirect, statePreviousName) {\n\treturn getOrigin(redirect, statePreviousName);\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c831417a-0cbb-4638-a854-44adf3caa726","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"variable":"message","value":"{{redirect}}"},"conditions":[]},{"$id":"96a1ee7b-128f-46e0-bb93-387e35a1f93f","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"7e38ffe5-b5d9-4183-80e7-baba5e7b5719","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]},{"$id":"3bc69957-ec0f-4cab-a339-88c3a7788edc","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-94615c3f-c4b0-49e6-8534-1ba349c866d8","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-60c2ef1d-28d6-487c-974a-8c55ef82d52b","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-f456c664-2201-41f6-b4d6-b4bd55b2e3a6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-1eb6f3ab-d255-4e70-9bdc-f4f252dc5a0f","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-8baabf86-762b-4664-9cb9-42170f929717","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:50d68e92-815c-4421-b0a8-236d31f52afb","root":false,"shortNameOfSubflow":"entrypoints3","$imageUri":"https://blipmediastore.blip.ai/public-medias/Media_714a50b3-1f78-4a9a-bde1-2c179baa391d","$title":"Entrypoints","$position":{"top":"1654px","left":"3755px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:0ed7556a-b977-476c-ab4c-3412b3057f47":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"4e9d6a6a-e377-4088-b226-0fddab076927","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"error","typeOfStateId":"state","$connId":"con_38","$id":"16192eb9-91ac-48d5-9f5a-c55549870696","conditions":[{"source":"context","comparison":"equals","values":["false"],"variable":"subflow@isActive"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"da78d92b-2648-4fed-a285-6a2020a049f2","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:0ed7556a-b977-476c-ab4c-3412b3057f47","action":"Entering subflow - subflow:0ed7556a-b977-476c-ab4c-3412b3057f47","subflowDefaultAction":true},"$invalid":false},{"$id":"b0f99591-78d2-45bd-9929-7b64e96fa7fc","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:0ed7556a-b977-476c-ab4c-3412b3057f47"},"subflowDefaultAction":true},"$invalid":false},{"$id":"096ddb59-e42d-4a4f-9694-edd3764ce8c6","$typeOfContent":"","type":"ExecuteScript","$title":"SET inactivityMessage (Don't change the order)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(\n\tsubflow, \n\tlastStateWithInput, \n\tlastSubflowStateWithInput\n) {\n\tconst origin = setOrigin({\n\t\tservice: 'Inactivity',\n\t\tstateId: '{{state.id}}',\n\t\tstateName: '{{state.name}}'\n\t});\n\n\t// Handle inactivity inside a subflow\n\tif (subflow) {\n\t\tsubflow = JSON.parse(subflow);\n\n\t\tif (subflow.isActive) {\n\t\t\tlastSubflowStateWithInput = JSON.parse(lastSubflowStateWithInput);\n\n\t\t\tconst destination = setDestination({\n\t\t\t\tstateId: subflow.id,\n\t\t\t\tstateName:  subflow.name,\n\t\t\t\tsubflowStateName: lastSubflowStateWithInput.name,\n\t\t\t\tsubflowStateId: lastSubflowStateWithInput.id\n\t\t\t});\n\n\t\t\treturn redirect(origin, destination, { skipCallerMessageSave: true }); \n\t\t}\n\t}\n\n\t// Handle inactivity on parent flow\n\tlastStateWithInput = JSON.parse(lastStateWithInput);\n\t\n\tconst destination = setDestination({\n\t\tservice: 'Parent Flow',\n\t\tstateName: lastStateWithInput.name,\n\t\tstateId: lastStateWithInput.id\n\t});\n\n\treturn redirect(origin, destination);\n}","inputVariables":["subflow","lastStateWithInput","lastSubflowStateWithInput"],"outputVariable":"inactivityMessage","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"input","comparison":"notExists"}]},{"$id":"7f808db1-a4bc-43e5-ab96-0a0c4e6ededf","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\r\n\r\nfunction run(stateId, stateName) {\r\n\treturn enableSubflowMode(stateId, stateName);\r\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"71b7d452-b570-458c-a706-e1b11a984975","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"variable":"message","value":"{{redirect}}"},"conditions":[]},{"$id":"4d8c6e61-0e07-4bbe-bbd6-9829f7201432","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"2c029318-e2eb-4b4a-b7bf-27931d2324fc","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f63aed35-f4cd-4aa0-ac83-89287f922b17","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-cb86e99f-14e1-4c4c-ad8c-cfc4691c2372","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-6fa2c331-e0aa-4c74-a3c5-a7fe44a88222","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-879de0d0-d365-4ddf-b525-cb43aafcc17d","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-b2b91ee7-abad-485d-b9d6-3763aa36061c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:0ed7556a-b977-476c-ab4c-3412b3057f47","root":false,"shortNameOfSubflow":"inactivityhandler3","$imageUri":"","$title":"Inactivity Handler","$position":{"top":"516.5px","left":"3448.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7f2feee4-c5b0-4d7c-b77a-91f6ce6a771b":{"$contentActions":[{"action":{"$id":"8b1386da-2a45-4815-81e4-18a742136d1e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6e010aef-0d2d-40ba-a98a-b82d2f872841","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"6e010aef-0d2d-40ba-a98a-b82d2f872841","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ac75a2d9-39fc-4110-9d0d-56ad5c2fdffb","$typeOfContent":"text","type":"SendMessage","settings":{"id":"5763c37a-80a9-4866-9784-fef8863bb6e9","type":"text/plain","content":"We had an internal error. Please try again later.","metadata":{}},"$cardContent":{"document":{"id":"5763c37a-80a9-4866-9784-fef8863bb6e9","type":"text/plain","content":"We had an internal error. Please try again later."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"1c68c4b9-bc0b-4259-ab08-4136c48e6820","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7f447a23-7d33-4f94-8ad1-a02b2efa6f79","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"7f2feee4-c5b0-4d7c-b77a-91f6ce6a771b","root":false,"$title":"Redirect Error","$position":{"top":"351.5px","left":"4103.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:1d273c53-0ffd-4882-897b-3686ba8a0ca5":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"37826116-7943-4589-ac4a-87288398cb78","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{redirect@to.stateId}}","typeOfStateId":"variable","$id":"2de174d6-ece3-4ae7-8bdd-2d5bc4b1754a","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"redirect@to.stateId"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"cfca849d-6092-4dd5-b958-5df0efaefd54","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:1d273c53-0ffd-4882-897b-3686ba8a0ca5","action":"Entering subflow - subflow:1d273c53-0ffd-4882-897b-3686ba8a0ca5","subflowDefaultAction":true},"$invalid":false},{"$id":"ad102e47-7d3f-4312-8682-b209619b55bb","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:1d273c53-0ffd-4882-897b-3686ba8a0ca5"},"subflowDefaultAction":true},"$invalid":false},{"$id":"943570cd-9faf-4311-a3a7-e2d1fd5bc807","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn enableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"40715ead-5822-4b50-aa27-d5f919315ad5","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(redirect, statePreviousName) {\n\treturn getOrigin(redirect, statePreviousName);\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6ad0326c-6394-44c8-a84f-aec929b1ab29","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"variable":"message","value":"{{redirect}}"},"conditions":[]},{"$id":"8e6c9e5e-0d7e-48cf-b22e-9c08e9ef5ef3","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"ee28d32a-291c-42e5-8bef-aed305c1c4c5","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]},{"$id":"f9aa4fc2-a095-41ed-91cc-405c2fd22d0c","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c1ea3345-5613-4dd0-ba2a-1f7fb93cb00a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-3aee10b8-489e-47dc-adc9-ba958a110987","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-25c9a6d1-5744-414d-b70c-84ce2e59592d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-786011ab-784d-4f70-9d45-8e22beb709db","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-76feff9b-f92c-46f9-bdb0-a5c78229923e","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:1d273c53-0ffd-4882-897b-3686ba8a0ca5","root":false,"shortNameOfSubflow":"algomais4","$imageUri":"","$title":"Pre Finalization","$position":{"top":"960.563px","left":"3752.96px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:9f0f74c3-5b50-46ba-af50-7fcd3a3f1181":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"77cf1bbe-7071-48bb-b93f-d774c16431cc","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{redirect@to.stateId}}","typeOfStateId":"variable","$id":"7f103d45-fd49-4431-b22d-21bbb1a32743","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"redirect@to.stateId"}],"$invalid":false},{"stateId":"{{subflowIds@Entrypoints}}","typeOfStateId":"variable","$id":"6b4fede5-1b61-47ec-8d41-081d0059aa6c","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"entrypoint@matched"}],"$invalid":false},{"stateId":"subflow:76ebc8e8-e46e-4661-a013-172a130d5b22","typeOfStateId":"state","$connId":"con_43","$id":"f0b04069-a1e2-44b9-bbf7-3536bc10e89a","conditions":[{"source":"context","comparison":"equals","values":["false"],"variable":"subflow@isActive"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"8d1e7d89-baff-497b-81d3-4980d0570b4a","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:9f0f74c3-5b50-46ba-af50-7fcd3a3f1181","action":"Entering subflow - subflow:9f0f74c3-5b50-46ba-af50-7fcd3a3f1181","subflowDefaultAction":true},"$invalid":false},{"$id":"cd4337b7-e0ba-4143-a230-d1b4dfe841ac","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:9f0f74c3-5b50-46ba-af50-7fcd3a3f1181"},"subflowDefaultAction":true},"$invalid":false},{"$id":"b27eb0b2-a5c3-4da7-acec-4df5ec9b4480","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn enableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b67ad16e-2d0f-4731-a2f9-93104e34b358","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(redirect, statePreviousName) {\n\treturn getOrigin(redirect, statePreviousName);\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"77634b3d-cbd2-427a-adb9-78b1d4662032","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"value":"{{redirect}}","variable":"message"},"conditions":[]},{"$id":"78b12c7b-a57c-4b11-a9f9-3637b475d37a","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"1e0b43dd-f7c6-4d59-9755-edd16950fa04","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]},{"$id":"87b88125-708d-474c-af63-ac12a5004e2c","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-77ceed98-eb91-4995-8429-56a347aa5f22","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-1d69b34a-cd49-4de3-a78a-e00cf89b4166","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-8a0fee5d-b5fb-4d27-b541-dd7f9dbb1350","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-4a38c81d-4b43-421c-b974-c31af5411cb8","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0da85510-7b2b-4bd5-b5d4-67c83d4a73fe","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:9f0f74c3-5b50-46ba-af50-7fcd3a3f1181","root":false,"shortNameOfSubflow":"onboardingcc1","$imageUri":"","$title":"Onboarding","$position":{"top":"651.549px","left":"2599px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:76ebc8e8-e46e-4661-a013-172a130d5b22":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"c7579e42-0d07-44ee-a732-6094b5cdb675","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{redirect@to.stateId}}","typeOfStateId":"variable","$id":"8d8fbe9f-8674-43b0-b9a3-53c7567b12b0","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"redirect@to.stateId"}],"$invalid":false},{"stateId":"8d7307d7-94fa-434b-b6a6-2039f2298251","typeOfStateId":"state","$connId":"con_48","$id":"425843ad-3b12-4a29-9ba5-3b268113caf2","conditions":[{"source":"context","comparison":"equals","values":["false"],"variable":"subflow@isActive"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"d970e50a-daf3-4f98-9607-5e399494f92f","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:76ebc8e8-e46e-4661-a013-172a130d5b22","action":"Entering subflow - subflow:76ebc8e8-e46e-4661-a013-172a130d5b22","subflowDefaultAction":true},"$invalid":false},{"$id":"8fa6d816-143e-483f-9e34-fae1ab00b6a3","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:76ebc8e8-e46e-4661-a013-172a130d5b22"},"subflowDefaultAction":true},"$invalid":false},{"$id":"dd2dd639-5703-4f6d-8818-d93fd224603e","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn enableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"243ddf54-70a4-4a47-96fb-c430ef155a00","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(redirect, statePreviousName) {\n\treturn getOrigin(redirect, statePreviousName);\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"15abc123-af43-4661-abda-a41e35abff84","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"value":"{{redirect}}","variable":"message"},"conditions":[]},{"$id":"39637ded-bc3b-4864-be8a-e80cd633c445","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"e3dec082-1cac-456b-b8a7-6ef3e612965c","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]},{"$id":"84fbe15d-c9f4-4cfc-a413-bd5db7e0c1b9","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-37024a63-fc31-4954-866e-dad40ac5e4a5","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-f7c8fdd4-f923-4292-b7fc-d39e07a9b805","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-66acc735-ff39-45b5-968d-824f0624ae7f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ce4c690e-3218-4fb1-8491-b28bee556b05","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-52b787d6-93cb-438a-ba24-e2aac60a59fe","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:76ebc8e8-e46e-4661-a013-172a130d5b22","root":false,"shortNameOfSubflow":"mainmenu2","$imageUri":"","$title":"Main Menu","$position":{"top":"902px","left":"2599px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8d7307d7-94fa-434b-b6a6-2039f2298251":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a5403fc0-cc84-47eb-8fe3-5ebda2b5d53c","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"subflow:0b9aafef-6e82-47a7-8e28-e49acc44c4f3","typeOfStateId":"state","$connId":"con_53","$id":"bd509b69-421a-414b-b2d5-fe1961552a47","conditions":[{"source":"context","comparison":"equals","values":["Eletronics"],"variable":"selectedOption"}],"$invalid":false},{"stateId":"subflow:03ed9fe0-d284-4105-aa4d-ba8f7b381699","typeOfStateId":"state","$connId":"con_58","$id":"7247ff6e-7516-4963-9445-994f6ef233b1","conditions":[{"source":"context","comparison":"equals","values":["Pet Supplies"],"variable":"selectedOption"}],"$invalid":false},{"stateId":"subflow:2c25d536-338c-48f9-8cc0-3a43362cb151","typeOfStateId":"state","$connId":"con_63","$id":"aaf026ba-9e61-4fc1-a9d5-c508702ce43a","conditions":[{"source":"context","comparison":"equals","values":["Movies & Television"],"variable":"selectedOption"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"8d7307d7-94fa-434b-b6a6-2039f2298251","root":false,"$title":"Main Menu Router","$position":{"top":"1175px","left":"2624px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:0b9aafef-6e82-47a7-8e28-e49acc44c4f3":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"908633a5-4ca4-4c4b-aeaf-4dec0c0365f9","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{redirect@to.stateId}}","typeOfStateId":"variable","$id":"6073b800-6001-4dea-92d7-c2d7957b81d7","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"redirect@to.stateId"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"4455ff5b-f083-4f95-a359-d0eb6ba55ee2","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:0b9aafef-6e82-47a7-8e28-e49acc44c4f3","action":"Entering subflow - subflow:0b9aafef-6e82-47a7-8e28-e49acc44c4f3","subflowDefaultAction":true},"$invalid":false},{"$id":"dbdfe548-b671-4c96-9219-5adce767f38e","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:0b9aafef-6e82-47a7-8e28-e49acc44c4f3"},"subflowDefaultAction":true},"$invalid":false},{"$id":"c1640e96-5eb2-4c88-8cfa-d2ef9a26e01f","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn enableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"0c15a654-957d-44ce-a472-c4e27b36a933","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(redirect, statePreviousName) {\n\treturn getOrigin(redirect, statePreviousName);\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"aaf93bf7-ef0f-4775-bb71-d5a0545cb8d1","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"value":"{{redirect}}","variable":"message"},"conditions":[]},{"$id":"26321fbf-93d6-4181-a71e-fa87f5474e18","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"1544cf1f-d446-43d7-874a-bf23fab324cb","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]},{"$id":"ff55a58c-a0a5-43e9-8bf3-1e82bcc6ea4f","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c1e044bc-42ce-42bd-a6b4-3ffa1548031e","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-2d41678d-8dbd-4240-9ce2-38b8de773d51","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-f4a42282-c0cb-4d53-8645-c63087995229","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d559b426-7245-473e-90ee-0efa6c99bc9c","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-1450489c-8951-4bb5-9fac-bccc66881732","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:0b9aafef-6e82-47a7-8e28-e49acc44c4f3","root":false,"shortNameOfSubflow":"eletronics","$imageUri":"","$title":"Eletronics","$position":{"top":"1110.94px","left":"2273.82px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:03ed9fe0-d284-4105-aa4d-ba8f7b381699":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"bca41c7d-b794-4794-8724-3dfee9469468","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{redirect@to.stateId}}","typeOfStateId":"variable","$id":"df1b8469-2284-49f2-9302-5e58562a3f28","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"redirect@to.stateId"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"8a62bc70-ca1f-4c29-9a2f-6c0aef1852cf","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:03ed9fe0-d284-4105-aa4d-ba8f7b381699","action":"Entering subflow - subflow:03ed9fe0-d284-4105-aa4d-ba8f7b381699","subflowDefaultAction":true},"$invalid":false},{"$id":"be4810e0-7b30-4d0f-951d-1c99b9dfbd66","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:03ed9fe0-d284-4105-aa4d-ba8f7b381699"},"subflowDefaultAction":true},"$invalid":false},{"$id":"a57c3a2a-3bef-4350-9574-d9a01ea5b396","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn enableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"d259059e-a124-4abb-a4d2-4e463ad9e240","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(redirect, statePreviousName) {\n\treturn getOrigin(redirect, statePreviousName);\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e154956c-dc07-4319-afd0-9d3395042b71","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"value":"{{redirect}}","variable":"message"},"conditions":[]},{"$id":"5f550a37-1dbc-4315-a50c-7689192c86a8","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"6514b9f3-c6b4-44e1-90e3-add4f5678072","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]},{"$id":"e4575d59-4a34-4508-a51d-30413210bb93","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6e72a5fc-0ce2-4e71-811f-70a99e9f1afe","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-ecb61e75-0c32-4c7d-b7dc-3a56d43a9964","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-ee696589-7417-4d36-8230-6c351f30a9be","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ef8f71d6-0d60-4844-a583-d4802ae7ec52","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-a65ad9bf-b4ec-4b7b-800a-0db18af27eb8","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:03ed9fe0-d284-4105-aa4d-ba8f7b381699","root":false,"shortNameOfSubflow":"petsupplies","$imageUri":"","$title":"Pet Supplies","$position":{"top":"1302.58px","left":"2599px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:2c25d536-338c-48f9-8cc0-3a43362cb151":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"636d1ea2-0c7a-4aea-ab06-4be5d8c048ef","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{redirect@to.stateId}}","typeOfStateId":"variable","$id":"7d56bc2e-a1e8-4f26-adf1-c4130e3e6d3f","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"redirect@to.stateId"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"ecde1f95-1ae7-4075-a04c-495c35301edc","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:2c25d536-338c-48f9-8cc0-3a43362cb151","action":"Entering subflow - subflow:2c25d536-338c-48f9-8cc0-3a43362cb151","subflowDefaultAction":true},"$invalid":false},{"$id":"eef17c86-74b4-43ff-b031-88f6fe7e9d97","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:2c25d536-338c-48f9-8cc0-3a43362cb151"},"subflowDefaultAction":true},"$invalid":false},{"$id":"f0bd4c6b-1816-4c28-b338-83def73a848a","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn enableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"da0c3cc8-da6e-4e91-b436-04c096bbdd36","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(redirect, statePreviousName) {\n\treturn getOrigin(redirect, statePreviousName);\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e5f1712d-dc78-4ce9-aa49-cb5153ace5a8","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"value":"{{redirect}}","variable":"message"},"conditions":[]},{"$id":"27f2ba88-ae82-41ca-813e-58990f804c9b","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"3866696c-9227-46d3-9324-d1e1ede825a0","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]},{"$id":"4934c323-3daf-4841-8936-d142f636dba7","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7dc8c3f2-4c0c-4670-ac8d-8349f99f80e1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-9e523185-9e9f-4c50-ae60-4731c5a799b1","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-87521f81-7356-452a-89ac-7c9aec907287","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-0c75178a-0ef2-45c6-88b6-90ebd29e4b45","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-ab7aa3c0-d6b9-475e-a7d1-7d453f112d92","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:2c25d536-338c-48f9-8cc0-3a43362cb151","root":false,"shortNameOfSubflow":"moviestelevision","$imageUri":"","$title":"Movies & Television","$position":{"top":"1110.94px","left":"2947.18px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:5d7cfe68-dd73-4ebb-8425-44b9ae52c753":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"01937008-7084-4811-bdd1-6e210745a618","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{redirect@to.stateId}}","typeOfStateId":"variable","$id":"40808246-f282-489d-8647-946fe58fdf73","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"redirect@to.stateId"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"8ceb14b4-01c4-4fe2-9403-7df30e19fb6c","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:5d7cfe68-dd73-4ebb-8425-44b9ae52c753","action":"Entering subflow - subflow:5d7cfe68-dd73-4ebb-8425-44b9ae52c753","subflowDefaultAction":true},"$invalid":false},{"$id":"8eb0313c-e041-4056-908b-4f09d6ab65b9","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:5d7cfe68-dd73-4ebb-8425-44b9ae52c753"},"subflowDefaultAction":true},"$invalid":false},{"$id":"9c126dc4-42e8-49c6-b9e8-51ff70d1eaa8","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn enableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"fe9eac58-e51b-4cd2-a23d-3a93b283860c","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(redirect, statePreviousName) {\n\treturn getOrigin(redirect, statePreviousName);\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"afb2d8ab-0ea6-4b5e-95d7-99aab36dd866","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"value":"{{redirect}}","variable":"message"},"conditions":[]},{"$id":"c461f2f8-1d87-44fa-92da-b0dc86902e84","$typeOfContent":"","type":"SetVariable","$title":"SET callerMessage","$invalid":false,"settings":{"variable":"callerMessage","value":"{{redirect}}"},"conditions":[{"values":["true"],"source":"context","comparison":"notEquals","variable":"redirect@skipCallerMessageSave"}]},{"$id":"a83a61eb-0d23-4fe4-a7be-fda6c32bafb0","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"4a46ebd5-79a9-45da-8359-02a97a7f759d","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]},{"$id":"f9cd758e-befa-42e0-94d8-dea18a995710","$typeOfContent":"","type":"SetVariable","$title":"RESET callerMessage","$invalid":false,"settings":{"variable":"callerMessage"},"conditions":[]},{"$id":"a83c27cf-5b47-4723-963f-73c06bbb8a1d","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-42ebc02d-31c7-4cdc-9772-8eae83d965cd","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-627017f3-6da0-40c9-a1cf-3cd464695fcd","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-e1a1a45d-92a0-41cc-9eb6-3190282b644e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-773f1b48-d6c9-49ed-ba1b-7d0793a99801","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-0571b4f9-72b0-4f3e-993f-755dfabfa5a2","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:5d7cfe68-dd73-4ebb-8425-44b9ae52c753","root":false,"shortNameOfSubflow":"productconfirmation","$imageUri":"","$title":"Product Confirmation","$position":{"top":"1597px","left":"2465px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflow:69c42812-ead3-49b1-9f9e-ac7af0055208":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"1d6b5f14-ad0a-4090-b53e-83b027f149f4","type":"text/plain","textContent":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{redirect@to.stateId}}","typeOfStateId":"variable","$id":"d1c666cd-71b0-4488-9f9d-376f5bbb2991","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"redirect@to.stateId"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"01c0e911-3663-4c46-8a4a-fee435cd8cc2","$typeOfContent":"","type":"TrackEvent","$title":"TrackEvent","settings":{"category":"subflow:69c42812-ead3-49b1-9f9e-ac7af0055208","action":"Entering subflow - subflow:69c42812-ead3-49b1-9f9e-ac7af0055208","subflowDefaultAction":true},"$invalid":false},{"$id":"422a8193-4e2b-466f-bc43-40633301f16d","$typeOfContent":"","type":"MergeContact","$title":"MergeContact","settings":{"extras":{"subflowId":"subflow:69c42812-ead3-49b1-9f9e-ac7af0055208"},"subflowDefaultAction":true},"$invalid":false},{"$id":"47eddf49-072d-43e5-b191-9ab79761d411","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (enable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn enableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"d432e2d7-7c3a-43bf-b2ed-e32a3dee9e93","$typeOfContent":"","type":"ExecuteScript","$title":"SET origin","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(redirect, statePreviousName) {\n\treturn getOrigin(redirect, statePreviousName);\n}","inputVariables":["redirect","state.previous.name"],"outputVariable":"origin","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"06517be9-9baa-4db9-aef1-41e1724c954f","$typeOfContent":"","type":"SetVariable","$title":"SET message","$invalid":false,"settings":{"value":"{{redirect}}","variable":"message"},"conditions":[]},{"$id":"7770f60b-5386-4aa3-bf36-a625a237fe76","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]}],"$leavingCustomActions":[{"$id":"f389728c-116b-462d-a0e4-e94fca5f145a","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message"},"conditions":[]},{"$id":"686116b4-c6d3-4549-b492-ee298a83482e","$typeOfContent":"","type":"SetVariable","$title":"RESET origin","$invalid":false,"settings":{"variable":"origin"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-717878e1-2d6b-4352-b783-0e8610ef6135","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-7f856cd4-46a3-4b20-8d05-7624ce3484ad","label":"MergeContact","background":"#FF1E90","canChangeBackground":false},{"id":"blip-tag-7177d9cc-b2ca-440d-aae3-23554d0a1f04","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-7c43b0b5-678b-4a7d-a9fb-298a42a5c85f","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-c41d313e-37b7-4b2d-82c5-0517baac8bb4","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"subflow:69c42812-ead3-49b1-9f9e-ac7af0055208","root":false,"shortNameOfSubflow":"purchase","$imageUri":"","$title":"Purchase","$position":{"top":"1598px","left":"2735px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"ade65afc-cd65-4251-8433-2c7c86f365ea","$typeOfContent":"","type":"ExecuteScript","$title":"SET globalScripts","$invalid":false,"settings":{"function":"run","source":"function run() {\n\tconst scripts = [ \n\t\tprocessUserInput, \n\t\tenableSubflowMode,\n\t\tdisableSubflowMode,\n\t\tconvertBoolToTextFlag,\n\t\tgetFormattedDate,\n\t\tupdateSession,\n\t\tverifyEntrypoints,\n\t\tredirect,\n\t\tgetOrigin\n\t];\n\n\treturn scripts.join('\\n');\n}\n\nconst processUserInput = `\n\tconst UNEXPECTED_INPUT = 'Input inesperado';\n\tconst INACTIVITY_FLAG = 'Inatividade';\n\tconst ERROR_FLAG = 'Error';\n\t\n\tfunction processUserInput(input, optionsRegex) {\n\n\t\ttry {\n\t\t\tconst match = matchKey(optionsRegex, input);\n\n\t\t\tconst selection = optionsRegex[match] || UNEXPECTED_INPUT;\n\n\t\t\tlet tracking = INACTIVITY_FLAG;\n\t\t\tlet userInput = INACTIVITY_FLAG;\n\n\t\t\tif (input) {\n\t\t\t\t// Remove accents\n\t\t\t\ttracking = selection.normalize('NFD').replace(/[\\u0300-\\u036f]/g, \"\");\n\t\t\t\tuserInput = input;\n\t\t\t}\n\n\t\t\treturn setUserInput(userInput, selection, tracking);\n\t\t} catch (e) {\n\t\t\treturn { \n\t\t\t\t...setUserInput(input, UNEXPECTED_INPUT, ERROR_FLAG), \n\t\t\t\t'error': e.message \n\t\t\t};\n\t\t}\n\t}\n\n\tfunction setUserInput(inputContent, selection, tracking) {\n\t\treturn {\n\t\t\t'isValid': selection !== UNEXPECTED_INPUT,\n\t\t\t'content': inputContent,\n\t\t\t'selection': selection,\n\t\t\t'tracking': tracking\n\t\t}\n\t}\n\n\tfunction matchKey(options, input) {\n\t\treturn Object.keys(options).find(key => (\n\t\t\tinput.match(new RegExp(key, 'gi'))\n\t\t));\n\t}\n`;\n\nconst enableSubflowMode = `\n\tfunction enableSubflowMode(stateId, stateName) {\n\t\treturn { 'isActive': true, 'id': stateId, 'name': stateName };\n\t}\n`;\n\nconst disableSubflowMode = `\n\tfunction disableSubflowMode(stateId, stateName) {\n\t\treturn { 'isActive': false, 'id': stateId, 'name': stateName };\n\t}\n`;\n\nconst convertBoolToTextFlag =  `\n\tfunction convertBoolToTextFlag(bool) {\n\t\treturn bool ? 'Sim': 'Nao';\n\t}\n`;\n\nconst getFormattedDate = `\n\tfunction getFormattedDate() {\n\t\tconst now = new Date();\n\t\tnow.setHours(now.getHours());\n\n\t\tlet day = now.getDate();\n\t\tlet month = now.getMonth() + 1;\n\t\tlet year = now.getFullYear();\n\t\tlet hour = now.getHours();\n\t\tlet minutes = now.getMinutes();\n\n\t\tif (day < 10) day = '0' + day;\n\t\tif (month < 10) month = '0' + month;\n\t\tif (hour < 10) hour = '0' + hour;\n\t\tif (minutes < 10) minutes = '0' + minutes;\n\n\t\treturn day + '/' + month + '/' + year + ' ' + hour + ':' + minutes;\n\t}\n`;\n\nconst updateSession = `\n\tfunction updateSession(session, entrypoint, inputContent, origin) {\n\t\ttry {\n\t\t\tsession = createOrUpdateSession(session);\n\n\t\t\tsession.count = parseInt(session.count) + 1;\n\t\t\tsession.source = 'Orgnico';\n\t\t\tsession.group = 'Orgnico';\n\t\t\tsession.input = inputContent;\n\t\t\tsession.origin = origin;\n\t\t\tsession.entrypoint = false;\n\t\t\tsession.date = getFormattedDate();\n\n\t\t\tif (entrypoint && entrypoint !== 'default') {\n\t\t\t\tentrypoint = JSON.parse(entrypoint);\n\n\t\t\t\tif (entrypoint.matched === 'Sim') {\n\t\t\t\t\tsession.source = entrypoint.matchContent.source;\n\t\t\t\t\tsession.group = entrypoint.matchContent.group;\n\t\t\t\t\tsession.entrypoint = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn session;\n\t\t}\n\t\tcatch(e) {\n\t\t\tsession.error = e.message;\n\t\t\treturn session;\n\t\t}\n\t}\n\n\tfunction createOrUpdateSession(session) {\n\t\treturn !session ? createSession() : JSON.parse(session);\n\t}\n\n\tfunction createSession() {\n\t\treturn {\n\t\t\t'count': 0,\n\t\t\t'source': '',\n\t\t\t'input': '',\n\t\t\t'origin': '',\n\t\t\t'entrypoint': false,\n\t\t\t'date': ''\n\t\t}\n\t}\n`\n\nconst verifyEntrypoints = `\n\tfunction verifyEntrypoints(input, entrypoints) {\n\t\ttry {\n\t\t\tentrypoints = JSON.parse(entrypoints);\n\n\t\t\tconst entrypoint = matchRegex(entrypoints, input);\n\n\t\t\tif (!entrypoint) \n\t\t\t\treturn 'default';\n\n\t\t\treturn {\n\t\t\t\t'matched': 'Sim',\n\t\t\t\t'matchContent': entrypoint\n\t\t\t};\t\n\t\t}\n\t\tcatch(e) {\n\t\t\treturn 'default';\n\t\t}\n\t}\n\n\tfunction matchRegex(entrypoints, input) {\n\t\treturn entrypoints.find(e => input.match(new RegExp(e.regex.Pattern, 'gmi')));\n\t}\n`\n\nconst redirect = `\n\tfunction setOrigin({ \n\t\tservice = 'default',\n\t\tserviceId = 'default',\n\t\tstateId = 'default', \n\t\tstateName = 'default'\n\t} = {}) {\n\t\treturn {\n\t\t\t'service': service,\n\t\t\t'serviceId': serviceId,\n\t\t\t'stateId': stateId,\n\t\t\t'stateName': stateName\n\t\t}\n\t}\n\n\tfunction setDestination({\n\t\tstateId,\n\t\tstateName = 'default',\n\t\tsubflowStateName = 'default', \n\t\tsubflowStateId = 'default' \n\t} = {}) {\n\t\tif (!stateId) \n\t\t\treturn 'stateId is required for redirect destination.';\n\t\t\n\t\treturn {\n\t\t\t'stateId': stateId,\n\t\t\t'stateName': stateName,\n\t\t\t'subflowStateId': subflowStateId,\n\t\t\t'subflowStateName': subflowStateName\n\t\t}\n\t}\n\n\tfunction isModuleResponse(message, currentStateId) {\n\t\ttry  {\n\t\t\tif (!message) return false;\n\t\t\tmessage = JSON.parse(message);\n\t\t\treturn message.isModuleResponse && (message.to.stateId === currentStateId || message.to.subflowStateId === currentStateId);\n\t\t}\n\t\tcatch(e) {\n\t\t\treturn e.message\n\t\t}\n\t}\n\n\tfunction redirect(from, to, { skipCallerMessageSave = false, isModuleResponse = false } = {}) {\n\t\ttry {\n            if (typeof to === 'string') throw new Error(to);\n            \n\t\t\tconst message = { from: setOrigin(from) };\n\n\t\t\tif (to) message.to = to;\n\n\t\t\tmessage.skipCallerMessageSave = skipCallerMessageSave;\n\t\t\tmessage.isModuleResponse = isModuleResponse;\n\n\t\t\treturn message;\n\t\t}\n\t\tcatch(e) {\n\t\t\treturn {\n\t\t\t\t'from': setOrigin(from),\n\t\t\t\t'to': setDestination({ \n\t\t\t\t\tstateName: 'Redirect Error', \n\t\t\t\t\tstateId: '7f2feee4-c5b0-4d7c-b77a-91f6ce6a771b' \n\t\t\t\t}),\n\t\t\t\t'error': e.message,\n\t\t\t};\n\t\t}\n\t}\n`\n\nconst getOrigin = `\n\tfunction getOrigin(redirect, statePreviousName) {\n\t\tconst DEFAULT_ORIGIN =  'Parent Flow' + ' | ' + statePreviousName;\n\n\t\ttry {\n\t\t\tif (redirect && redirect !== 'default') {\n\t\t\t\tredirect = JSON.parse(redirect);\n\t\t\t\treturn redirect.from.service + ' | ' + redirect.from.stateName\n\t\t\t}\n\n\t\t\treturn DEFAULT_ORIGIN;\n\t\t}\n\t\tcatch(e) {\n\t\t\treturn 'Error: ' + e.message;\n\t\t}\n\t}\n`","inputVariables":[],"outputVariable":"globalScripts"},"conditions":[{"$$hashKey":"object:33964","values":[],"source":"context","comparison":"notExists","variable":"cache"}]},{"$id":"817e2232-2ae2-4e4f-86b8-b84b917bfd0a","$typeOfContent":"","type":"ExecuteScript","$title":"SET entrypoints","$invalid":false,"settings":{"function":"run","source":"const entrypoints = [\n {\n    text: 'Hi! I was in the website and I would like to know more about this product.',\n    isActive: true,\n    regex: /know\\s*more\\s*about\\s*this\\s*product/gmi,\n    source: 'Website Banner',\n    content: {\n      image: 'https://s3-sa-east-1.amazonaws.com/i.imgtake.takenet.com.br/yycnolzc.q22/notebooks-jpg.png',\n      description: '<b>So, are you looking for a notebook?</b>\\n\\nIntroducing the Future of Portability and Power: The 2024 Ultra-Modern Notebook!\\n\\nExperience the pinnacle of innovation with our latest ultra-modern notebook, designed for the discerning user who demands both style and substance. With its feather-light frame and robust performance, this notebook is the perfect fusion of form and function.'\n    },\n    createdAt: '11/04/2024'\n  }\n];\n\nfunction run() {\n  return entrypoints;\n}","inputVariables":[],"outputVariable":"entrypoints"},"conditions":[]},{"$id":"6ee9d982-c614-44a2-a0d0-422bbbc8a488","$typeOfContent":"","type":"ExecuteScript","$title":"SET components","$invalid":false,"settings":{"function":"run","source":"function run() {\n\tconst builders = [\n\t\tbuildMenuList,\n\t\tbuildQuickReply,\n\t\tbuildTextPlainMenu,\n\t\tinitWAInteractiveComponentProps\n\t];\n\n\treturn builders.join('\\n');\n}\n\nconst buildQuickReply = `\n\tfunction buildQuickReply({\n\t\tchannel = 'default', \n\t\ttext = 'BODY_TEXT',\n\t\theader = { type: 'text', text: 'HEADER_TEXT' },\n\t\toptions = [] \n\t} = {}) {\n\t\ttry {\n\t\t\tlet contentType = 'application/vnd.lime.select+json'\n\t\t\tlet content = {\n\t\t\t\tscope: 'immediate',\n\t\t\t\ttext: text,\n\t\t\t\toptions: options.map(option => ({ text: option }))\n\t\t\t}\n\n\t\t\tif (channel === 'whatsapp') {\n\t\t\t  contentType = 'application/json'\n\t\t\t  content = initWAInteractiveComponentProps('button')\n\t\t\t  \n              if (header && header.text !== 'HEADER_TEXT')\n\t\t\t\tcontent.interactive.header = header\n\n\t\t\t  content.interactive.body = { text: text }\n\t\t\t  content.interactive.action = {\n\t\t\t\tbuttons: options.map((option, index) => {\n\t\t\t\treturn { \n\t\t\t\t\ttype: 'reply', \n\t\t\t\t\treply: { id: index, title: option }}\n\t\t\t\t})\n\t\t\t  }\n\t\t\t}\n\n\t\t\treturn { type: contentType, content: content }\n\t\t}\n\t\tcatch(e) {\n\t\t\treturn e.message;\n\t\t}\n\t}\n`\n\nconst buildMenuList = `\n\tfunction buildMenuList({\n\t\tchannel = 'default',\n\t\ttext = 'BODY_TEXT',\n\t\theader = { type: 'text', text: 'HEADER_TEXT' },\n\t\tfooter = { text: 'FOOTER_TEXT' },\n\t\toptions = [{ section: 'DEFAULT_SECTION', rows: [ { title: 'DEFAULT_OPTION', description: 'DEFAULT_DESCRIPTION' } ]}],\n\t\tbuttonText = 'BUTTON_TEXT'\n\t} = {}) {\n\t\ttry {\n\t\t\tlet contentType = 'application/vnd.lime.select+json'\n\t\t\tlet content = {\n\t\t\t\ttext: text,\n\t\t\t\toptions: options.reduce((result, section) => [ ...result, ...section.rows.map(row => ({ text: row.title })) ], [])\n\t\t\t}\n\t\t\n\t\t\tif (channel === 'whatsapp') {\n\t\t\t\tcontentType = 'application/json'\n\t\t\t\tcontent = initWAInteractiveComponentProps('list')\n\t\t\t\n\t\t\t\tif (header && header.text !== 'HEADER_TEXT')\n\t\t\t\t\tcontent.interactive.header = header\n\t\t\t\n\t\t\t\tif (footer.text && footer.text !== 'FOOTER_TEXT')\n\t\t\t\t\tcontent.interactive.footer = footer\n\t\t\t\n\t\t\t\tcontent.interactive.action = {\n\t\t\t\t\tbutton: buttonText,\n\t\t\t\t\tsections: options.map((option) => { \n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttitle: option.section, \n\t\t\t\t\t\t\trows: option.rows.map((row, index) => {\n\t\t\t\t\t\t\t\tconst value = { id: option.section + index, title: row.title }\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (row.description)\n\t\t\t\t\t\t\t\t\tvalue[description] = row.description\n\n\t\t\t\t\t\t\t\treturn value\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t}) \n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t\treturn { type: contentType, content: content }\n\t\t}\n\t\tcatch(e) {\n\t\t\treturn e.message;\n\t\t}\n\t}\n`\n\nconst initWAInteractiveComponentProps = `\n\tfunction initWAInteractiveComponentProps(type) {\n\t\treturn {\n\t\t\trecipient_type: 'individual',\n\t\t\ttype: 'interactive',\n\t\t\tinteractive: { type }\n\t\t}\n\t}\n`\n\nconst buildTextPlainMenu = `\n\tfunction buildTextPlainMenu(menu) {\n\t\treturn {\n\t\t\t'type': 'text/plain',\n\t\t\t'content': menu\n\t\t}\n\t}\n` ","inputVariables":[],"outputVariable":"components"},"conditions":[{"$$hashKey":"object:30760","values":[],"source":"context","comparison":"notExists","variable":"cache"}]},{"$id":"b0190c82-285d-4ece-8eb6-5cbbda6d146f","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflowIds","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\tOnboarding: \"subflow:9f0f74c3-5b50-46ba-af50-7fcd3a3f1181\",\n\t\tFinalization: \"subflow:29f820b7-df92-4461-9987-46f0acaefc5b\",\n\t\tDesk: \"subflow:6588850e-97a3-4619-b2b7-5e7f6e9ee29c\",\n\t\tEntrypoints: \"subflow:50d68e92-815c-4421-b0a8-236d31f52afb\",\n\t\tPreFinalization: \"subflow:1d273c53-0ffd-4882-897b-3686ba8a0ca5\",\n\t\tMainMenu: \"subflow:76ebc8e8-e46e-4661-a013-172a130d5b22\",\n\t\tProductConfirmation: \"subflow:5d7cfe68-dd73-4ebb-8425-44b9ae52c753\",\n\t\tEletronics: \"subflow:0b9aafef-6e82-47a7-8e28-e49acc44c4f3\",\n\t\tPetSupplies: \"subflow:03ed9fe0-d284-4105-aa4d-ba8f7b381699\",\n\t\tMoviesAndTelevision: \"subflow:2c25d536-338c-48f9-8cc0-3a43362cb151\",\n\t\tPurchase: \"subflow:69c42812-ead3-49b1-9f9e-ac7af0055208\"\n\t}\n}","inputVariables":[],"outputVariable":"subflowIds"},"conditions":[]},{"$id":"efd67aca-e6e3-4490-ab0c-d5a165e1b388","$typeOfContent":"","type":"ExecuteScript","$title":"RESET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'default', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': 'default'\n\t} \n}","inputVariables":[],"outputVariable":"error"},"conditions":[]},{"$id":"9b43fe75-c814-4c0e-ae28-2276838cda33","$typeOfContent":"","type":"ExecuteScript","$title":"RESET apiError","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'default'\n\t}\n}","inputVariables":[],"outputVariable":"apiError"},"conditions":[]},{"$id":"8494c769-899d-4de5-8589-bf6efa9daa5c","$typeOfContent":"","type":"SetVariable","$title":"RESET redirect","$invalid":false,"settings":{"variable":"redirect","value":"default"},"conditions":[]},{"$id":"91f710b1-de98-49a8-a5c6-aebe1e7213a0","$typeOfContent":"","type":"SetVariable","$title":"RESET isModuleResponse","$invalid":false,"settings":{"variable":"isModuleResponse","value":"false"},"conditions":[]},{"$id":"8baf6cf5-3f5e-4ec4-9167-91fc9856e15c","$typeOfContent":"","type":"SetVariable","$title":"SET cache","$invalid":false,"settings":{"variable":"cache","value":"Enabled","expiration":600},"conditions":[{"$$hashKey":"object:29335","values":[],"source":"context","comparison":"notExists","variable":"cache"}]}],"$leavingCustomActions":[{"$id":"b7d4282e-3dbe-486f-93a0-be5e60c7bcc5","$typeOfContent":"","type":"ExecuteScript","$title":"SET lastStateWithInput","$invalid":false,"settings":{"function":"run","source":"// Register last StateId and StateName with an input on PARENT flow.\nfunction run(stateId, stateName) {\n\treturn {\n\t\t\"id\": stateId,\n\t\t\"name\": stateName\n\t}\n}","inputVariables":["state.id","state.name"],"outputVariable":"lastStateWithInput"},"conditions":[{"$$hashKey":"object:6389","values":["true"],"source":"context","comparison":"notEquals","variable":"subflow@isActive"},{"$$hashKey":"object:8441","values":["true"],"source":"context","comparison":"notEquals","variable":"onCascadeHandling"}]},{"$id":"0f7940ae-ce7c-4569-8528-87540c4b559d","$typeOfContent":"","type":"ExecuteScript","$title":"SET lastSubflowStateWithInput","$invalid":false,"settings":{"function":"run","source":"// Register last StateId and StateName with an input on SUBFLOW.\nfunction run(stateId, stateName) {\n\treturn {\n\t\t\"id\": stateId,\n\t\t\"name\": stateName\n\t}\n}","inputVariables":["state.id","state.name"],"outputVariable":"lastSubflowStateWithInput"},"conditions":[{"$$hashKey":"object:6746","values":["true"],"source":"context","comparison":"equals","variable":"subflow@isActive"},{"$$hashKey":"object:18565","values":["true"],"source":"context","comparison":"notEquals","variable":"onCascadeHandling"}]},{"$id":"29fbbaf0-0452-4f05-a2b5-f37c7f17ae1e","$typeOfContent":"","type":"ExecuteScript","$title":"SET firstSession","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(entrypoint, inputContent) {\n\tconst session =  {\n\t\t'source': 'Error',\n\t\t'input': inputContent,\n\t\t'timestamp': getFormattedDate(),\n\t\t'entrypoint': false,\n\t\t'group': 'Orgnico'\n\t};\n\n\ttry {\n\t\tsession.source = 'Orgnico';\n\n\t\tif (entrypoint && entrypoint !== 'default') {\n\t\t\tentrypoint = JSON.parse(entrypoint);\n\n\t\t\tif (entrypoint.matched === 'Sim') {\n\t\t\t\tsession.source = entrypoint.matchContent.source;\n\t\t\t\tsession.entrypoint = true;\n\t\t\t\tsession.group = entrypoint.matchContent.group;\n\t\t\t}\n\t\t}\n\n\t\treturn session;\n\t}\n\tcatch(e) {\n\t\treturn {\n\t\t\t...session,\n\t\t\t'error': e.message\n\t\t}\n\t}\n}","inputVariables":["entrypoint","input.content"],"outputVariable":"firstSession"},"conditions":[{"$$hashKey":"object:798","values":[],"source":"context","comparison":"notExists","variable":"firstSession"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"subflows":[{"shortName":"inputhandler2","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"fe4e3304-d4aa-4f62-9ed5-3a4311711289","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"014c6db8-0e98-42a9-b80b-d406c923e7c3","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"769d64c4-2615-46c6-82ac-0b1763133901","$connId":"con_3","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"d642332b-2ffb-4f43-8921-b5bb82fbe80d","$typeOfContent":"","type":"SetVariable","$title":"SET service","$invalid":false,"settings":{"variable":"service","value":"Cascade"},"conditions":[]},{"$id":"7f68d70d-f269-4be4-b5fa-d3890a9cdc72","$typeOfContent":"","type":"SetVariable","$title":"SET inputContent","$invalid":false,"settings":{"variable":"inputContent","value":"{{input.content}}"},"conditions":[]},{"$id":"e6591fc2-04ed-4bf1-9381-5a266ef49630","$typeOfContent":"","type":"ExecuteScript","$title":"SET errorId","$invalid":false,"settings":{"function":"run","source":"const DEFAULT_VALUE = 'default';\n\nfunction run(error) {\n\ttry {\n\t\tconst { id } = JSON.parse(error);\n\n\t\treturn id || DEFAULT_VALUE;\n\t}\n\tcatch(e) {\n\t\treturn DEFAULT_VALUE;\n\t}\n}","inputVariables":["error"],"outputVariable":"errorId","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c1fb5ad2-e65e-4679-a93e-8b5552d1b249","$typeOfContent":"","type":"ExecuteScript","$title":"SET genericErrorMessage","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn \"Sorry, I could not understand you... \\nHere, I can help you with the following options:\";\n}","inputVariables":[],"outputVariable":"genericErrorMessage","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"014c6db8-0e98-42a9-b80b-d406c923e7c3","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b12ce981-6849-4e8c-83c3-b4094d67d04d","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-6ead5bf5-f37a-45e9-8b6c-39cbdde0863c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"112px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"58f4517b-314f-47ca-acf2-4b946ba42619","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"d83cf94d-8380-4a89-bb2f-2f81cff8a753","$typeOfContent":"","type":"SetVariable","$title":"SET innerException","$invalid":false,"settings":{"variable":"innerException","value":"true"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7cc7de55-1a2b-4598-bb81-f818f712f85d","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"102px","left":"1796px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"89cb4e3c-6385-45a2-a715-c3ccee7922ca","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"1518px","left":"643px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"welcome":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"81784f01-5755-4e14-927b-3b7256635b91","type":"text/plain","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"9f1573c9-47b1-4856-9353-16a38dfbbd5d","typeOfStateId":"state","$connId":"con_8","$id":"bb6e17a7-8c34-4b64-9b99-3ecbb3f9eb25","conditions":[{"source":"context","comparison":"equals","values":["Sim"],"variable":"isValidInputType"}],"$invalid":false},{"stateId":"d7b24c14-1093-4500-8d2b-cccacb58a7f7","typeOfStateId":"state","$connId":"con_13","$id":"58c78b3a-5a68-4569-9b55-2c2b0ad3fd8e","conditions":[{"source":"context","comparison":"equals","values":["Nao"],"variable":"isValidInputType"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"24a5b5df-204e-4658-8d11-70cd053d86e5","$typeOfContent":"","type":"ExecuteScript","$title":"SET isEmoji","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nconst EMOJI_REGEX = /((\\u00a9|\\u00ae|[\\u2000-\\u3300]|\\ud83c[\\ud000-\\udfff]|\\ud83d[\\ud000-\\udfff]|\\ud83e[\\ud000-\\udfff]))/gmi;\n\nfunction run(inputContent) {\n\ttry {\n\t\tconst isEmoji = EMOJI_REGEX.test(inputContent);\n\n\t\treturn convertBoolToTextFlag(isEmoji);\n\t}\n\tcatch(e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["inputContent"],"outputVariable":"isEmoji","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"11a771a7-501c-436d-a2a0-aafd17935151","$typeOfContent":"","type":"ExecuteScript","$title":"SET isLink","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nconst LINK_REGEX = /((ftp|http|https):\\/\\/[^ \"]+)/gmi;\n\nfunction run(inputContent) {\n\t\ttry {\n\t\tconst isLink = LINK_REGEX.test(inputContent);\n\n\t\treturn convertBoolToTextFlag(isLink);\n\t}\n\tcatch(e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["inputContent"],"outputVariable":"isLink","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"dffa40e7-a309-464b-93e6-815c61934cbf","$typeOfContent":"","type":"ExecuteScript","$title":"SET isText","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nconst isText = true;\n\nfunction run(inputContent) {\n\ttry {\n\t\tinputContent = JSON.parse(inputContent);\n\n\t\treturn convertBoolToTextFlag(!isText);\n\t}\n\tcatch(e) {\n\t\treturn convertBoolToTextFlag(isText);\n\t}\n}","inputVariables":["inputContent"],"outputVariable":"isText","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"3ad2c0be-4d59-4563-9efb-118077b6ac8a","$typeOfContent":"","type":"ExecuteScript","$title":"SET isValidInputType","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(isEmoji, isLink, isText) {\n\ttry {\n\t\tconst isValidInputType = isEmoji === 'Nao' && \n\t\t\t\t\t\t\t\t\t\t\t\t   isLink === 'Nao' && \n\t\t\t\t\t\t\t\t\t\t\t\t   isText === 'Sim';\t\t\n\n\t\treturn convertBoolToTextFlag(isValidInputType);\n\t}\n\tcatch(e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["isEmoji","isLink","isText"],"outputVariable":"isValidInputType","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"d7b24c14-1093-4500-8d2b-cccacb58a7f7","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bb0e7f74-a5f6-4151-9736-fae2c794305c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"welcome","$title":"Is an invalid input type?","$position":{"top":"394px","left":"643px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9f1573c9-47b1-4856-9353-16a38dfbbd5d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"6cc3e36d-d00a-470a-bb17-02f360242f88","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"3edf8756-68e8-4305-b8e9-108e60677f5c","typeOfStateId":"state","$connId":"con_18","$id":"63b877a9-90ac-4ff6-af65-b90555a5ca05","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"error@hasGlobalRegexValidation"}],"$invalid":false},{"stateId":"59e96079-b77f-444d-bb10-fc9007f3930c","typeOfStateId":"state","$connId":"con_23","$id":"4b3567dd-09cf-42b3-ace2-fe22d6a2effc","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"59e96079-b77f-444d-bb10-fc9007f3930c","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"9f1573c9-47b1-4856-9353-16a38dfbbd5d","root":false,"$title":"Should look for Global Regex?","$position":{"top":"574px","left":"643px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d7b24c14-1093-4500-8d2b-cccacb58a7f7":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"78687109-4483-49d7-88e9-9ef6f4cb846b","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"344dbffb-9ef6-4071-afb6-960ae38842ef","$typeOfContent":"","type":"ExecuteScript","$title":"SET inputType","$invalid":false,"settings":{"function":"run","source":"function run(inputContent) {\n\ttry {\n\t\tinputContent = JSON.parse(inputContent);\n\n\t\treturn inputContent.type;\n\t}\n\tcatch(e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["inputContent"],"outputVariable":"inputType","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"7f26b550-62fd-476e-a0f9-4c0ea5917e01","$typeOfContent":"","type":"ExecuteScript","$title":"SET errorId","$invalid":false,"settings":{"function":"run","source":"const DEFAULT_VALUE = 'default';\n\nfunction run(isEmoji, isLink, inputType) {\n\ttry {\n\t\tconst errorId = getInputTypeErrorId(inputType);\n\n\t\tif (errorId !== DEFAULT_VALUE) {\n\t\t\treturn errorId;\n\t\t}\n\n\t\tif (isEmoji === 'Sim') {\n\t\t\treturn 'EmojiError';\n\t\t}\n\n\t\tif (isLink === 'Sim') {\n\t\t\treturn 'LinkError';\n\t\t}\n\n\t\treturn DEFAULT_VALUE;\n\t}\n\tcatch(e) {\n\t\treturn DEFAULT_VALUE;\n\t}\n}\n\nfunction getInputTypeErrorId(inputType) {\n    const inputTypeErrorMapping = {\n        \"image\": \"ImageError\",\n        \"audio\": \"AudioError\",\n        \"video\": \"VideoError\",\n        \"application\": \"DocumentError\",\n    }\n\n    const key = Object.keys(inputTypeErrorMapping)\n\t\t.find(key => inputType.includes(key));\n\n    return inputTypeErrorMapping[key] || DEFAULT_VALUE;\n}","inputVariables":["isEmoji","isLink","inputType"],"outputVariable":"errorId","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"ed679157-831d-40e4-bb8a-8ea632f9f532","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e4bd8944-5419-4d9d-a794-d32cc68f1fa9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"d7b24c14-1093-4500-8d2b-cccacb58a7f7","root":false,"$title":"Handle invalid input type","$position":{"top":"394px","left":"878px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"59e96079-b77f-444d-bb10-fc9007f3930c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c98fab66-32e8-49e2-918e-e3976c69008c","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"42974860-9b0e-4e35-90e8-2500fdf7e07e","typeOfStateId":"state","$connId":"con_28","$id":"e65e3ce4-61b7-42ad-8139-fb444c62bd9c","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"error@hasSmalltalksValidation"}],"$invalid":false},{"stateId":"bdfe7b0e-f56c-4fdd-b5aa-28fa8d6f5a69","typeOfStateId":"state","$connId":"con_33","$id":"cc83a501-d7e2-45dc-9298-7c6057e83415","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"bdfe7b0e-f56c-4fdd-b5aa-28fa8d6f5a69","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"59e96079-b77f-444d-bb10-fc9007f3930c","root":false,"$title":"Should look for Smalltalks?","$position":{"top":"730px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bdfe7b0e-f56c-4fdd-b5aa-28fa8d6f5a69":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"6d8ac509-6651-408f-8403-16ab42ebd136","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7b7d7c18-2e1d-421e-aee6-f195c77d1466","typeOfStateId":"state","$connId":"con_38","$id":"19673ae2-cf9f-4b2b-96fd-2672bbbd01b3","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"error@hasAIValidation"}],"$invalid":false},{"stateId":"ed679157-831d-40e4-bb8a-8ea632f9f532","typeOfStateId":"state","$connId":"con_43","$id":"ef80796e-b5fc-4b2d-b9bb-85f1a14c73be","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"ed679157-831d-40e4-bb8a-8ea632f9f532","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"bdfe7b0e-f56c-4fdd-b5aa-28fa8d6f5a69","root":false,"$title":"Should look for Intents?","$position":{"top":"884px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ed679157-831d-40e4-bb8a-8ea632f9f532":{"$contentActions":[{"action":{"$id":"b8fed64f-d599-4db8-9fa0-e4cb725fc94f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d01415e9-ba8f-4741-a276-94c310b08a0d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d01415e9-ba8f-4741-a276-94c310b08a0d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"da32df38-4160-402e-b9c2-13fa148e885d","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b065e7dc-725a-4ea4-9135-715ad2abad1f","type":"text/plain","content":"{{errorMessage}}","metadata":{}},"$cardContent":{"document":{"id":"b065e7dc-725a-4ea4-9135-715ad2abad1f","type":"text/plain","content":"{{errorMessage}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"46d25c92-a747-4946-854f-3d670667f21a","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"a04ee4ac-1c0b-4b64-977f-5dee61b67b69","typeOfStateId":"state","$connId":"con_48","$id":"2028cdd2-04b0-44bd-a714-764995590b77","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"87ad6590-eb15-41d5-ac63-bf9e2226e944","$typeOfContent":"","type":"ExecuteScript","$title":"SET errorMapping","$invalid":false,"settings":{"function":"run","source":"function run(genericErrorMessage) {\n\tconst componentErrors = {\n\t\t\"MenuListError\": \"Sorry, but I could not understand you. Please, select one of the following options in the menu list:\",\n\t\t\"QuickReplyError\": \"Sorry, but you need to select one of the following buttons:\"\n\t}\n\n\tconst genericErrors = {\n\t\t\"default\": genericErrorMessage\n\t}\n\n\treturn {\n\t\t...componentErrors,\n\t\t...genericErrors\n\t}\n}","inputVariables":["genericErrorMessage"],"outputVariable":"errorMapping","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b875476a-89a9-4d78-a77b-2b5bac9998e8","$typeOfContent":"","type":"ExecuteScript","$title":"SET errorMessage","$invalid":false,"settings":{"function":"run","source":"function run(\n\terrorMapping, \n\terrorId,\n\terror, \n\tdefaultErrorMessage) \n{\n\ttry {\n\t\tconst { customErrorMessage } = JSON.parse(error);\n\t\terrorMapping = JSON.parse(errorMapping);\n\n\t\tif (customErrorMessage && customErrorMessage !== 'default') \n\t\t\treturn customErrorMessage;\n\n\t\treturn errorMapping[errorId] || defaultErrorMessage;\n\t}\t\n\tcatch(e) {\n\t\treturn defaultErrorMessage;\n\t}\n}","inputVariables":["errorMapping","errorId","error"],"outputVariable":"errorMessage","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3967369c-ec8d-49ee-ac5e-d833c001e587","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8e900b0c-651c-481c-9c45-7780c740dee2","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"ed679157-831d-40e4-bb8a-8ea632f9f532","root":false,"$title":"Display error message","$position":{"top":"1028px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3edf8756-68e8-4305-b8e9-108e60677f5c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"97892106-ade1-43e1-80cd-b59f227feec4","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"59e96079-b77f-444d-bb10-fc9007f3930c","typeOfStateId":"state","$connId":"con_53","$id":"a467e5da-618e-424c-a630-f9340e2a6c2d","conditions":[{"source":"context","comparison":"equals","values":["default"],"variable":"destination"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"e2c67f38-6617-4296-8032-51121904646c","$typeOfContent":"","type":"ExecuteScript","$title":"SET destination","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflowIds, inputContent) {\n\tsubflowIds = JSON.parse(subflowIds);\n\n\tconst intentsRegex = {\n\t\t'^(quit)$|(quit|end|finish)\\\\s*conversation': 'Quit',\n\t\t'^(attendant)$|talk\\\\s*to\\\\s*(attendant|human|agent)': 'Attendant'\n\t}\n\n\tconst destinations = {\n\t\t'Quit': { \n\t\t\t'stateId': subflowIds.Finalization \n\t\t},\n\t\t'Attendant': {\n\t\t\t'stateId': subflowIds.Desk\n\t\t}\n\t}\n\n\tconst key = intentMatch(intentsRegex, normalizeInput(inputContent));\n\n\tconst intent = intentsRegex[key];\n\n\tconst destination = destinations[intent];\n\n\treturn destination ? setDestination(destination) : 'default';\n} \n\nfunction intentMatch(intents, input) {\n\treturn Object.keys(intents).find(key => input.match(new RegExp(key, 'gmi')))\n}\n\nfunction normalizeInput(text) {\n  return text.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '')\n}","inputVariables":["subflowIds","inputContent"],"outputVariable":"destination","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f7959764-b94d-4fdf-be77-12f1446d761f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"3edf8756-68e8-4305-b8e9-108e60677f5c","root":false,"$title":"Handle Global Regex","$position":{"top":"644px","left":"397px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"42974860-9b0e-4e35-90e8-2500fdf7e07e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48259005-905b-4ca3-98dd-e6d8d661397e","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"bdfe7b0e-f56c-4fdd-b5aa-28fa8d6f5a69","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"42974860-9b0e-4e35-90e8-2500fdf7e07e","root":false,"$title":"Handle Smalltalks","$position":{"top":"742px","left":"871px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7b7d7c18-2e1d-421e-aee6-f195c77d1466":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"012a1077-564b-4b10-b062-3b622b567f95","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"ed679157-831d-40e4-bb8a-8ea632f9f532","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"7b7d7c18-2e1d-421e-aee6-f195c77d1466","root":false,"$title":"Handle AI Intents","$position":{"top":"896px","left":"870px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7b208e3c-7a73-4598-9217-00ca626b3a0f":{"$contentActions":[{"action":{"$id":"8925670c-6d8b-4e4d-808f-fe026daff393","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"57c3ebba-1551-4995-99d3-faa11801582a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"57c3ebba-1551-4995-99d3-faa11801582a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:8922"},{"action":{"$id":"33c81533-c003-4e50-b684-c7bb3c354375","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:8923"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"b4ff39ae-e383-4be6-b1f6-ff4b3de129d5","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:8924"}],"$conditionOutputs":[{"stateId":"c801abe4-433c-45a2-9cec-63092fca1b66","typeOfStateId":"state","$connId":"con_58","$id":"d349ab43-d67a-49a1-bfd0-cbbc41735a0b","conditions":[{"source":"context","comparison":"equals","values":["End conversation"],"variable":"userInput@selection","$$hashKey":"object:8950"}],"$invalid":false,"$$hashKey":"object:8932"},{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","typeOfStateId":"state","$connId":"con_63","$id":"7beb80e9-f7b3-4205-a77d-084ed5f49ee1","conditions":[{"source":"context","comparison":"equals","values":["Continue"],"variable":"userInput@selection","$$hashKey":"object:8966"}],"$invalid":false,"$$hashKey":"object:8933"}],"$enteringCustomActions":[{"$id":"2225f2c7-a298-4246-a907-94af13cb17e3","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildQuickReply({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'We can try again or end the conversation if you prefer. What would you like to do?',\n\t\toptions: [\n\t\t\t'Continue',\n\t\t\t'End conversation'\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7c55db5e-451b-4d35-9509-38e9eb3485bf","$typeOfContent":"","type":"SetVariable","$title":"RESET errorCount = 0","$invalid":false,"settings":{"variable":"errorCount","value":"0"},"conditions":[{"values":["true"],"source":"context","comparison":"equals","variable":"userInput@isValid"}]}],"$leavingCustomActions":[{"$id":"58b84e6e-9b7b-4abb-809f-2fd35459bcc5","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t\"^(1)$|^(continue)$\": \"Continue\",\n\t\t\"^(2)$|^(end|quit)\\\\s*conversation$\": \"End conversation\",\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"$tags":[{"id":"blip-tag-e7ef1a80-be70-4319-8493-64ccd44beb8f","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-45f3f292-1001-4021-994c-c808c82d1927","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-07fe10b0-801f-4a54-af64-a274c680f288","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-6b47d524-04cd-470d-b1d8-49544aa8701c","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"7b208e3c-7a73-4598-9217-00ca626b3a0f","root":false,"$title":"Handle persistent error","$position":{"top":"1254px","left":"904px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"end","typeOfStateId":"state","$connId":"con_68","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"6fc503a2-3c71-4fe2-809e-8568491b4a2d","$typeOfContent":"","type":"SetVariable","$title":"SET innerException","$invalid":false,"settings":{"variable":"innerException","value":"false"},"conditions":[]}],"$leavingCustomActions":[{"$id":"c2ec8b79-611c-4227-a933-8644280a270d","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(\n\tservice,\n\tentrypoint,\n\tsubflowIds,\n\texceptionMessage,\n\tdestination\n) {\n\tconst origin = setOrigin({\n\t\tservice: service,\n\t\tstateId: '{{state.id}}',\n\t\tstateName: '{{state.name}}'\n\t});\n\n\t// Handle entrypoint redirect\n\tif (entrypoint && entrypoint !== 'default') {\n\t\tsubflowIds = subflowIds && JSON.parse(subflowIds);\n\t\tconst destination = setDestination({ stateId: subflowIds.Onboarding });\n\t\treturn redirect(origin, destination);\n\t}\n\n\t// Handle global regex redirect\n\tif (destination && destination !== 'default') {\n\t\tdestination = JSON.parse(destination);\n\t\treturn redirect(origin, destination);\n\t}\n\n\t// If input does not match Entrypoint or Global Regex, then return to last state with input.\n\texceptionMessage = JSON.parse(exceptionMessage);\n\treturn exceptionMessage;\n}","inputVariables":["service","entrypoint","subflowIds","exceptionMessage","destination"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-01762b02-d443-4e7e-b272-225d82ec1db1","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-2bb208a7-72be-4cd3-8db7-7b0c5dd04ba2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Input Handler","$position":{"top":"1344px","left":"643px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a04ee4ac-1c0b-4b64-977f-5dee61b67b69":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"dc56b57a-d1d8-4fe5-9b76-08b6a0dcd590","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7b208e3c-7a73-4598-9217-00ca626b3a0f","typeOfStateId":"state","$connId":"con_73","$id":"eddc3e24-c122-4d72-bd94-2618d0728d47","conditions":[{"values":["3"],"source":"context","comparison":"greaterThanOrEquals","variable":"errorCount"}],"$invalid":false},{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","typeOfStateId":"state","$connId":"con_78","$id":"3f2f5a68-e796-4cd6-9349-5eafd74ae7ba","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"f7656a86-12e2-46ae-a891-b17d3e0ba16b","$typeOfContent":"","type":"SetVariable","$title":"SET maxErrorCount","$invalid":false,"settings":{"variable":"maxErrorCount","value":"3"},"conditions":[]},{"$id":"b22480e8-1aa5-43f0-97c4-25ab3ff34a32","$typeOfContent":"","type":"ExecuteScript","$title":"SET currentExceptionOrigin","$invalid":false,"settings":{"function":"run","source":"function run(subflow, lastStateWithInput, lastSubflowStateWithInput) {\n\ttry {\n\t\tsubflow = JSON.parse(subflow);\n\n\t\tif (subflow.isActive) {\n\t\t\tlastSubflowStateWithInput = JSON.parse(lastSubflowStateWithInput);\n\n\t\t\treturn {\n\t\t\t\t\"flowId\": subflow.id,\n\t\t\t\t\"stateId\": lastSubflowStateWithInput.id\n\t\t\t}\n\t\t}\n\n\t\tlastStateWithInput = JSON.parse(lastStateWithInput);\n\n\t\treturn {\n\t\t\t\"flowId\": \"default\",\n\t\t\t\"stateId\": lastStateWithInput.id\n\t\t}\n\t}\n\tcatch(e) {\n\t\treturn {\n\t\t\t\"flowId\": \"default\",\n\t\t\t\"stateId\": \"default\",\n\t\t\t\"error\": e.message\n\t\t}\n\t}\n}","inputVariables":["subflow","lastStateWithInput","lastSubflowStateWithInput"],"outputVariable":"currentExceptionOrigin","LocalTimeZoneEnabled":false},"conditions":[{"values":["true"],"source":"context","comparison":"notEquals","variable":"innerException"}]},{"$id":"21fd0c75-9b5d-4ee5-89f1-e6fdb65257d9","$typeOfContent":"","type":"SetVariable","$title":"[C] SET previousExceptionOrigin","$invalid":false,"settings":{"variable":"previousExceptionOrigin","value":"{{currentExceptionOrigin}}"},"conditions":[{"values":[],"source":"context","comparison":"notExists","variable":"previousExceptionOrigin"},{"values":["true"],"source":"context","comparison":"notEquals","variable":"innerException"}]},{"$id":"8855487c-0179-424c-b447-34ebe5c5fc0e","$typeOfContent":"","type":"ExecuteScript","$title":"SET errorCount","$invalid":false,"settings":{"function":"run","source":"function run(errorCount, currentExceptionOrigin, previousExceptionOrigin, maxErrorCount) {\n    try {\n        if (!errorCount || errorCount === \"NaN\" || parseInt(errorCount) >= maxErrorCount) {\n            errorCount = 0;\n        }\n\n        currentExceptionOrigin = JSON.parse(currentExceptionOrigin);\n        previousExceptionOrigin = JSON.parse(previousExceptionOrigin);\n  \n        if (shouldIncrementErrorCount(currentExceptionOrigin, previousExceptionOrigin)) \n        {\n            return parseInt(errorCount) + 1;    \n        }\n\n        return 1;\n    }\n    catch(e) {\n        return errorCount;\n    }\n}\n\nfunction shouldIncrementErrorCount(currentException, previousException) {\n    const isSameFlow = currentException.flowId === previousException.flowId;\n    const isSameStateId = currentException.stateId === previousException.stateId;\n\n    return isSameFlow && isSameStateId;\n}","inputVariables":["errorCount","currentExceptionOrigin","previousExceptionOrigin","maxErrorCount"],"outputVariable":"errorCount","LocalTimeZoneEnabled":false},"conditions":[{"values":["true"],"source":"context","comparison":"notEquals","variable":"innerException"}]}],"$leavingCustomActions":[{"$id":"feae4081-64d9-4478-81ef-5e940450d10f","$typeOfContent":"","type":"SetVariable","$title":"SET previousExceptionOrigin","$invalid":false,"settings":{"variable":"previousExceptionOrigin","value":"{{currentExceptionOrigin}}"},"conditions":[{"values":["true"],"source":"context","comparison":"notEquals","variable":"innerException"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-05b3a713-e603-48fb-808b-aaaf14b0ea97","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-94b627cb-61ed-4d08-99e9-dc4d6d22c6b5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"a04ee4ac-1c0b-4b64-977f-5dee61b67b69","root":false,"$title":"Count error","$position":{"top":"1195px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"014c6db8-0e98-42a9-b80b-d406c923e7c3":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c749d28-4d59-4bce-b9f1-b7313f20f367","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"welcome","typeOfStateId":"state","$connId":"con_83","$id":"a5e01e06-b5f2-4b4e-b066-c4f53f1b4292","conditions":[{"source":"context","comparison":"notEquals","values":["Sim"],"variable":"entrypoint@matched"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"cd0efe2c-dfe8-4c86-85ed-a79eba2c8c7b","$typeOfContent":"","type":"ExecuteScript","$title":"SET entrypoint","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input, entrypoints) {\n\treturn verifyEntrypoints(input, entrypoints);\n}","inputVariables":["input.content","entrypoints"],"outputVariable":"entrypoint","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"88a32c8f-fd5a-4533-9016-847f46eca567","$typeOfContent":"","type":"ExecuteScript","$title":"[C] UPDATE session","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(session, entrypoint, inputContent) {\n\ttry {\n\t\tconst origin = 'Cascata';\n\n\t\treturn updateSession(\n\t\t\tsession, \n\t\t\tentrypoint, \n\t\t\tinputContent, \n\t\t\torigin\n\t\t);\n\t} catch(e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["session","entrypoint","input.content"],"outputVariable":"session","LocalTimeZoneEnabled":false},"conditions":[{"values":["Sim"],"source":"context","comparison":"equals","variable":"entrypoint@matched"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8220b8f4-48b5-44a6-b343-52e8a1f453ad","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"014c6db8-0e98-42a9-b80b-d406c923e7c3","root":false,"$title":"Verify entrypoints","$position":{"top":"251px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c801abe4-433c-45a2-9cec-63092fca1b66":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b846775a-0a94-47e5-9e5f-8509f4b7992d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"3062c582-1e86-47d5-a432-e856b9f4463b","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(service, subflowIds) {\n\tsubflowIds = JSON.parse(subflowIds);\n\n\tconst origin = setOrigin({\n\t\tservice: service,\n\t\tstateId: '{{state.id}}',\n\t\tstateName: '{{state.name}}'\n\t});\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Finalization\n\t});\n\n\treturn redirect(origin, destination);\n}","inputVariables":["service","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8544be8d-3f67-46b7-afb8-9ab83824d0ce","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"c801abe4-433c-45a2-9cec-63092fca1b66","root":false,"$title":"Persistent Error Go to Finalization","$position":{"top":"1254px","left":"1120px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time","builder:useTunnelOwnerContext":"false","TraceTargetType":"Http","TraceMode":"All","TraceTarget":"https://take-api-beholder.cs.blip.ai/api/traces/subflowlab","TraceCacheMode":"0"}},{"shortName":"apierrorhandler2","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:16495"}],"$conditionOutputs":[{"stateId":"ed679157-831d-40e4-bb8a-8ea632f9f532","typeOfStateId":"state","$connId":"con_3","$id":"d388522f-54d6-41b6-90ac-c6b5d30a9b9b","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:16511"}],"$invalid":false,"$$hashKey":"object:16497"}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"8c44bb0d-0b26-4861-9242-3cf6e872d0ae","$typeOfContent":"","type":"SetVariable","$title":"SET service","$invalid":false,"settings":{"variable":"service","value":"API Error Handler"},"conditions":[]},{"$id":"4ff55e09-edab-4c61-b3ef-8ee77fd1278f","$typeOfContent":"","type":"ExecuteScript","$title":"SET apiGenericErrorMessage","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn \"Sorry, we had an internal problem... Try again later.\";\n}","inputVariables":[],"outputVariable":"apiGenericErrorMessage","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4d0436ac-d964-401f-841c-3a9c302935e3","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-d931d8ec-efab-4d4f-afdc-0d7cb12f9003","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"120px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:16595"}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"a07f040c-d436-42f0-89d9-f4e311224e01","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(service) {\n\n\tconst origin = setOrigin({\n\t\tservice: service,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["service"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-301d3b25-7775-45d1-acfe-55f11d0cbd82","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"118px","left":"1480.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"581px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_8","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false,"stateId":"end"}],"$enteringCustomActions":[{"$id":"73bc0710-ec3f-402b-b20d-5a7bedb2b2df","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"dfb7273d-a369-4a68-9960-65af039aa782","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(\n\tsubflow, \n\tlastStateWithInput, \n\tlastSubflowStateWithInput\n) {\n\tconst origin = setOrigin({\n\t\tservice: 'Cascade',\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\t// Handle input exception  inside a subflow\n\tif (subflow) {\n\t\tsubflow = JSON.parse(subflow);\n\n\t\tif (subflow.isActive) {\n\t\t\tlastSubflowStateWithInput = JSON.parse(lastSubflowStateWithInput);\n\n\t\t\tconst destination = setDestination({\n\t\t\t\tstateId: subflow.id,\n\t\t\t\tstateName:  subflow.name,\n\t\t\t\tsubflowStateName: lastSubflowStateWithInput.name,\n\t\t\t\tsubflowStateId: lastSubflowStateWithInput.id\n\t\t\t});\n\n\t\t\treturn redirect(origin, destination); \n\t\t}\n\t}\n\n\t// Handle input exception on parent flow\n\tlastStateWithInput = JSON.parse(lastStateWithInput);\n\n\tconst destination = setDestination({\n\t\tservice: 'Parent Flow',\n\t\tstateId: lastStateWithInput.id\n\t});\n\n\treturn redirect(origin, destination);\n}","inputVariables":["subflow","lastStateWithInput","lastSubflowStateWithInput"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-4accafe4-9308-4209-b19a-b7ecaffd6320","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"434.714px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"ed679157-831d-40e4-bb8a-8ea632f9f532":{"$contentActions":[{"action":{"$id":"b8fed64f-d599-4db8-9fa0-e4cb725fc94f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d01415e9-ba8f-4741-a276-94c310b08a0d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d01415e9-ba8f-4741-a276-94c310b08a0d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"da32df38-4160-402e-b9c2-13fa148e885d","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b065e7dc-725a-4ea4-9135-715ad2abad1f","type":"text/plain","content":"{{errorMessage}}","metadata":{}},"$cardContent":{"document":{"id":"b065e7dc-725a-4ea4-9135-715ad2abad1f","type":"text/plain","content":"{{errorMessage}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"46d25c92-a747-4946-854f-3d670667f21a","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","typeOfStateId":"state","$connId":"con_13","$id":"82420a4c-e742-4dd3-a994-0477c5656127","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"87ad6590-eb15-41d5-ac63-bf9e2226e944","$typeOfContent":"","type":"ExecuteScript","$title":"SET apiErrorMapping","$invalid":false,"settings":{"function":"run","source":"function run(apiGenericErrorMessage) {\n\tconst apiErrors = {\n\t\t\"CpfNotFound\": \"O CPF  vlido, mas no foi encontrado em nosso banco de dados.\\n\\nPodemos tentar novamente?\"\n\t};\n\n\tconst genericErrors = {\n\t\t\"default\": apiGenericErrorMessage\n\t}\n\n\treturn {\n\t\t...apiErrors,\n\t\t...genericErrors\n\t}\n}","inputVariables":["apiGenericErrorMessage"],"outputVariable":"apiErrorMapping","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b875476a-89a9-4d78-a77b-2b5bac9998e8","$typeOfContent":"","type":"ExecuteScript","$title":"SET errorMessage","$invalid":false,"settings":{"function":"run","source":"function run(apiErrorMapping, apiError) \n{\n\ttry {\n\t\tconst { id, customErrorMessage } = JSON.parse(apiError);\n\t\tapiErrorMapping = JSON.parse(apiErrorMapping);\n\n\t\tif (customErrorMessage && customErrorMessage !== 'default') \n\t\t\treturn customErrorMessage;\n\n\t\treturn apiErrorMapping[id] || apiErrorMapping['default'];\n\t}\t\n\tcatch(e) {\n\t\treturn apiErrorMapping['default'];\n\t}\n}","inputVariables":["apiErrorMapping","apiError"],"outputVariable":"errorMessage","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-88e1a643-6393-439b-99d9-008e23da81d3","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-24833af4-178d-43de-989f-72c70fd62d39","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"ed679157-831d-40e4-bb8a-8ea632f9f532","root":false,"$title":"Display error message","$position":{"top":"266.714px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"finalization2","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"dc544df9-e33e-42b3-b70d-ddb5e606f695","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"e3e2c8fb-b377-4909-8a4a-84b18136d650","$connId":"con_8","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"0a3af1b5-da6b-46a2-966f-2125fa00d6db","$typeOfContent":"","type":"TrackEvent","$title":"Service origem","$invalid":false,"settings":{"extras":{},"category":"{{subflow@name}} origem","action":"{{origin}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-20f3167c-5dac-42d5-b04a-7b086afd0bfc","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"82px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:12776"}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"9cd6492a-3bb6-446c-9622-604ee4040496","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-302548c6-4cfc-4ebc-b6eb-edf81f49a573","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"79px","left":"1530px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"540px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"dc544df9-e33e-42b3-b70d-ddb5e606f695":{"$contentActions":[{"action":{"$id":"5352d3ad-087e-424a-896a-29db31b9e3c3","$typeOfContent":"","type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000000","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000000","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left","editing":false}},"$invalid":false},{"action":{"$id":"6fd2cfcc-6c48-4380-ba6f-03524b42bce2","$typeOfContent":"","type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000001","type":"text/plain","content":"I would like to thank you! See ya! ","metadata":{}},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000001","type":"text/plain","content":"I would like to thank you! See ya! "},"editable":true,"deletable":true,"position":"left","editing":false}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"12d9958f-be3e-4bd1-8e11-8df19d026aae","type":"text/plain","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","typeOfStateId":"state","$connId":"con_13","$id":"2b381e54-bdce-48b0-b653-f88456c9e551","conditions":[{"source":"input","comparison":"notExists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9075d84c-1ab5-4cea-b305-2a34919daf5c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"dc544df9-e33e-42b3-b70d-ddb5e606f695","$title":"End conversation message","$position":{"top":"233px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:12853"}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_18","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:12869"}],"$invalid":false,"stateId":"end","$$hashKey":"object:12855"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"2823651a-eb91-4f4b-8973-6b9ab1693c2e","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id, \n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect","$$hashKey":"object:8585"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7e38dcdb-3976-41fa-a840-fa882f4cfa0c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"393px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"81px","left":"875px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"desk4","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"53c998df-561d-4a6b-a24b-c1268bea6f98","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"e3e2c8fb-b377-4909-8a4a-84b18136d650","$connId":"con_8","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"bc80133d-2a8e-49e8-a9ca-a5066d7b5a40","$typeOfContent":"","type":"TrackEvent","$title":"Service origem","$invalid":false,"settings":{"extras":{},"category":"{{subflow@name}} origem","action":"{{origin}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c1153c11-2b00-4a6f-aabe-d28af0b122cc","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"109px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"3d552173-70ef-468d-8c77-50440efbe049","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-26960a50-d74d-47aa-bce0-000038fcbe89","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"86px","left":"1781px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"248.333px","left":"2038.33px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:23106"}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_13","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:23122"}],"$invalid":false,"stateId":"end","$$hashKey":"object:23108"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"08db33b4-fdae-4fc1-b15c-bb30bcd346f4","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id, \n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect","$$hashKey":"object:23275"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d6911ea5-0f12-4c3b-9c6a-87a155137853","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"83.75px","left":"2036.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"108px","left":"877px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"desk:73c7a455-c2e3-4b07-830b-d18512c8936e":{"$contentActions":[{"input":{"bypass":false,"conditions":[{"source":"context","variable":"desk_forwardToDeskState_status","comparison":"equals","values":["Success"]}],"$cardContent":{"document":{"id":"b2082f45-8f40-4650-85e8-8e6f430205f2","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"$isDeskOutput":true,"$isDeskCustomOutput":true,"conditions":[{"source":"context","variable":"desk_forwardToDeskState_status","comparison":"equals","values":["OutOfAttendanceHour"]}],"$invalid":false,"stateId":"a69eb3e2-d1de-491f-b5c0-11905508e13a","$connId":"con_18","$id":"62f87293-34ac-45e0-acb0-dc1d6a239fb9"},{"$isDeskOutput":true,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedAttendant"]}],"$invalid":false,"stateId":"fbe8afd1-a3f6-46ae-9a24-f00f846414e4","$connId":"con_23","$id":"5841d942-77a9-49f4-a760-91c2271bfa60"},{"$isDeskOutput":true,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedClient"]}],"$invalid":false,"stateId":"fbe8afd1-a3f6-46ae-9a24-f00f846414e4","$connId":"con_28","$id":"f1cc50f5-9f3f-42a5-a460-7f601d59c00a"},{"$isDeskOutput":true,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedClientInactivity"]}],"$invalid":false,"stateId":"fbe8afd1-a3f6-46ae-9a24-f00f846414e4","$connId":"con_33","$id":"548774d8-6a00-4fb6-ba5c-743a6eb016b3"},{"$isDeskOutput":true,"$isDeskDefaultOutput":true,"conditions":[{"source":"context","variable":"desk_forwardToDeskState_status","comparison":"equals","values":["Error"]}],"stateId":"fallback","$invalid":false}],"$enteringCustomActions":[{"$id":"5b6568c6-b5f2-4f6a-becc-5284f4c00dfd","$typeOfContent":"","type":"ForwardToDesk","conditions":[],"settings":{},"$invalid":false}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"desk:73c7a455-c2e3-4b07-830b-d18512c8936e","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"desk:73c7a455-c2e3-4b07-830b-d18512c8936e","deskStateVersion":"3.0.0","root":false,"$title":"Customer service","$afterStateChangedActions":[{"$id":"b4aee71d-64b1-47a9-817d-ea592ae79ea0","$typeOfContent":"","type":"LeavingFromDesk","conditions":[],"settings":{}}],"$position":{"top":"445.714px","left":"643.857px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fbe8afd1-a3f6-46ae-9a24-f00f846414e4":{"$contentActions":[{"action":{"$id":"1f58b99e-7365-4e6c-b9a7-58e3d17bd7fc","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4afff67c-8f1e-4df8-9cf9-929078703e21","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4afff67c-8f1e-4df8-9cf9-929078703e21","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:22857"},{"action":{"$id":"88b47769-f376-488c-8f38-e424eab463c4","$typeOfContent":"text","type":"SendMessage","settings":{"id":"96a7933c-7183-4448-9d07-952d4ae8c1fd","type":"text/plain","content":"The attendance was finished!","metadata":{}},"$cardContent":{"document":{"id":"96a7933c-7183-4448-9d07-952d4ae8c1fd","type":"text/plain","content":"The attendance was finished!"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:22858"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"32fa467f-8407-496f-ab5f-fdcf973ec830","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:22859"}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"22bcfb7f-ffcf-4207-9abe-be3d92bf7c6c","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.SomethingMore\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-24d92b48-7284-4859-81ae-9d80825bb935","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-faa00536-f4de-4b4d-b575-d2e534375423","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"fbe8afd1-a3f6-46ae-9a24-f00f846414e4","root":false,"$title":"Ticket closed","$position":{"top":"594.286px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a69eb3e2-d1de-491f-b5c0-11905508e13a":{"$contentActions":[{"action":{"$id":"f28c2a5f-89c6-463e-80f2-fdab471711ca","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"037bb2d3-78c6-40d8-89ff-d8539129ea44","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"037bb2d3-78c6-40d8-89ff-d8539129ea44","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"63c49578-9449-4ab9-883f-cedc784e6251","$typeOfContent":"text","type":"SendMessage","settings":{"id":"81625cd4-6776-4fc8-b8f5-7fd5ca5d74fd","type":"text/plain","content":"However, I just noticed that we are out of our working hour for now. You can try to contact us from Monday to Friday at 8am to 6pm.","metadata":{}},"$cardContent":{"document":{"id":"81625cd4-6776-4fc8-b8f5-7fd5ca5d74fd","type":"text/plain","content":"However, I just noticed that we are out of our working hour for now. You can try to contact us from Monday to Friday at 8am to 6pm."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"b29c6a1d-980b-42a0-99f2-f350c621c9c8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"cff1c1fb-f7a1-423c-9309-54eb54eaf04f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"cff1c1fb-f7a1-423c-9309-54eb54eaf04f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3d4d602d-0f3c-442d-93f7-09297cc3bdf5","$typeOfContent":"text","type":"SendMessage","settings":{"id":"0458f342-7e7b-4ad7-9c79-d40882b76243","type":"text/plain","content":"Please, go back later.","metadata":{}},"$cardContent":{"document":{"id":"0458f342-7e7b-4ad7-9c79-d40882b76243","type":"text/plain","content":"Please, go back later."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"354cf337-d4b5-43c0-baa9-6fc724da31a1","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"6e307674-7842-4645-bfe0-80c412019f34","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(service, subflowIds) {\n\tsubflowIds = JSON.parse(subflowIds);\n\n\tconst origin = setOrigin({\n\t\tservice: service,\n\t\tstateId: '{{state.id}}',\n\t\tstateName: '{{state.name}}'\n\t});\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.PreFinalization\n\t})\n\n\treturn redirect(origin, destination);\n}","inputVariables":["service","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-075a98a9-00a9-41b5-b9af-6997f1c15901","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-0ab25461-a5de-42a8-ac4d-a15422b8820c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a69eb3e2-d1de-491f-b5c0-11905508e13a","root":false,"$title":"T.1.0.1 Out of working time","$position":{"top":"423px","left":"894px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"53c998df-561d-4a6b-a24b-c1268bea6f98":{"$contentActions":[{"action":{"$id":"0aa306ba-c991-4ba1-aca7-ec4bbdb5ed8b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d68b1cd6-f571-43fb-ab83-892b1b890b03","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d68b1cd6-f571-43fb-ab83-892b1b890b03","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"fc08d05c-fa00-496b-8f4e-b38a9a19786c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"fd2402ef-f441-4953-8faa-cdaaf070b64b","type":"text/plain","content":"I will forward you to one of ours attendants.","metadata":{}},"$cardContent":{"document":{"id":"fd2402ef-f441-4953-8faa-cdaaf070b64b","type":"text/plain","content":"I will forward you to one of ours attendants."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ead99fab-0530-4723-bb7a-98527bbf40eb","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"desk:73c7a455-c2e3-4b07-830b-d18512c8936e","typeOfStateId":"state","$connId":"con_38","$id":"2c4099c5-4a10-4abf-a604-98b5b1a503d4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8fa55800-df45-4f1a-bbdd-251ecdbd052e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"53c998df-561d-4a6b-a24b-c1268bea6f98","root":false,"$title":"T.1.0.2 Pre desk message","$position":{"top":"282px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"entrypoints3","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"c0ac19e8-6de3-473c-97b2-aa157140c54d","typeOfStateId":"state","$connId":"con_8","$id":"1828415c-5ce6-409b-a57e-7c6907d1ac85","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"f0190cca-9294-4665-a4dc-bd29039beb61","$typeOfContent":"","type":"TrackEvent","$title":"Service origem","$invalid":false,"settings":{"extras":{},"category":"{{subflow@name}} origem","action":"{{origin}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"c0ac19e8-6de3-473c-97b2-aa157140c54d","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-46306fc7-b696-4ca4-bb7a-3f6023e209c1","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"120px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"024b86e7-3a45-439c-92ea-dec1614754d1","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-863d8ed9-a091-49ec-875b-b61d3b786278","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"117px","left":"1767px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"284px","left":"1985px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_13","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false,"stateId":"end"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"71386f21-33fb-444c-a743-f4ac9c1b5b7b","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id, \n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8d22cdd6-1f03-4285-ae15-2c123afa4d39","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"118.143px","left":"1985px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"119px","left":"874px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c0ac19e8-6de3-473c-97b2-aa157140c54d":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"46374437-ffbb-4b25-8962-fbd682f00d9f","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"e9ef4b64-81d0-424d-b945-044702535c38","typeOfStateId":"state","$connId":"con_18","$id":"423e953d-99b8-4c2d-9d54-68bb6336e5cf","conditions":[{"source":"context","comparison":"notEquals","values":["null"],"variable":"entrypoint@matchContent.content"}],"$invalid":false},{"stateId":"548b7557-3b9f-4cbb-b98e-d7b132864d67","typeOfStateId":"state","$connId":"con_23","$id":"ddec39fa-bbdd-49f2-b476-096187871fa4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab"},"isAiGenerated":false,"$tags":[],"id":"c0ac19e8-6de3-473c-97b2-aa157140c54d","root":false,"$title":"Has presentation content?","$position":{"top":"265px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"e9ef4b64-81d0-424d-b945-044702535c38":{"$contentActions":[{"action":{"$id":"4385b461-0a14-4efa-977b-cb8b62109400","$typeOfContent":"media","type":"SendMessage","settings":{"id":"d12ac946-dbab-40cd-93f1-0cb740f6905b","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"{{description}}","type":"image/jpeg","uri":"{{image}}","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"d12ac946-dbab-40cd-93f1-0cb740f6905b","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"{{description}}","type":"image/jpeg","uri":"{{image}}","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:4326"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f0d30cb1-c1a5-4eb2-8936-f33283079382","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:4327"},{"action":{"$id":"75eacfd2-643f-4b38-9a84-b4d3d8bf4ee2","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"2be29054-a996-4b6f-b23c-7c4253e6dbdb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"2be29054-a996-4b6f-b23c-7c4253e6dbdb","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:4328"}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_28","$id":"7d187994-6079-4408-a1de-3a1b5fb92578","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:4350"}],"$invalid":false,"stateId":"548b7557-3b9f-4cbb-b98e-d7b132864d67","$$hashKey":"object:4340"}],"$enteringCustomActions":[{"$id":"00772590-062c-4539-b97a-833cebc3c362","$typeOfContent":"","type":"ExecuteScript","$title":"SET image","$invalid":false,"settings":{"function":"run","source":"function run(entrypoint) {\n\ttry {\n\t\tentrypoint = JSON.parse(entrypoint);\n\t\t\n\t\treturn entrypoint.matchContent.content.image;\n\t}\n\tcatch(e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["entrypoint"],"outputVariable":"image","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"8fe58bf7-c683-4ede-a6b5-b059b387ded8","$typeOfContent":"","type":"ExecuteScript","$title":"SET description","$invalid":false,"settings":{"function":"run","source":"function run(entrypoint) {\n\ttry {\n\t\tentrypoint = JSON.parse(entrypoint);\n\t\t\n\t\treturn entrypoint.matchContent.content.description;\n\t}\n\tcatch(e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["entrypoint"],"outputVariable":"description","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-54e386b0-4b5a-4b5d-8efe-6039b95d59a3","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d887c4b0-3814-4cff-85f3-fbf90396d4c1","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"e9ef4b64-81d0-424d-b945-044702535c38","root":false,"$title":"Display Content","$position":{"top":"362px","left":"365px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"7afeb5fd-c426-4333-952f-187980db27dd":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"dde48632-4516-4ae0-b32e-33847ce628c1","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"5ab1c0a9-fb0e-4a33-a750-c0646ddf0d93","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds = JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.id}}',\n\t\tstateName: '{{state.name}}'\n\t});\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Purchase\n\t})\n\n\treturn redirect(origin, destination);\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1bbf7adc-6ae9-47ca-be06-8d6393dbf1cc","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"7afeb5fd-c426-4333-952f-187980db27dd","root":false,"$title":"Website banner","$position":{"top":"622px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"548b7557-3b9f-4cbb-b98e-d7b132864d67":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"deb4f3d5-69d1-4978-8baf-cd08111927d6","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"7afeb5fd-c426-4333-952f-187980db27dd","typeOfStateId":"state","$connId":"con_33","$id":"7953e0b7-5cd1-4355-8300-ce971534e900","conditions":[{"source":"context","comparison":"equals","values":["Website banner"],"variable":"entrypoint@matchContent.source"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"548b7557-3b9f-4cbb-b98e-d7b132864d67","root":false,"$title":"Check entrypoint source","$position":{"top":"451.667px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"inactivityhandler3","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"6f4efa2e-e49d-4ca0-b0df-00bde1cee561","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"e3e2c8fb-b377-4909-8a4a-84b18136d650","$connId":"con_8","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"35d3d35d-626d-482d-b29c-8e46bf690317","$typeOfContent":"","type":"SetVariable","$title":"SET service","$invalid":false,"settings":{"variable":"service","value":"Inactivity"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"6f4efa2e-e49d-4ca0-b0df-00bde1cee561","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c14cbadb-cae1-4c03-94db-263276ebcf16","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"92px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"bcee3da8-afab-413f-8ece-e1adc419bbfa","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-45ab747d-d62d-46e5-ad33-e5cb849f28fb","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"111px","left":"2019px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"1260px","left":"656.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_13","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false,"stateId":"end"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-1459bc59-2899-4901-9d28-1030daf23f22","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"1101.43px","left":"657.286px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"91px","left":"867px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6f4efa2e-e49d-4ca0-b0df-00bde1cee561":{"$contentActions":[{"action":{"$id":"82ea63e5-0d49-4dc2-8f82-56df5b1a3e7d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d92ec30f-98db-40a8-832c-6cb7bbc56002","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d92ec30f-98db-40a8-832c-6cb7bbc56002","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"19322051-19de-4a2a-8e5f-bc4d31d54683","$typeOfContent":"text","type":"SendMessage","settings":{"id":"71a15226-39ca-473c-94cf-77a546e3e553","type":"text/plain","content":"Oh, I noticed that you were inactive.","metadata":{}},"$cardContent":{"document":{"id":"71a15226-39ca-473c-94cf-77a546e3e553","type":"text/plain","content":"Oh, I noticed that you were inactive."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"566502e4-ac4a-4853-b81c-a43a25398c52","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"109c5936-4f9f-46bc-81ed-e14d866ca68c","typeOfStateId":"state","$connId":"con_18","$id":"81d11cc9-d8fe-4288-856b-0244b011d8b2","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e0252970-ce0c-4ef1-99fa-e343b210560f","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"6f4efa2e-e49d-4ca0-b0df-00bde1cee561","root":false,"$title":"Inactivity Handler","$position":{"top":"240px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5244c7ab-e5c4-4ed9-83b8-f4e68c5ebeb0":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"935fe7b9-292c-49dc-b9e6-a48245d25b0d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"b7fe4226-15c3-4092-94c1-f2fbb872ab94","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"function run(inactivityMessage) {\n\ttry {\n\t\tinactivityMessage = JSON.parse(inactivityMessage);\n\t\treturn inactivityMessage;\n\t}\n\tcatch(e) {\n\t\treturn e.message;\n\t}\n}","inputVariables":["inactivityMessage"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-386ea16e-f4f7-4efe-a449-efb5284137d2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"5244c7ab-e5c4-4ed9-83b8-f4e68c5ebeb0","root":false,"$title":"Return to last state with inactivity","$position":{"top":"564.286px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"109c5936-4f9f-46bc-81ed-e14d866ca68c":{"$contentActions":[{"action":{"$id":"ef10b910-87ee-48d9-9a1d-11b9cdd2a2a1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"edc56952-5c9c-4ac9-8e92-48aa9c41fa90","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"edc56952-5c9c-4ac9-8e92-48aa9c41fa90","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:9590"},{"action":{"$id":"43288595-41d5-4c75-aac3-0ee76ab739d7","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:9591"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"44824da1-a541-498e-bdbe-d6cb69a5e3cb","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:9592"}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_23","$id":"84cb11bc-1e7f-46ef-963d-ab08e4fc0c08","conditions":[{"source":"context","comparison":"equals","values":["Continue"],"variable":"userInput@selection","$$hashKey":"object:9618"}],"$invalid":false,"stateId":"5244c7ab-e5c4-4ed9-83b8-f4e68c5ebeb0","$$hashKey":"object:9600"},{"stateId":"a2ade3ea-42a3-4019-bcfe-f7ea30e32016","typeOfStateId":"state","$connId":"con_28","$id":"9940ff1c-5842-4a86-90df-74987938fd47","conditions":[{"source":"context","comparison":"equals","values":["End conversation"],"variable":"userInput@selection","$$hashKey":"object:9634"}],"$invalid":false,"$$hashKey":"object:9601"}],"$enteringCustomActions":[{"$id":"3e8c2c38-a205-471a-8394-2640e1c510e6","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildQuickReply({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'What would you like to do?',\n\t\toptions: [\n\t\t\t'Continue',\n\t\t\t'End conversation'\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"470ef7a3-1bbf-4d32-9ebc-bde3a1cfb9f7","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t\"^(1)$|^(continue)$\": \"Continue\",\n\t\t\"^(2)$|^(end|quit)\\\\s*conversation$\": \"End conversation\"\n\t});\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e9f7248c-cda6-4f7b-b9dc-59010b813e72","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5b7ed2d5-26b6-4a90-b26d-b11ce06fea73","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-a0a3b3a8-a8fe-4448-8ba2-37a0dac21da6","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"109c5936-4f9f-46bc-81ed-e14d866ca68c","root":false,"$title":"Inactivity menu","$position":{"top":"402.429px","left":"644.286px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"a2ade3ea-42a3-4019-bcfe-f7ea30e32016":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ede86c4e-a2e3-4e48-91ee-0d4b0ded66fb","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c7c6557c-8193-4bd0-b541-17d5941aaa80","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(service, subflowIds) {\n\tsubflowIds = JSON.parse(subflowIds);\n\n\tconst origin = setOrigin({\n\t\tservice: service,\n\t\tstateId: '{{state.id}}',\n\t\tstateName: '{{state.name}}'\n\t});\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Finalization\n\t})\n\n\treturn redirect(origin, destination);\n}","inputVariables":["service","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"$invalid":false,"typeOfStateId":"state","stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-5c72b15b-3ebd-4f9e-a2e1-3de9d9b013ca","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"a2ade3ea-42a3-4019-bcfe-f7ea30e32016","root":false,"$title":"Inactivity Go to Finalization","$position":{"top":"390px","left":"416px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"algomais4","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"18a5764d-40ee-4fb7-ada7-9109c80c6c7e","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"e3e2c8fb-b377-4909-8a4a-84b18136d650","$connId":"con_8","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"d4ff6188-92c7-44d3-ad30-1767d8dbd444","$typeOfContent":"","type":"TrackEvent","$title":"Service origem","$invalid":false,"settings":{"extras":{},"category":"{{subflow@name}} origem","action":"{{origin}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-25e9e22f-1b6e-4221-92f0-bb018169ec4a","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"82px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"8d4d2cfb-da21-4d9c-879a-807e9dc666ac","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8fe76fa6-e052-4949-ac7b-bab00d056061","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"79px","left":"1530px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"229.714px","left":"1764px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_13","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false,"stateId":"end"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"9cba9996-dfa9-4935-8380-5560aa93e715","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id, \n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3beb67c1-b72e-4602-a2f1-230d34265800","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"78px","left":"1764px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"81px","left":"875px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"18a5764d-40ee-4fb7-ada7-9109c80c6c7e":{"$contentActions":[{"action":{"$id":"e165e080-5def-47f9-9674-2d5e67a9c4ed","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"36c77e08-6068-4e47-82c4-c9da79054794","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"36c77e08-6068-4e47-82c4-c9da79054794","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:8190"},{"action":{"$id":"7fd5aabc-0110-4915-96d1-6c1ee70c5f38","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:8191"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"84dc9e73-52a0-48c3-9cff-a1b4a795c4b0","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:8192"}],"$conditionOutputs":[{"stateId":"06a6404d-1c0b-44bf-b9bd-07422ffbbf0a","typeOfStateId":"state","$connId":"con_18","$id":"b9f57ca9-4795-4667-85f7-0a2d3f47fbe6","conditions":[{"source":"context","comparison":"equals","values":["No"],"variable":"userInput@selection","$$hashKey":"object:8218"}],"$invalid":false,"$$hashKey":"object:8200"},{"stateId":"38b73841-057c-4193-b685-0300983d9c70","typeOfStateId":"state","$connId":"con_23","$id":"d64f6802-1551-470d-a8f4-df6efa881ed7","conditions":[{"source":"context","comparison":"equals","values":["Yes"],"variable":"userInput@selection","$$hashKey":"object:8234"}],"$invalid":false,"$$hashKey":"object:8201"}],"$enteringCustomActions":[{"$id":"7480b3c6-226a-4a2c-9dcb-fe0931afe0e2","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildQuickReply({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'Can I help you with something more?',\n\t\toptions: [ 'Yes', 'No' ]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"1bd7d56c-d09a-45cc-91c0-86ff1737c5cc","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(yes|sure)$': 'Yes',\n\t\t'^(2)$|^(no)$': 'No'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"73e36f1a-7c0a-48bd-9709-c52e046f7de6","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'QuickReplyError', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': 'default'\n\t} \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-407076ee-09e2-44c5-b95a-a25476ea3e28","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-d7fe17d9-fa0c-4e61-aeb6-8d1c90e7c13a","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-ed033325-2e19-4116-9c5b-d0732fb28207","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"18a5764d-40ee-4fb7-ada7-9109c80c6c7e","root":false,"$title":"Need more help?","$position":{"top":"245px","left":"644px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"06a6404d-1c0b-44bf-b9bd-07422ffbbf0a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5dca3ae1-360e-4fd3-85a7-adb96fc50d84","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"43bd6d36-9f9d-4db7-9793-53f9e14588dd","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds = JSON.parse(subflowIds);\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tseviceId: subflow.id,\n\t\tstateId: '{{state.id}}',\n\t\tstateName: '{{state.name}}'\n\t});\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Finalization\n\t})\n\n\treturn redirect(origin, destination);\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6385ff14-e965-4ddf-bddc-659a0b452b14","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"06a6404d-1c0b-44bf-b9bd-07422ffbbf0a","root":false,"$title":"No","$position":{"top":"419px","left":"480px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"38b73841-057c-4193-b685-0300983d9c70":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"233f3e54-33a6-4955-9e6c-25ac01ba69ac","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"adf87068-4c02-4fa0-ae70-fd555d2531ca","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.MainMenu\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f97eab7f-4958-4eac-b1d5-3e60eb75128e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"38b73841-057c-4193-b685-0300983d9c70","root":false,"$title":"Yes","$position":{"top":"423px","left":"814px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"onboardingcc1","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"bab7849b-ac7d-42dc-bf01-2c52cb705459","typeOfStateId":"state","$connId":"con_8","$id":"5db33892-d0ba-4419-a881-5ca1795a4d23","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"64b79f8f-8fdf-4c80-adc3-fedc632cf54c","$typeOfContent":"","type":"TrackEvent","$title":"Service origem","$invalid":false,"settings":{"extras":{},"category":"{{subflow@name}} origem","action":"{{origin}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-94bd067f-d3af-414e-a070-fb39c5613886","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"145px","left":"674px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"369b2cbe-a364-4144-997a-974de88da360","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c7dfa837-4b83-4afb-a117-8ab3e9e3367e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"148px","left":"1590px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"303.778px","left":"1799.56px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_13","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false,"stateId":"end"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"483e3d9e-688c-4627-8863-fa055ffacca7","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id, \n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d14ccff2-24b6-4f71-a76f-0793494b0b48","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"147px","left":"1800px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"144px","left":"922px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bab7849b-ac7d-42dc-bf01-2c52cb705459":{"$contentActions":[{"action":{"$id":"8cf46a72-94cf-448d-b8d7-949f664873b6","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"cbe8394d-2195-49fa-a528-836021cb9edc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"cbe8394d-2195-49fa-a528-836021cb9edc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"288009eb-e503-4932-a236-f04c79a73dca","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4feddcac-3997-41d7-b0d0-e0fade043853","type":"text/plain","content":"Hi!  Good to see you here.","metadata":{}},"$cardContent":{"document":{"id":"4feddcac-3997-41d7-b0d0-e0fade043853","type":"text/plain","content":"Hi!  Good to see you here."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"0928e239-8774-4205-977e-627df77c8e41","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-fefa57c6-ed78-4c2a-8459-d8520e01d9ee","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bab7849b-ac7d-42dc-bf01-2c52cb705459","root":false,"$title":"Greeting","$position":{"top":"303.444px","left":"674px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"mainmenu2","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"bab7849b-ac7d-42dc-bf01-2c52cb705459","typeOfStateId":"state","$connId":"con_8","$id":"5db33892-d0ba-4419-a881-5ca1795a4d23","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"64b79f8f-8fdf-4c80-adc3-fedc632cf54c","$typeOfContent":"","type":"TrackEvent","$title":"Service origem","$invalid":false,"settings":{"extras":{},"category":"{{subflow@name}} origem","action":"{{origin}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-18d6c51c-5676-44b5-ad25-3a55661d6ffa","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"145px","left":"674px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"4375548b-c05c-4d8a-91db-24ae293d3d8c","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-0a907aa8-d204-4aba-94f4-5bf4e4b143d2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"154px","left":"1613px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"306px","left":"1814px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_13","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false,"stateId":"end"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"eeaa2f14-bc6e-4ae1-bf8b-b58dcef80ce8","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id, \n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-266e52af-baeb-4c09-9d49-81c9f69eebde","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"152px","left":"1814px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"144px","left":"922px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bab7849b-ac7d-42dc-bf01-2c52cb705459":{"$contentActions":[{"action":{"$id":"e8db4133-df20-402c-8e2e-46cd522eda71","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ed2b80ff-4bb5-4011-b967-84264aada5ff","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ed2b80ff-4bb5-4011-b967-84264aada5ff","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:1532"},{"action":{"$id":"c04aab14-89d8-4e66-9bfb-ef5f4adf7b6f","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:1533"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"0928e239-8774-4205-977e-627df77c8e41","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"0:1"},"$invalid":false,"$$hashKey":"object:1534"}],"$conditionOutputs":[{"stateId":"062588db-3c77-4459-8199-98bab8e7c8c4","typeOfStateId":"state","$connId":"con_18","$id":"193d67bc-bef8-4d91-83b7-7d57bd6a76b5","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"userInput@isValid","$$hashKey":"object:1556"}],"$invalid":false,"$$hashKey":"object:1542"}],"$enteringCustomActions":[{"$id":"0d65960e-08e8-40d1-be37-15c5234b8ad1","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'Please, select an option:',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'Eletronics', description: 'default' },\n\t\t\t\t\t{ title: 'Pet supplies', description: 'default' },\n\t\t\t\t\t{ title: 'Movies & Television', description: 'default' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"d43e0c4e-5e06-4b92-b8ae-a7b1daffc2fd","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^eletronics()$': 'Eletronics',\n\t\t'^(2)$|^(pet\\\\s*supplies)$': 'Pet Supplies',\n\t\t'^(3)$|^(movies\\\\s*&\\\\s*television)$': 'Movies & Television'\n\t});\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b43332a0-8c84-4e72-bd41-ac19e7516c53","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n  return {\n    'id': 'MenuListError',\n    'hasAIValidation': false,\n    'hasSmalltalksValidation': true,\n    'hasGlobalRegexValidation': true,\n    'customErrorMessage': 'default' \n  } \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-972c48de-22df-4ba1-9be1-d14f711fb1cc","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-b149ac2c-20cc-4b46-a161-c485afcaef7e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-1653504e-fbf2-4450-9713-f67890cfefbb","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"bab7849b-ac7d-42dc-bf01-2c52cb705459","root":false,"$title":"Select a category","$position":{"top":"362px","left":"674px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"062588db-3c77-4459-8199-98bab8e7c8c4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"26a1b111-7162-4f86-9f5a-3a1dd4ee2949","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"1768d2dd-0508-469d-b23b-e99c615c7339","$typeOfContent":"","type":"SetVariable","$title":"SET selectedOption","$invalid":false,"settings":{"variable":"selectedOption","value":"{{userInput@selection}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c94d8858-a7f4-49bd-941c-36320a59cfef","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"062588db-3c77-4459-8199-98bab8e7c8c4","root":false,"$title":"Save answer","$position":{"top":"550px","left":"674px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"eletronics","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"bab7849b-ac7d-42dc-bf01-2c52cb705459","typeOfStateId":"state","$connId":"con_8","$id":"5db33892-d0ba-4419-a881-5ca1795a4d23","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"64b79f8f-8fdf-4c80-adc3-fedc632cf54c","$typeOfContent":"","type":"TrackEvent","$title":"Service origem","$invalid":false,"settings":{"extras":{},"category":"{{subflow@name}} origem","action":"{{origin}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c127d00a-32bf-4923-86f3-a48218a2b3a0","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"160px","left":"859px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"c119ec8f-ddbc-467e-af36-7dc10ab37d81","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2b9d038b-199e-49ed-8a0a-4c90c84a0da5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"176.571px","left":"1785.71px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"325.25px","left":"2003.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_13","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false,"stateId":"end"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"38791e7d-8eb3-493a-b124-0a8e35caf416","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id, \n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-eabbf8f5-20f0-46a3-9f75-f0d52738afbe","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"173.25px","left":"2003.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"159px","left":"1110px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bab7849b-ac7d-42dc-bf01-2c52cb705459":{"$contentActions":[{"action":{"$id":"8cf46a72-94cf-448d-b8d7-949f664873b6","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"cbe8394d-2195-49fa-a528-836021cb9edc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"cbe8394d-2195-49fa-a528-836021cb9edc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"288009eb-e503-4932-a236-f04c79a73dca","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4feddcac-3997-41d7-b0d0-e0fade043853","type":"text/plain","content":"I will show you amazing <b>eletronic</b> products here!","metadata":{}},"$cardContent":{"document":{"id":"4feddcac-3997-41d7-b0d0-e0fade043853","type":"text/plain","content":"I will show you amazing <b>eletronic</b> products here!"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"0928e239-8774-4205-977e-627df77c8e41","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","typeOfStateId":"state","$connId":"con_18","$id":"fbdd7e23-93f0-4b8f-868c-fa6b4ca2d446","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-03af7fd8-57de-4dfb-9590-1cc6bca50fe8","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bab7849b-ac7d-42dc-bf01-2c52cb705459","root":false,"$title":"Eletronics","$position":{"top":"316px","left":"859px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"21f93e2d-2b19-4bcd-ae03-fff4c87d4779":{"$contentActions":[{"action":{"$id":"4b79bf01-cd18-456a-9c96-00239a11aa64","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6973a76f-fb8f-462c-9833-3ac563bcba06","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"6973a76f-fb8f-462c-9833-3ac563bcba06","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:2329"},{"action":{"$id":"c180b978-4f22-48b0-9268-74a4a821dd5c","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:2330"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"c18dbf9b-b6af-41bb-88eb-3563f6edf9c1","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:2331"}],"$conditionOutputs":[{"stateId":"06ecadc1-678f-4d22-9182-09f320264b4f","typeOfStateId":"state","$connId":"con_23","$id":"cb25ba62-d463-480f-ad87-6bd20ef92a91","conditions":[{"source":"context","comparison":"equals","values":["Headphones"],"variable":"userInput@selection","$$hashKey":"object:2361"}],"$invalid":false,"$$hashKey":"object:2339"},{"stateId":"ab364f17-c161-44ed-bd30-d9afd88e876b","typeOfStateId":"state","$connId":"con_28","$id":"bda2739b-328a-4082-8d2e-83bb6dc899dc","conditions":[{"source":"context","comparison":"equals","values":["Accessories"],"variable":"userInput@selection","$$hashKey":"object:2379"}],"$invalid":false,"$$hashKey":"object:2340"},{"stateId":"b2253ae9-ffba-44ae-99e6-1b94eda1552b","typeOfStateId":"state","$connId":"con_33","$id":"9df81f28-aa7b-4eb6-82fa-a385dfa4fa2c","conditions":[{"source":"context","comparison":"equals","values":["Cell Phones"],"variable":"userInput@selection","$$hashKey":"object:2397"}],"$invalid":false,"$$hashKey":"object:2341"},{"stateId":"1c227206-f7d9-44b8-a5da-63c99ebd79d8","typeOfStateId":"state","$connId":"con_38","$id":"689001f6-0056-4a53-a5e0-50c85c1e7ca3","conditions":[{"source":"context","comparison":"equals","values":["Change Category"],"variable":"userInput@selection","$$hashKey":"object:2413"}],"$invalid":false,"$$hashKey":"object:2342"}],"$enteringCustomActions":[{"$id":"62b25389-a788-438f-ac4d-ea3fc2865b46","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'Select a subcategory',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'Headphones', description: '' },\n\t\t\t\t\t{ title: 'Accessories', description: '' },\n\t\t\t\t\t{ title: 'Cell Phones', description: '' },\n\t\t\t\t\t{ title: 'Change Category', description: '' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"dc45e958-1472-4e00-8f50-cd648c7b557a","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(headphones?)$': 'Headphones',\n\t\t'^(2)$|^(accessories?)$': 'Accessories',\n\t\t'^(3)$|^(cell\\\\s*phones?)$': 'Cell Phones',\n\t\t'^(4)$|^(change\\\\s*category)$': 'Change Category'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"258d3d32-e167-4452-b25f-9f8c4e5e0226","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'default', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': 'Ohh, it seems that you are looking for a <b>subcategory</b> that does not exist here. Could you please select one of the options below? '\n\t} \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-674fcabf-1055-4932-abbb-52875bb4e6f2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2dbde054-6735-42b4-a945-81c4f67802ca","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-78380c41-571d-4e17-a25f-1a6fbe403f72","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","root":false,"$title":"Select an eletronic subcategory","$position":{"top":"472px","left":"859px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"06ecadc1-678f-4d22-9182-09f320264b4f":{"$contentActions":[{"action":{"$id":"5670d3e9-da94-4380-bc46-d3cfab685f13","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d37cbfae-48f2-4669-a54a-bd324e74b5dd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d37cbfae-48f2-4669-a54a-bd324e74b5dd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:2628"},{"action":{"$id":"0aa1f5d4-db97-4684-aea2-e3187e778e2f","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:2629"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"fee0dcee-c41b-4e5f-ba13-f65e91208740","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:2630"}],"$conditionOutputs":[{"stateId":"3d1e2178-1f94-4827-9f57-de91bc71d763","typeOfStateId":"state","$connId":"con_43","$id":"d5704d5f-2fd6-4f01-8551-8dfbe474e494","conditions":[{"source":"context","comparison":"equals","values":["JBL Tune 510BT"],"variable":"userInput@selection","$$hashKey":"object:2658"}],"$invalid":false,"$$hashKey":"object:2638"},{"stateId":"6cf615de-9946-488c-864d-8999c44420fe","typeOfStateId":"state","$connId":"con_48","$id":"52236959-63c6-42d5-b2bc-bc25d7c8135a","conditions":[{"source":"context","comparison":"equals","values":["Wireless Earbud"],"variable":"userInput@selection","$$hashKey":"object:2676"}],"$invalid":false,"$$hashKey":"object:2639"},{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","typeOfStateId":"state","$connId":"con_53","$id":"0914aa67-8356-4608-8688-9dcc96ce24fe","conditions":[{"source":"context","comparison":"equals","values":["Go Back"],"variable":"userInput@selection","$$hashKey":"object:2692"}],"$invalid":false,"$$hashKey":"object:2640"}],"$enteringCustomActions":[{"$id":"0e52decb-216f-40eb-bc12-36524596b3b1","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'Amazing headphones for you:',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'JBL Tune 510BT', description: '' },\n\t\t\t\t\t{ title: 'Wireless Earbud', description: '' },\n\t\t\t\t\t{ title: 'Go back', description: '' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"32bf5a61-5fe3-4e26-82f6-53b78410fc25","$typeOfContent":"","type":"SetVariable","$title":"SET subcategoryMenuId","$invalid":false,"settings":{"variable":"subcategoryMenuId","value":"{{state.id}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"d6f9ddd8-82b1-4361-ab6d-59c49ee24c2d","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(jbl\\\\s*tune\\\\s*510BT)$': 'JBL Tune 510BT',\n\t\t'^(2)$|^(wireless\\\\s*earbud)$': 'Wireless Earbud',\n\t\t'^(3)$|^(go\\\\s*back)$': 'Go Back'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"175b6e6b-dd9e-478c-bbc4-2ff3db21772b","$typeOfContent":"","type":"SetVariable","$title":"SET product","$invalid":false,"settings":{"variable":"product","value":"{{userInput@selection}}"},"conditions":[{"values":["true"],"source":"context","comparison":"equals","variable":"userInput@isValid"}]},{"$id":"38f15e55-9f29-47b5-96cb-2933129bcdb3","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'default', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': \"Oops! It seems like you've selected an option that's not on the menu. While headphones are indeed amazing, let's get back to the tune of our options. Please choose a valid menu option to continue. \"\n\t} \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-06d09f21-740b-4cfa-aeb5-e434fd2912b4","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2ebb89c6-4ba6-4981-9ba7-4089c5352ed9","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-7f8670ae-7b4f-4b83-b042-2106c56cd12b","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-0a95a05c-6e26-43cc-941b-124a7371ff74","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"06ecadc1-678f-4d22-9182-09f320264b4f","root":false,"$title":"Headphones product list","$position":{"top":"604px","left":"458px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ab364f17-c161-44ed-bd30-d9afd88e876b":{"$contentActions":[{"action":{"$id":"fb756c9f-c951-44c5-b9dd-306958eab341","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"98341e1e-c0c0-4756-b44c-6e02dbf64cf5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"98341e1e-c0c0-4756-b44c-6e02dbf64cf5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:2911"},{"action":{"$id":"76a5e7c7-c9b7-4d11-863b-16b276fa5b43","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:2912"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"a2a35c12-5cd8-465e-a235-d9c4e6969e74","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:2913"}],"$conditionOutputs":[{"stateId":"c9a8a2e1-7261-4892-b2e0-2e624267a62d","typeOfStateId":"state","$connId":"con_58","$id":"318eee30-60d0-4cc1-90eb-261f7b5b92d6","conditions":[{"source":"context","comparison":"equals","values":["Wireless Charger"],"variable":"userInput@selection","$$hashKey":"object:2939"}],"$invalid":false,"$$hashKey":"object:2921"},{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","typeOfStateId":"state","$connId":"con_63","$id":"d6e31f63-dad1-4cc3-8df5-a535e7c80b72","conditions":[{"source":"context","comparison":"equals","values":["Go Back"],"variable":"userInput@selection","$$hashKey":"object:2955"}],"$invalid":false,"$$hashKey":"object:2922"}],"$enteringCustomActions":[{"$id":"cde84a3c-ebda-4e98-995c-467e41244122","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'Amazing accessories for you:',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'Wireless Charger', description: '' },\n\t\t\t\t\t{ title: 'Go back', description: '' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b6c5794a-46ac-42f8-9763-75ce03410270","$typeOfContent":"","type":"SetVariable","$title":"SET subcategoryMenuId","$invalid":false,"settings":{"variable":"subcategoryMenuId","value":"{{state.id}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"776132a2-1983-4dc4-bc65-6e9cbb9b2b9f","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(wireless\\\\s*charger?)$': 'Wireless Charger',\n\t\t'^(2)$|^(go\\\\s*back)$': 'Go Back'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"84fefbcc-1d06-413d-bd30-721e153cbfbb","$typeOfContent":"","type":"SetVariable","$title":"SET product","$invalid":false,"settings":{"variable":"product","value":"{{userInput@selection}}"},"conditions":[{"values":["true"],"source":"context","comparison":"equals","variable":"userInput@isValid"}]},{"$id":"d58cf795-2c22-4b2f-9dd4-4654ed0d5b73","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'default', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': \"Whoops! Looks like you've dialed the wrong number on our accessory menu. Cell phone accessories are waiting for your call, but we need you to press the right buttons. Let's hang up on this mistake and try another option. \"\n\t} \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9d7b60fb-d33f-48e6-b4ad-3980e05a9cd1","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f7f3c324-7cf5-42a8-baa2-3afe47e654bc","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-bfdb94e9-8861-4c23-958b-4b3b7a3416e7","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-19ab275a-29d3-4c2e-bf75-d5066000f872","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"ab364f17-c161-44ed-bd30-d9afd88e876b","root":false,"$title":"Accessories product list","$position":{"top":"664px","left":"858px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b2253ae9-ffba-44ae-99e6-1b94eda1552b":{"$contentActions":[{"action":{"$id":"4f4773f4-b123-4c89-a731-cf6ab521f6c0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"d04d7af5-4b94-43e4-a885-a1f636e8f08e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"d04d7af5-4b94-43e4-a885-a1f636e8f08e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:3172"},{"action":{"$id":"a3b47efb-6759-461e-a893-4e6e9c4f44ed","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:3173"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"22b530d9-a56f-444b-9db6-acf121c2192e","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:3174"}],"$conditionOutputs":[{"stateId":"a814cc2b-75f8-4c59-9fd1-e7c44a01a664","typeOfStateId":"state","$connId":"con_68","$id":"d7ab0737-f0c4-4378-8df5-01285ce19087","conditions":[{"source":"context","comparison":"equals","values":["Galaxy S24+"],"variable":"userInput@selection","$$hashKey":"object:3200"}],"$invalid":false,"$$hashKey":"object:3182"},{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","typeOfStateId":"state","$connId":"con_73","$id":"c1b8b241-bc55-49d7-b430-0ea2e6cfa210","conditions":[{"source":"context","comparison":"equals","values":["Go Back"],"variable":"userInput@selection","$$hashKey":"object:3216"}],"$invalid":false,"$$hashKey":"object:3183"}],"$enteringCustomActions":[{"$id":"efe02d1b-b341-4cf5-a7e5-2593270b6907","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'Amazing cell phones for you:',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'Galaxy S24+', description: '' },\n\t\t\t\t\t{ title: 'Go back', description: '' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"17b3643c-2737-47a3-8f91-352ee1190ccc","$typeOfContent":"","type":"SetVariable","$title":"SET subcategoryMenuId","$invalid":false,"settings":{"variable":"subcategoryMenuId","value":"{{state.id}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"d04eb7fd-d767-4244-baaa-f9ef686b63c6","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(galaxy\\\\s*s24\\\\+)$': 'Galaxy S24+',\n\t\t'^(2)$|^(go\\\\s*back)$': 'Go Back'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"e44f9301-1a75-481c-bd1a-01c5c7afab4c","$typeOfContent":"","type":"SetVariable","$title":"SET product","$invalid":false,"settings":{"variable":"product","value":"{{userInput@selection}}"},"conditions":[{"values":["true"],"source":"context","comparison":"equals","variable":"userInput@isValid"}]},{"$id":"0b900c94-207b-4925-a90a-c2fa1c3c8634","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'default', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': \"Attention: The option selected is not recognized. Please review the cell phone devices menu and choose an appropriate option to continue. We appreciate your attention to this matter.\"\n\t} \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-354da581-365b-4aa0-be1c-f0d02463687c","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f10e5694-0219-4f14-8129-cf72215f1b04","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-07a8c47b-c9c9-4bfc-887d-0f0490458442","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-144b36b8-acea-4929-b818-57f949fad358","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"b2253ae9-ffba-44ae-99e6-1b94eda1552b","root":false,"$title":"Cell Phones product list","$position":{"top":"578.714px","left":"1208.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3d1e2178-1f94-4827-9f57-de91bc71d763":{"$contentActions":[{"action":{"$id":"5153f102-1e2f-4d4a-a27e-9d33cd474e5b","$typeOfContent":"media","type":"SendMessage","settings":{"id":"1b4b411e-4074-4f58-8f6a-cb477e38bc54","type":"application/vnd.lime.media-link+json","content":{"title":"<b>JBL Tune 510BT: Wireless On-Ear Headphones with Purebass Sound - Black</b>","text":"The Tune 510BT wireless headphones feature renowned JBL Pure Bass sound, which can be found in the most famous venues all around the world.Specific uses for product : Personal\n\nWith Wireless Bluetooth 5.0 Streaming, you can stream wirelessly from your device and even switch between two devices so that you don't miss a call. Dynamic frequency response range (Hz) 20 Hz  20 kHz\n\n<b>$ 34.00</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/61ZDwijKtxL._AC_UL320_.jpg","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"1b4b411e-4074-4f58-8f6a-cb477e38bc54","type":"application/vnd.lime.media-link+json","content":{"title":"<b>JBL Tune 510BT: Wireless On-Ear Headphones with Purebass Sound - Black</b>","text":"The Tune 510BT wireless headphones feature renowned JBL Pure Bass sound, which can be found in the most famous venues all around the world.Specific uses for product : Personal\n\nWith Wireless Bluetooth 5.0 Streaming, you can stream wirelessly from your device and even switch between two devices so that you don't miss a call. Dynamic frequency response range (Hz) 20 Hz  20 kHz\n\n<b>$ 34.00</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/61ZDwijKtxL._AC_UL320_.jpg","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"9bbd63dc-6c46-403c-840d-d60180a8b2d9","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"452f3dc0-42ba-4932-8bb4-6dbe4c0042e1","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fb9ed274-eea7-45c7-b620-8699c1bc1ce9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"fb9ed274-eea7-45c7-b620-8699c1bc1ce9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a73be25e-3826-4df6-959e-797559ca1967","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-447a4648-4a5a-41db-ad69-5c2f2546fef6","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"3d1e2178-1f94-4827-9f57-de91bc71d763","root":false,"$title":"JBL Tune 510BT","$position":{"top":"759px","left":"280px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"6cf615de-9946-488c-864d-8999c44420fe":{"$contentActions":[{"action":{"$id":"349ce4d8-6143-41dc-89c1-7c16bf29e474","$typeOfContent":"media","type":"SendMessage","settings":{"id":"e8dee13e-9dd9-45e1-9596-cb4d22b3985d","type":"application/vnd.lime.media-link+json","content":{"title":"<b>Wireless Earbud Bluetooth Headphones</b>","text":"\nBluetooth 5.3 and One-step Auto Pairing: The i63 wireless earbuds adopt advanced Bluetooth 5.3 technology, which ensures a more stable connection, lower delay and lower power consumption during data transmission. Support HSP, HFP, A2DP, AVRCP multiple Bluetooth protocols, and can connect multiple devices at the same time. After connecting the Bluetooth earbuds for the first time, the ear bud will automatically connect to your device the next time you open the charging case.\n\nLED Digital Display and 40H Playtime: The bluetooth earphones in ear can provide you with a total of 40 hours of battery life every time they are fully charged, the maximum battery life of the earbuds is 8 hours, and the charging box can provide 5 additional 8 hours battery life for the earbuds. The LED display on the charging box of the ear buds wireless earbuds can intuitively let you know the remaining power of the charging box and earbuds.\n\n<b>$29.99</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/71MHmh-D1CL._AC_UL320_.jpg","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"e8dee13e-9dd9-45e1-9596-cb4d22b3985d","type":"application/vnd.lime.media-link+json","content":{"title":"<b>Wireless Earbud Bluetooth Headphones</b>","text":"\nBluetooth 5.3 and One-step Auto Pairing: The i63 wireless earbuds adopt advanced Bluetooth 5.3 technology, which ensures a more stable connection, lower delay and lower power consumption during data transmission. Support HSP, HFP, A2DP, AVRCP multiple Bluetooth protocols, and can connect multiple devices at the same time. After connecting the Bluetooth earbuds for the first time, the ear bud will automatically connect to your device the next time you open the charging case.\n\nLED Digital Display and 40H Playtime: The bluetooth earphones in ear can provide you with a total of 40 hours of battery life every time they are fully charged, the maximum battery life of the earbuds is 8 hours, and the charging box can provide 5 additional 8 hours battery life for the earbuds. The LED display on the charging box of the ear buds wireless earbuds can intuitively let you know the remaining power of the charging box and earbuds.\n\n<b>$29.99</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/71MHmh-D1CL._AC_UL320_.jpg","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d91b43d5-98b5-4f03-93dc-1adf0341b6fa","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"5b0580ce-64c5-4eb5-ad1d-34aa4a0afc4b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7bd0d232-b8f0-4399-8492-840c36b967bf","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"7bd0d232-b8f0-4399-8492-840c36b967bf","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a73be25e-3826-4df6-959e-797559ca1967","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-6efc7cd9-fb62-4649-a16e-d33491dd37e2","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"6cf615de-9946-488c-864d-8999c44420fe","root":false,"$title":"Wireless Earbud","$position":{"top":"765px","left":"615px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c9a8a2e1-7261-4892-b2e0-2e624267a62d":{"$contentActions":[{"action":{"$id":"3c6c0503-2c3e-4d03-9faa-e7d247441572","$typeOfContent":"media","type":"SendMessage","settings":{"id":"0268548c-9c33-4aa7-960b-e8a750bc2608","type":"application/vnd.lime.media-link+json","content":{"title":"<b>Wireless Charger iPhone Charging Station</b>","text":"\n3 in 1 wireless charger iphone: A charging station for apple devices charging your Airpods, iPhone, and Apple Watch simultaneously. Compatible with iPhone 15 14 13 12 11 8 Pro Max Mini Plus X XR XS Max SE Plus, Apple Watch Series 9 8 7 6 5 4 3 2 SE, AirPods 2 3 pro pro 2 (Note: for Airpods 2 3, needs work with a wireless charging case ). It can also charge other phones with wireless charging capabilities\n\nFast Wireless Charging Station: To ensure fast and safe charging without damaging the devices, it's essential to use our included 18W Quick Charger 3.0 (9V - 2A) fast power adapter and charging cable. It takes about 2-3 hours for a full charge. The phone charging output up to 7.5W, earbuds charging up to 3W, and watch charging up to 2.5W\n\n<b>$10.19</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/61Mv4h1f4DL._AC_UL320_.jpg","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"0268548c-9c33-4aa7-960b-e8a750bc2608","type":"application/vnd.lime.media-link+json","content":{"title":"<b>Wireless Charger iPhone Charging Station</b>","text":"\n3 in 1 wireless charger iphone: A charging station for apple devices charging your Airpods, iPhone, and Apple Watch simultaneously. Compatible with iPhone 15 14 13 12 11 8 Pro Max Mini Plus X XR XS Max SE Plus, Apple Watch Series 9 8 7 6 5 4 3 2 SE, AirPods 2 3 pro pro 2 (Note: for Airpods 2 3, needs work with a wireless charging case ). It can also charge other phones with wireless charging capabilities\n\nFast Wireless Charging Station: To ensure fast and safe charging without damaging the devices, it's essential to use our included 18W Quick Charger 3.0 (9V - 2A) fast power adapter and charging cable. It takes about 2-3 hours for a full charge. The phone charging output up to 7.5W, earbuds charging up to 3W, and watch charging up to 2.5W\n\n<b>$10.19</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/61Mv4h1f4DL._AC_UL320_.jpg","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c1632212-a38b-4532-95f3-4cb2b6d226e9","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"7314ed63-e590-440a-bf60-a136966cb0e5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1bcd229c-3bb6-4256-a532-6e060adb790a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"1bcd229c-3bb6-4256-a532-6e060adb790a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a73be25e-3826-4df6-959e-797559ca1967","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-db45f28a-6721-4801-9da0-20bbc480df55","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c9a8a2e1-7261-4892-b2e0-2e624267a62d","root":false,"$title":"Wireless Charger","$position":{"top":"832px","left":"858px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a814cc2b-75f8-4c59-9fd1-e7c44a01a664":{"$contentActions":[{"action":{"$id":"83b0ad1d-5957-4217-9680-d90e8a332f25","$typeOfContent":"media","type":"SendMessage","settings":{"id":"26887526-54a7-4e56-a778-4a19c5b23ed9","type":"application/vnd.lime.media-link+json","content":{"title":"<b>SAMSUNG Galaxy S24+ Plus Cell Phone</b>","text":"\nCIRCLE & SEARCH IN A SNAP: Whats your favorite influencer wearing? Whered they go on vacation? Whats that word mean? Dont try to describe it  use Circle to Search1 with Google to get the answer; With S24 Series, circle it on your screen and learn more\n\nREAL EASY, REAL-TIME TRANSLATIONS: Speak foreign languages on the spot with Live Translate; Unlock the power of convenient communication with near real-time voice translations, right through your Samsung Phone app\n\n<b>$1,090.19</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/71NngboUC6L._AC_SX679_.jpg","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"26887526-54a7-4e56-a778-4a19c5b23ed9","type":"application/vnd.lime.media-link+json","content":{"title":"<b>SAMSUNG Galaxy S24+ Plus Cell Phone</b>","text":"\nCIRCLE & SEARCH IN A SNAP: Whats your favorite influencer wearing? Whered they go on vacation? Whats that word mean? Dont try to describe it  use Circle to Search1 with Google to get the answer; With S24 Series, circle it on your screen and learn more\n\nREAL EASY, REAL-TIME TRANSLATIONS: Speak foreign languages on the spot with Live Translate; Unlock the power of convenient communication with near real-time voice translations, right through your Samsung Phone app\n\n<b>$1,090.19</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/71NngboUC6L._AC_SX679_.jpg","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"d037da6a-5708-44d4-bb4b-2e5b5ae4cd04","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"dd83ce71-4772-492a-88cf-038823e0f3ab","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"edb627c8-0507-4e5d-8778-02004179b273","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"edb627c8-0507-4e5d-8778-02004179b273","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a73be25e-3826-4df6-959e-797559ca1967","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2f2c2157-8d37-4ed4-9b11-cc3008198f69","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"a814cc2b-75f8-4c59-9fd1-e7c44a01a664","root":false,"$title":"Galaxy S24+","$position":{"top":"769px","left":"1208px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a73be25e-3826-4df6-959e-797559ca1967":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a6c2f799-ee0d-4be7-a7f5-7e2097102aa9","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"47a50028-b923-42bc-b2f8-1611bc6421cd","typeOfStateId":"state","$connId":"con_78","$id":"c9e7f68a-e2c3-4650-a146-3caa4fdc74af","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"isModuleResponse"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c266e9b2-2833-401f-be72-410c42fe56de","$typeOfContent":"","type":"ExecuteScript","$title":"SET isModuleResponse","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(message) {\n\treturn isModuleResponse(message, '{{state.id}}')\n}","inputVariables":["message"],"outputVariable":"isModuleResponse","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"45c91a41-fb12-4f09-8a62-8a1ac15572ad","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect (call module)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds = JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservce: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.id}}',\n\t\tstateName: '{{state.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.ProductConfirmation\n\t})\n\t\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["false"],"source":"context","comparison":"equals","variable":"isModuleResponse"}]},{"$id":"269ee677-4328-4119-bd90-54b6011c2e67","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message","value":""},"conditions":[{"values":["true"],"source":"context","comparison":"equals","variable":"isModuleResponse"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b4375a78-ae16-4bcf-8ef8-364112a0c4a3","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-5e94df07-33e7-4977-b148-aba276f8a6ec","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"a73be25e-3826-4df6-959e-797559ca1967","root":false,"$title":"Call Product Confirmation Module","$position":{"top":"1039px","left":"853px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#d1c4e9","commentsIdList":[]}},"47a50028-b923-42bc-b2f8-1611bc6421cd":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a2b42ffe-d8be-4e66-9ca4-5f2aec0d3a09","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"2883b3cb-42c2-4079-8825-b11e7863970f","typeOfStateId":"state","$connId":"con_83","$id":"1b8f47df-dfd7-4958-b293-e5945f20ef11","conditions":[{"source":"context","comparison":"equals","values":["Yes","Sim"],"variable":"wasProductConfirmed"}],"$invalid":false},{"stateId":"60543dbb-b4ae-4b77-afdf-be8e8aa552a8","typeOfStateId":"state","$connId":"con_88","$id":"c2f471c8-3ba6-4fd9-ab46-6b29f9b3c31f","conditions":[{"source":"context","comparison":"equals","values":["No","Nao"],"variable":"wasProductConfirmed"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"47a50028-b923-42bc-b2f8-1611bc6421cd","root":false,"$title":"Was product confirmed?","$position":{"top":"1228px","left":"853px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"60543dbb-b4ae-4b77-afdf-be8e8aa552a8":{"$contentActions":[{"action":{"$id":"cefd8efa-24dd-4a6b-988b-fdbe0e4a7310","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8c6471de-a010-4da5-b6cb-77c526753cf9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8c6471de-a010-4da5-b6cb-77c526753cf9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"fe91d72c-d337-47c6-a568-ff0293e9959c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4e6460d9-9e9b-4e63-954a-894456b73368","type":"text/plain","content":"Oh! No problem... ","metadata":{}},"$cardContent":{"document":{"id":"4e6460d9-9e9b-4e63-954a-894456b73368","type":"text/plain","content":"Oh! No problem... "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"2864e515-3580-4aa9-952d-0bd003b00792","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1f497090-6259-4a2f-b694-fcf1bdf21fb5","typeOfStateId":"state","$connId":"con_93","$id":"56b20808-a37f-4b52-9dd4-98a1ec2262bd","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b5efd698-2e99-4732-86c9-9806b39d2553","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"60543dbb-b4ae-4b77-afdf-be8e8aa552a8","root":false,"$title":"No","$position":{"top":"1372.25px","left":"655px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2883b3cb-42c2-4079-8825-b11e7863970f":{"$contentActions":[{"action":{"$id":"7cfa3d3f-8548-42a9-86ad-793e77f6d36d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8f1b6611-5d70-4e14-8946-09bb5e97d6d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8f1b6611-5d70-4e14-8946-09bb5e97d6d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"43099915-27ab-4ff9-bc28-13a9f08764d6","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ed37a757-2192-4d89-88aa-91d5c588a3c3","type":"text/plain","content":"Great! I'm sure you will enjoy the <b>{{product}}</b> a lot!","metadata":{}},"$cardContent":{"document":{"id":"ed37a757-2192-4d89-88aa-91d5c588a3c3","type":"text/plain","content":"Great! I'm sure you will enjoy the <b>{{product}}</b> a lot!"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ad7f7d0a-7103-4fd0-a90d-adae55a52412","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1d1bd117-7e22-42a7-bfbd-a0f550e54446","typeOfStateId":"state","$connId":"con_98","$id":"08c2df73-c531-4ce6-b7bf-527b52c2877e","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-142bbaeb-cdcb-4632-93a3-8edc9391fec7","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2883b3cb-42c2-4079-8825-b11e7863970f","root":false,"$title":"Yes","$position":{"top":"1372.5px","left":"1042.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1c227206-f7d9-44b8-a5da-63c99ebd79d8":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"67cd7fdd-27bd-4f2c-9a52-974e60e6f1f1","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"87a58767-e6ff-44ae-b99d-7f0f02013678","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.MainMenu\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-89a1dd69-2eda-4c79-a4c9-3b27566cbd3e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1c227206-f7d9-44b8-a5da-63c99ebd79d8","root":false,"$title":"Redirect to Main Menu","$position":{"top":"345.571px","left":"1205.43px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1d1bd117-7e22-42a7-bfbd-a0f550e54446":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cd9368ef-e327-43a8-81eb-407b9368003b","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"0d011c86-1e44-41e6-8a1a-e6a4484a1ece","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Purchase\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a9dd6c2d-48b0-41a2-9461-0583e57d9cd9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1d1bd117-7e22-42a7-bfbd-a0f550e54446","root":false,"$title":"Redirect to Purchase","$position":{"top":"1534px","left":"1043px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1f497090-6259-4a2f-b694-fcf1bdf21fb5":{"$contentActions":[{"action":{"$id":"38df379c-bfa3-4d05-a0aa-02e9f3b519ff","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"642afc3e-1287-47e9-b617-461fe750d854","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"642afc3e-1287-47e9-b617-461fe750d854","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:3433"},{"action":{"$id":"9a8a4a3e-7299-45af-b338-0de978206fcc","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:3434"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"3db5ff1c-fb18-42d1-8967-cf3adf003e9f","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:3435"}],"$conditionOutputs":[{"stateId":"58e7a773-b995-48ab-a01d-6468195a6f0c","typeOfStateId":"state","$connId":"con_103","$id":"92d03830-7126-428e-b79c-d112cb14b5d9","conditions":[{"source":"context","comparison":"equals","values":["Category"],"variable":"userInput@selection","$$hashKey":"object:3465"}],"$invalid":false,"$$hashKey":"object:3443"},{"stateId":"0a8ca33f-7f5e-4f1b-af7c-2094c7a409c4","typeOfStateId":"state","$connId":"con_108","$id":"59f9f51a-c57e-4868-b065-0a8ab04b60e8","conditions":[{"source":"context","comparison":"equals","values":["Subcategory"],"variable":"userInput@selection","$$hashKey":"object:3483"}],"$invalid":false,"$$hashKey":"object:3444"},{"stateId":"03619409-97c9-4969-ad05-053ad210d576","typeOfStateId":"state","$connId":"con_113","$id":"19addc33-1e8d-4e51-9b88-82d2858f0a00","conditions":[{"source":"context","comparison":"equals","values":["Product"],"variable":"userInput@selection","$$hashKey":"object:3501"}],"$invalid":false,"$$hashKey":"object:3445"},{"stateId":"b8ee73da-d9a0-419b-9a15-073e202e6d84","typeOfStateId":"state","$connId":"con_118","$id":"efc2a3e9-00eb-4fcd-a6a7-5ed0bfddd9a3","conditions":[{"source":"context","comparison":"equals","values":["End convesation"],"variable":"userInput@selection","$$hashKey":"object:3517"}],"$invalid":false,"$$hashKey":"object:3446"}],"$enteringCustomActions":[{"$id":"eab94649-f2e8-430a-8d83-c0e42af26c83","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'So, what would you like to do?',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'Change Category', description: '' },\n\t\t\t\t\t{ title: 'Change Subcategory', description: '' },\n\t\t\t\t\t{ title: 'Change Product', description: '' },\n\t\t\t\t\t{ title: 'End Conversation', description: '' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"69f36687-26dd-4dca-b1dd-f4c879247a9b","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(change\\\\s*category)$': 'Category',\n\t\t'^(2)$|^(change\\\\s*subcategory)$': 'Subcategory',\n\t\t'^(3)$|^(change\\\\s*product)$': 'Product',\n\t\t'^(4)$|^(end\\\\s*conversation)$': 'End convesation'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f8942d89-dfa3-4936-b333-3531e60e53ab","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-fd89a3a6-bb41-4a85-897c-7e8922f9dcab","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-05f0632b-5399-4aa3-8a64-e5237e90c44a","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"1f497090-6259-4a2f-b694-fcf1bdf21fb5","root":false,"$title":"What would you like to do?","$position":{"top":"1537.25px","left":"655px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"58e7a773-b995-48ab-a01d-6468195a6f0c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"34b1f34a-5740-4f79-8dac-acf6c4eab0bf","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"2e46d643-791c-4cb7-b04e-c89a66268e36","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.MainMenu\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d8ae8a3e-88a9-46b0-8ea3-f77a480dd99d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"58e7a773-b995-48ab-a01d-6468195a6f0c","root":false,"$title":"Change Category","$position":{"top":"1403.25px","left":"316.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0a8ca33f-7f5e-4f1b-af7c-2094c7a409c4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"decf378d-95e1-496a-9989-c3952ee6660a","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"0a8ca33f-7f5e-4f1b-af7c-2094c7a409c4","root":false,"$title":"Change Subcategory","$position":{"top":"1548px","left":"316.143px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"03619409-97c9-4969-ad05-053ad210d576":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"aae47635-ee67-4332-b45e-72f39e47022a","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{subcategoryMenuId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"03619409-97c9-4969-ad05-053ad210d576","root":false,"$title":"Change product","$position":{"top":"1694px","left":"312px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b8ee73da-d9a0-419b-9a15-073e202e6d84":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b10d879d-cc3e-423a-8573-2e71975724b8","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"a46b3fbf-94c8-4082-abd1-230409d3d60c","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Finalization\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-31bb91b0-6a41-4cd8-830a-7cbe3667f8e2","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"b8ee73da-d9a0-419b-9a15-073e202e6d84","root":false,"$title":"Redirect to Finalization","$position":{"top":"1744px","left":"655px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"petsupplies","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"bab7849b-ac7d-42dc-bf01-2c52cb705459","typeOfStateId":"state","$connId":"con_8","$id":"5db33892-d0ba-4419-a881-5ca1795a4d23","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"64b79f8f-8fdf-4c80-adc3-fedc632cf54c","$typeOfContent":"","type":"TrackEvent","$title":"Service origem","$invalid":false,"settings":{"extras":{},"category":"{{subflow@name}} origem","action":"{{origin}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9efa5596-ea09-454b-abcc-de09daded01d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"160px","left":"859px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"5b225f79-f6b3-4b53-9a35-87ed6ef18ba8","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c0c4977e-9ae0-442b-ac4a-5136b013c896","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"176.571px","left":"1785.71px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"325.25px","left":"2003.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_13","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false,"stateId":"end"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"ddc9647b-7ef0-43ff-b82f-cfc159d41bd0","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id, \n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-84863204-7ff9-4051-9c53-22f6f070e283","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"173.25px","left":"2003.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"159px","left":"1110px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bab7849b-ac7d-42dc-bf01-2c52cb705459":{"$contentActions":[{"action":{"$id":"8cf46a72-94cf-448d-b8d7-949f664873b6","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"cbe8394d-2195-49fa-a528-836021cb9edc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"cbe8394d-2195-49fa-a528-836021cb9edc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"288009eb-e503-4932-a236-f04c79a73dca","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4feddcac-3997-41d7-b0d0-e0fade043853","type":"text/plain","content":"These are the best <b>pet supplies</b> that you are going  to find! ","metadata":{}},"$cardContent":{"document":{"id":"4feddcac-3997-41d7-b0d0-e0fade043853","type":"text/plain","content":"These are the best <b>pet supplies</b> that you are going  to find! "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"0928e239-8774-4205-977e-627df77c8e41","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","typeOfStateId":"state","$connId":"con_18","$id":"fbdd7e23-93f0-4b8f-868c-fa6b4ca2d446","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-becce123-2d27-4cd7-8c4e-306293a15a77","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bab7849b-ac7d-42dc-bf01-2c52cb705459","root":false,"$title":"Pet Supplies","$position":{"top":"316px","left":"859px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"21f93e2d-2b19-4bcd-ae03-fff4c87d4779":{"$contentActions":[{"action":{"$id":"4b79bf01-cd18-456a-9c96-00239a11aa64","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6973a76f-fb8f-462c-9833-3ac563bcba06","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"6973a76f-fb8f-462c-9833-3ac563bcba06","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:4230"},{"action":{"$id":"c180b978-4f22-48b0-9268-74a4a821dd5c","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:4231"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"c18dbf9b-b6af-41bb-88eb-3563f6edf9c1","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:4232"}],"$conditionOutputs":[{"stateId":"ab364f17-c161-44ed-bd30-d9afd88e876b","typeOfStateId":"state","$connId":"con_23","$id":"bda2739b-328a-4082-8d2e-83bb6dc899dc","conditions":[{"source":"context","comparison":"equals","values":["Dog Food"],"variable":"userInput@selection","$$hashKey":"object:4258"}],"$invalid":false,"$$hashKey":"object:4240"},{"stateId":"1c227206-f7d9-44b8-a5da-63c99ebd79d8","typeOfStateId":"state","$connId":"con_28","$id":"689001f6-0056-4a53-a5e0-50c85c1e7ca3","conditions":[{"source":"context","comparison":"equals","values":["Change Category"],"variable":"userInput@selection","$$hashKey":"object:4274"}],"$invalid":false,"$$hashKey":"object:4241"}],"$enteringCustomActions":[{"$id":"62b25389-a788-438f-ac4d-ea3fc2865b46","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'Which Pet Supplies are you looking for?',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'Dog Food', description: '' },\n\t\t\t\t\t{ title: 'Change Category', description: '' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"dc45e958-1472-4e00-8f50-cd648c7b557a","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(dog\\\\s*food)$': 'Dog Food',\n\t\t'^(4)$|^(change\\\\s*category)$': 'Change Category'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4d22f151-be61-4f6e-b2ac-a422c29de4a9","$typeOfContent":"","type":"ExecuteScript","$title":"SET petErrorCount","$invalid":false,"settings":{"function":"run","source":"function run(petErrorCount) {\n\ttry {\n\t\tif (!petErrorCount || parseInt(petErrorCount) > 2) {\n\t\t\treturn 1;\n\t\t}\n\n\t\treturn parseInt(petErrorCount) + 1;\n\t}\n\tcatch(e) {\n\t\treturn 1; \n\t}\n}","inputVariables":["petErrorCount"],"outputVariable":"petErrorCount","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4577d054-f72b-43c8-9708-b2e635d2166d","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run(petErrorCount) {\n\tpetErrorCount = parseInt(petErrorCount);\n\n\tconst message = {\n\t\t'1': \"Looks like someone's got their paws on the keyboard. We can't find that option, but we're pretty sure our furry friends didn't eat it. Please try again or we'll have to unleash the hounds of error-handling!\",\n\t\t'2':  `Uh-oh! The cat's out of the bag, and it's playing with the menu options again! We couldn't fetch your request. Let's not blame the dog this time, shall we? Give it another go, or we'll assume you're just here to play fetch!`,\n\t\t'3': 'Alert! The pets have staged a coup and the options are in disarray! Retreat, regroup, and retry!'\n\t}\n\n\treturn {\n\t\t'id': 'default', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': message[petErrorCount.toString()] || 'default'\n\t} \n}","inputVariables":["petErrorCount"],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-74426f1b-6667-43f6-b4d8-fc8fe4c2215d","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3a503275-7cbf-49d2-a2f6-78ad766b7564","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-fcc5b1e6-35de-4c31-b30b-0664edfe31e1","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","root":false,"$title":"Select a a pet supply subcategory","$position":{"top":"472px","left":"859px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ab364f17-c161-44ed-bd30-d9afd88e876b":{"$contentActions":[{"action":{"$id":"fb756c9f-c951-44c5-b9dd-306958eab341","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"98341e1e-c0c0-4756-b44c-6e02dbf64cf5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"98341e1e-c0c0-4756-b44c-6e02dbf64cf5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:4488"},{"action":{"$id":"76a5e7c7-c9b7-4d11-863b-16b276fa5b43","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:4489"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"a2a35c12-5cd8-465e-a235-d9c4e6969e74","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:4490"}],"$conditionOutputs":[{"stateId":"c9a8a2e1-7261-4892-b2e0-2e624267a62d","typeOfStateId":"state","$connId":"con_33","$id":"318eee30-60d0-4cc1-90eb-261f7b5b92d6","conditions":[{"source":"context","comparison":"equals","values":["Wellness CORE"],"variable":"userInput@selection","$$hashKey":"object:4516"}],"$invalid":false,"$$hashKey":"object:4498"},{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","typeOfStateId":"state","$connId":"con_38","$id":"d6e31f63-dad1-4cc3-8df5-a535e7c80b72","conditions":[{"source":"context","comparison":"equals","values":["Go Back"],"variable":"userInput@selection","$$hashKey":"object:4532"}],"$invalid":false,"$$hashKey":"object:4499"}],"$enteringCustomActions":[{"$id":"cde84a3c-ebda-4e98-995c-467e41244122","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'Select an option:',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'Wellness CORE', description: '' },\n\t\t\t\t\t{ title: 'Go back', description: '' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b6c5794a-46ac-42f8-9763-75ce03410270","$typeOfContent":"","type":"SetVariable","$title":"SET subcategoryMenuId","$invalid":false,"settings":{"variable":"subcategoryMenuId","value":"{{state.id}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"776132a2-1983-4dc4-bc65-6e9cbb9b2b9f","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(wellness\\\\s*core)$': 'Wellness CORE',\n\t\t'^(2)$|^(go\\\\s*back)$': 'Go Back'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"84fefbcc-1d06-413d-bd30-721e153cbfbb","$typeOfContent":"","type":"SetVariable","$title":"SET product","$invalid":false,"settings":{"variable":"product","value":"{{userInput@selection}}"},"conditions":[{"values":["true"],"source":"context","comparison":"equals","variable":"userInput@isValid"}]},{"$id":"14d6189d-71c8-4e65-ad8f-eb711115a694","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'MenuListError', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': 'default'\n\t} \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-09a5c656-6bb5-4131-9c0a-e2f3ebaaa6fc","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8c4bed2b-5168-4ba6-9dcb-42f9348039f1","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-8597c157-1302-45cc-b97b-90ae44781093","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-8afea48f-24eb-4280-aae7-40474d4f4386","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"ab364f17-c161-44ed-bd30-d9afd88e876b","root":false,"$title":"Dogs supplies product list","$position":{"top":"664px","left":"858px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c9a8a2e1-7261-4892-b2e0-2e624267a62d":{"$contentActions":[{"action":{"$id":"3c6c0503-2c3e-4d03-9faa-e7d247441572","$typeOfContent":"media","type":"SendMessage","settings":{"id":"0268548c-9c33-4aa7-960b-e8a750bc2608","type":"application/vnd.lime.media-link+json","content":{"title":"<b>Wellness CORE Bowl Boosters</b>","text":"Brand\tWellness\nFlavor\tImmune Health\nDiet Type\tVeterinary Diet\nAge Range (Description)\tAll Life Stages\nItem Form\tPellet\n\n<b>$24.72</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/71cv+ZZ2aCL._AC_SX679_.jpg","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"0268548c-9c33-4aa7-960b-e8a750bc2608","type":"application/vnd.lime.media-link+json","content":{"title":"<b>Wellness CORE Bowl Boosters</b>","text":"Brand\tWellness\nFlavor\tImmune Health\nDiet Type\tVeterinary Diet\nAge Range (Description)\tAll Life Stages\nItem Form\tPellet\n\n<b>$24.72</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/71cv+ZZ2aCL._AC_SX679_.jpg","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c1632212-a38b-4532-95f3-4cb2b6d226e9","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"6cb038ee-59ef-4688-b593-6f4a6e1282e6","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8657ac13-9dd6-45d7-8c44-e025d13ffbbe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"8657ac13-9dd6-45d7-8c44-e025d13ffbbe","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a73be25e-3826-4df6-959e-797559ca1967","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-03b218c9-7d7c-4ad4-bfe9-75cad04be9ee","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c9a8a2e1-7261-4892-b2e0-2e624267a62d","root":false,"$title":"Wellness CORE","$position":{"top":"832px","left":"858px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a73be25e-3826-4df6-959e-797559ca1967":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a6c2f799-ee0d-4be7-a7f5-7e2097102aa9","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"47a50028-b923-42bc-b2f8-1611bc6421cd","typeOfStateId":"state","$connId":"con_43","$id":"c9e7f68a-e2c3-4650-a146-3caa4fdc74af","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"isModuleResponse"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c266e9b2-2833-401f-be72-410c42fe56de","$typeOfContent":"","type":"ExecuteScript","$title":"SET isModuleResponse","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(message) {\n\treturn isModuleResponse(message, '{{state.id}}')\n}","inputVariables":["message"],"outputVariable":"isModuleResponse","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"3eb1e11f-36da-445d-8d8f-67f0361a4738","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect (call module)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.id}}',\n\t\tstateName: '{{state.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.ProductConfirmation\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"269ee677-4328-4119-bd90-54b6011c2e67","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message","value":""},"conditions":[{"values":["true"],"source":"context","comparison":"equals","variable":"isModuleResponse"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-85f84304-85d0-4529-be8d-a61da8f8f9de","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-2aac0375-e693-4313-a605-0f375091b64b","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"a73be25e-3826-4df6-959e-797559ca1967","root":false,"$title":"Call Product Confirmation Module","$position":{"top":"1039px","left":"853px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#d1c4e9"}},"47a50028-b923-42bc-b2f8-1611bc6421cd":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a2b42ffe-d8be-4e66-9ca4-5f2aec0d3a09","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"2883b3cb-42c2-4079-8825-b11e7863970f","typeOfStateId":"state","$connId":"con_48","$id":"1b8f47df-dfd7-4958-b293-e5945f20ef11","conditions":[{"source":"context","comparison":"equals","values":["Yes","Sim"],"variable":"wasProductConfirmed"}],"$invalid":false},{"stateId":"60543dbb-b4ae-4b77-afdf-be8e8aa552a8","typeOfStateId":"state","$connId":"con_53","$id":"c2f471c8-3ba6-4fd9-ab46-6b29f9b3c31f","conditions":[{"source":"context","comparison":"equals","values":["No","Nao"],"variable":"wasProductConfirmed"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"47a50028-b923-42bc-b2f8-1611bc6421cd","root":false,"$title":"Was product confirmed?","$position":{"top":"1228px","left":"853px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"60543dbb-b4ae-4b77-afdf-be8e8aa552a8":{"$contentActions":[{"action":{"$id":"cd03412c-dcea-49fe-a4a8-abe259de9d89","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1b9a48ac-06af-4c3a-8c07-563b90f0a8f9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1b9a48ac-06af-4c3a-8c07-563b90f0a8f9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"ac1be163-8959-4f8a-9bb5-524ca50af259","$typeOfContent":"media","type":"SendMessage","settings":{"id":"c39fb07e-e70c-47ac-829f-61dc622a1508","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://i.pinimg.com/474x/40/82/3e/40823e316922640922ed6ae3f5e90c16.jpg","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"c39fb07e-e70c-47ac-829f-61dc622a1508","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://i.pinimg.com/474x/40/82/3e/40823e316922640922ed6ae3f5e90c16.jpg","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"2864e515-3580-4aa9-952d-0bd003b00792","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1f497090-6259-4a2f-b694-fcf1bdf21fb5","typeOfStateId":"state","$connId":"con_58","$id":"56b20808-a37f-4b52-9dd4-98a1ec2262bd","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c550a349-c70f-4f29-88d9-4077b3f4b1eb","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"60543dbb-b4ae-4b77-afdf-be8e8aa552a8","root":false,"$title":"No","$position":{"top":"1372.25px","left":"655px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2883b3cb-42c2-4079-8825-b11e7863970f":{"$contentActions":[{"action":{"$id":"7cfa3d3f-8548-42a9-86ad-793e77f6d36d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8f1b6611-5d70-4e14-8946-09bb5e97d6d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8f1b6611-5d70-4e14-8946-09bb5e97d6d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"43099915-27ab-4ff9-bc28-13a9f08764d6","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ed37a757-2192-4d89-88aa-91d5c588a3c3","type":"text/plain","content":"Great! I'm sure you will enjoy the <b>{{product}}</b> a lot!","metadata":{}},"$cardContent":{"document":{"id":"ed37a757-2192-4d89-88aa-91d5c588a3c3","type":"text/plain","content":"Great! I'm sure you will enjoy the <b>{{product}}</b> a lot!"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ad7f7d0a-7103-4fd0-a90d-adae55a52412","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1d1bd117-7e22-42a7-bfbd-a0f550e54446","typeOfStateId":"state","$connId":"con_63","$id":"08c2df73-c531-4ce6-b7bf-527b52c2877e","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-c3c0de3d-f144-463c-8a32-0bb6f2ebb161","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2883b3cb-42c2-4079-8825-b11e7863970f","root":false,"$title":"Yes","$position":{"top":"1372.5px","left":"1042.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1c227206-f7d9-44b8-a5da-63c99ebd79d8":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"67cd7fdd-27bd-4f2c-9a52-974e60e6f1f1","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"9d5e43c1-32c3-44fa-a9ea-496dfef3a940","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.MainMenu\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-bdcaf8a1-3399-4919-a1f8-a4b39f8306d9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1c227206-f7d9-44b8-a5da-63c99ebd79d8","root":false,"$title":"Redirect to Main Menu","$position":{"top":"484px","left":"1147px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1d1bd117-7e22-42a7-bfbd-a0f550e54446":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cd9368ef-e327-43a8-81eb-407b9368003b","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"cbe479e0-434a-47e5-ba63-12ab0dae940c","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Purchase\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3f24db0a-26bd-4b16-b1f8-7279473ea9f9","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1d1bd117-7e22-42a7-bfbd-a0f550e54446","root":false,"$title":"Redirect to Purchase","$position":{"top":"1534px","left":"1043px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1f497090-6259-4a2f-b694-fcf1bdf21fb5":{"$contentActions":[{"action":{"$id":"38df379c-bfa3-4d05-a0aa-02e9f3b519ff","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"642afc3e-1287-47e9-b617-461fe750d854","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"642afc3e-1287-47e9-b617-461fe750d854","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:4749"},{"action":{"$id":"9a8a4a3e-7299-45af-b338-0de978206fcc","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:4750"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"3db5ff1c-fb18-42d1-8967-cf3adf003e9f","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:4751"}],"$conditionOutputs":[{"stateId":"58e7a773-b995-48ab-a01d-6468195a6f0c","typeOfStateId":"state","$connId":"con_68","$id":"92d03830-7126-428e-b79c-d112cb14b5d9","conditions":[{"source":"context","comparison":"equals","values":["Category"],"variable":"userInput@selection","$$hashKey":"object:4781"}],"$invalid":false,"$$hashKey":"object:4759"},{"stateId":"0a8ca33f-7f5e-4f1b-af7c-2094c7a409c4","typeOfStateId":"state","$connId":"con_73","$id":"59f9f51a-c57e-4868-b065-0a8ab04b60e8","conditions":[{"source":"context","comparison":"equals","values":["Subcategory"],"variable":"userInput@selection","$$hashKey":"object:4799"}],"$invalid":false,"$$hashKey":"object:4760"},{"stateId":"03619409-97c9-4969-ad05-053ad210d576","typeOfStateId":"state","$connId":"con_78","$id":"19addc33-1e8d-4e51-9b88-82d2858f0a00","conditions":[{"source":"context","comparison":"equals","values":["Product"],"variable":"userInput@selection","$$hashKey":"object:4817"}],"$invalid":false,"$$hashKey":"object:4761"},{"stateId":"b8ee73da-d9a0-419b-9a15-073e202e6d84","typeOfStateId":"state","$connId":"con_83","$id":"efc2a3e9-00eb-4fcd-a6a7-5ed0bfddd9a3","conditions":[{"source":"context","comparison":"equals","values":["End convesation"],"variable":"userInput@selection","$$hashKey":"object:4833"}],"$invalid":false,"$$hashKey":"object:4762"}],"$enteringCustomActions":[{"$id":"eab94649-f2e8-430a-8d83-c0e42af26c83","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'So, what would you like to do?',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'Change Category', description: '' },\n\t\t\t\t\t{ title: 'Change Subcategory', description: '' },\n\t\t\t\t\t{ title: 'Change Product', description: '' },\n\t\t\t\t\t{ title: 'End Conversation', description: '' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"69f36687-26dd-4dca-b1dd-f4c879247a9b","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(change\\\\s*category)$': 'Category',\n\t\t'^(2)$|^(change\\\\s*subcategory)$': 'Subcategory',\n\t\t'^(3)$|^(change\\\\s*product)$': 'Product',\n\t\t'^(4)$|^(end\\\\s*conversation)$': 'End convesation'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e3fa81fe-a45a-4a0a-86fb-6e654238e746","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-f6bf4ed4-e167-439c-aee6-91838d12fde1","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-3b7ff896-2e57-4e46-a895-a281caad7ef3","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"1f497090-6259-4a2f-b694-fcf1bdf21fb5","root":false,"$title":"What would you like to do?","$position":{"top":"1537.25px","left":"655px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"58e7a773-b995-48ab-a01d-6468195a6f0c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"34b1f34a-5740-4f79-8dac-acf6c4eab0bf","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"bb6d5524-5a4a-46c7-9f13-8519408f4a02","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.MainMenu\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-cac3e3cc-5064-4af6-8ff3-4911b55f4210","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"58e7a773-b995-48ab-a01d-6468195a6f0c","root":false,"$title":"Change Category","$position":{"top":"1403.25px","left":"316.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0a8ca33f-7f5e-4f1b-af7c-2094c7a409c4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"decf378d-95e1-496a-9989-c3952ee6660a","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"0a8ca33f-7f5e-4f1b-af7c-2094c7a409c4","root":false,"$title":"Change Subcategory","$position":{"top":"1548px","left":"316.143px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"03619409-97c9-4969-ad05-053ad210d576":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"aae47635-ee67-4332-b45e-72f39e47022a","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{subcategoryMenuId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"03619409-97c9-4969-ad05-053ad210d576","root":false,"$title":"Change product","$position":{"top":"1694px","left":"312px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b8ee73da-d9a0-419b-9a15-073e202e6d84":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b10d879d-cc3e-423a-8573-2e71975724b8","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"048bbe3e-b8e0-4b79-ab18-55c8e46947ba","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Finalization\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-caa68445-6781-41c2-b43c-93437b51bf32","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"b8ee73da-d9a0-419b-9a15-073e202e6d84","root":false,"$title":"Redirect to Finalization","$position":{"top":"1744px","left":"655px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"moviestelevision","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"bab7849b-ac7d-42dc-bf01-2c52cb705459","typeOfStateId":"state","$connId":"con_8","$id":"5db33892-d0ba-4419-a881-5ca1795a4d23","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"64b79f8f-8fdf-4c80-adc3-fedc632cf54c","$typeOfContent":"","type":"TrackEvent","$title":"Service origem","$invalid":false,"settings":{"extras":{},"category":"{{subflow@name}} origem","action":"{{origin}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3da64eb5-c681-47ac-836c-650c8dd2ef4d","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"160px","left":"859px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"d47ae086-1f99-4a56-b462-ef1813509b57","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9e75d628-6c0a-49f3-8ae2-c29b748023f5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"176.571px","left":"1785.71px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"325.25px","left":"2003.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_13","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false,"stateId":"end"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"0fb264cd-4ebc-4abe-9b2f-b66ba0428590","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id, \n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-21d60fed-6a05-4c82-b6d0-d4615ed40f40","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"173.25px","left":"2003.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"159px","left":"1110px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bab7849b-ac7d-42dc-bf01-2c52cb705459":{"$contentActions":[{"action":{"$id":"8cf46a72-94cf-448d-b8d7-949f664873b6","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"cbe8394d-2195-49fa-a528-836021cb9edc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"cbe8394d-2195-49fa-a528-836021cb9edc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"288009eb-e503-4932-a236-f04c79a73dca","$typeOfContent":"text","type":"SendMessage","settings":{"id":"4feddcac-3997-41d7-b0d0-e0fade043853","type":"text/plain","content":"Here you can see the best movies!","metadata":{}},"$cardContent":{"document":{"id":"4feddcac-3997-41d7-b0d0-e0fade043853","type":"text/plain","content":"Here you can see the best movies!"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"0928e239-8774-4205-977e-627df77c8e41","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","typeOfStateId":"state","$connId":"con_18","$id":"fbdd7e23-93f0-4b8f-868c-fa6b4ca2d446","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3519ba11-a622-41cc-976b-449cd17cad42","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"bab7849b-ac7d-42dc-bf01-2c52cb705459","root":false,"$title":"Movies","$position":{"top":"316px","left":"859px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"21f93e2d-2b19-4bcd-ae03-fff4c87d4779":{"$contentActions":[{"action":{"$id":"4b79bf01-cd18-456a-9c96-00239a11aa64","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6973a76f-fb8f-462c-9833-3ac563bcba06","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"6973a76f-fb8f-462c-9833-3ac563bcba06","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:5546"},{"action":{"$id":"c180b978-4f22-48b0-9268-74a4a821dd5c","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:5547"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"c18dbf9b-b6af-41bb-88eb-3563f6edf9c1","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:5548"}],"$conditionOutputs":[{"stateId":"ab364f17-c161-44ed-bd30-d9afd88e876b","typeOfStateId":"state","$connId":"con_23","$id":"bda2739b-328a-4082-8d2e-83bb6dc899dc","conditions":[{"source":"context","comparison":"equals","values":["Movies"],"variable":"userInput@selection","$$hashKey":"object:5574"}],"$invalid":false,"$$hashKey":"object:5556"},{"stateId":"1c227206-f7d9-44b8-a5da-63c99ebd79d8","typeOfStateId":"state","$connId":"con_28","$id":"689001f6-0056-4a53-a5e0-50c85c1e7ca3","conditions":[{"source":"context","comparison":"equals","values":["Change Category"],"variable":"userInput@selection","$$hashKey":"object:5590"}],"$invalid":false,"$$hashKey":"object:5557"}],"$enteringCustomActions":[{"$id":"62b25389-a788-438f-ac4d-ea3fc2865b46","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'Select a subcategory',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'Movies', description: '' },\n\t\t\t\t\t{ title: 'Change Category', description: '' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"dc45e958-1472-4e00-8f50-cd648c7b557a","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(movies?)$': 'Movies',\n\t\t'^(2)$|^(change\\\\s*category)$': 'Change Category'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"5e831c8d-f9a9-4a9a-87e2-4520099ce570","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'MenuListError', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': 'default'\n\t} \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e70c9b75-2876-48b6-88ad-710b175efe16","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-ad9d0c43-ad4e-457e-ad27-0da89ac45c2d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-6d97ac2a-0e00-40ef-83ad-0ee3183c51b2","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","root":false,"$title":"Select a subcategory","$position":{"top":"472px","left":"859px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ab364f17-c161-44ed-bd30-d9afd88e876b":{"$contentActions":[{"action":{"$id":"fb756c9f-c951-44c5-b9dd-306958eab341","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"98341e1e-c0c0-4756-b44c-6e02dbf64cf5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"98341e1e-c0c0-4756-b44c-6e02dbf64cf5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:5801"},{"action":{"$id":"76a5e7c7-c9b7-4d11-863b-16b276fa5b43","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:5802"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"a2a35c12-5cd8-465e-a235-d9c4e6969e74","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:5803"}],"$conditionOutputs":[{"stateId":"c9a8a2e1-7261-4892-b2e0-2e624267a62d","typeOfStateId":"state","$connId":"con_33","$id":"318eee30-60d0-4cc1-90eb-261f7b5b92d6","conditions":[{"source":"context","comparison":"equals","values":["Minions"],"variable":"userInput@selection","$$hashKey":"object:5829"}],"$invalid":false,"$$hashKey":"object:5811"},{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","typeOfStateId":"state","$connId":"con_38","$id":"d6e31f63-dad1-4cc3-8df5-a535e7c80b72","conditions":[{"source":"context","comparison":"equals","values":["Go Back"],"variable":"userInput@selection","$$hashKey":"object:5845"}],"$invalid":false,"$$hashKey":"object:5812"}],"$enteringCustomActions":[{"$id":"cde84a3c-ebda-4e98-995c-467e41244122","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'Amazing movies for you :',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'Minions: The Rise of Gru', description: '' },\n\t\t\t\t\t{ title: 'Go back', description: '' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b6c5794a-46ac-42f8-9763-75ce03410270","$typeOfContent":"","type":"SetVariable","$title":"SET subcategoryMenuId","$invalid":false,"settings":{"variable":"subcategoryMenuId","value":"{{state.id}}"},"conditions":[]}],"$leavingCustomActions":[{"$id":"776132a2-1983-4dc4-bc65-6e9cbb9b2b9f","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|minions': 'Minions',\n\t\t'^(2)$|^(go\\\\s*back)$': 'Go Back'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"84fefbcc-1d06-413d-bd30-721e153cbfbb","$typeOfContent":"","type":"SetVariable","$title":"SET product","$invalid":false,"settings":{"variable":"product","value":"{{userInput@selection}}"},"conditions":[{"values":["true"],"source":"context","comparison":"equals","variable":"userInput@isValid"}]},{"$id":"f113d591-3284-4ff6-a482-49c4de8425c8","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'MenuListError', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': 'default'\n\t} \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d5c3ce8c-fa56-42ed-85e8-36c5e501367a","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-bb88a9a3-838c-4aed-beb0-64a5f7b20537","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false},{"id":"blip-tag-4524e661-16c8-47da-a454-cb296d6f5d28","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-0ca684b0-083d-4317-bf69-1a5d51c8c3f9","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"ab364f17-c161-44ed-bd30-d9afd88e876b","root":false,"$title":"Movies list","$position":{"top":"664px","left":"858px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c9a8a2e1-7261-4892-b2e0-2e624267a62d":{"$contentActions":[{"action":{"$id":"3c6c0503-2c3e-4d03-9faa-e7d247441572","$typeOfContent":"media","type":"SendMessage","settings":{"id":"0268548c-9c33-4aa7-960b-e8a750bc2608","type":"application/vnd.lime.media-link+json","content":{"title":"<b>Minions: The Rise of Gru</b>","text":"\nTeenage Gru joins forces with Kevin, Stuart and Bob to defeat the Vicious 6 in an adventure featuring spectacular action and the franchise's signature subversive humor.\n\n<b>$2.00</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/81VzcSnpDeL._AC_UL320_.jpg","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"0268548c-9c33-4aa7-960b-e8a750bc2608","type":"application/vnd.lime.media-link+json","content":{"title":"<b>Minions: The Rise of Gru</b>","text":"\nTeenage Gru joins forces with Kevin, Stuart and Bob to defeat the Vicious 6 in an adventure featuring spectacular action and the franchise's signature subversive humor.\n\n<b>$2.00</b>","type":"image/jpeg","uri":"https://m.media-amazon.com/images/I/81VzcSnpDeL._AC_UL320_.jpg","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c1632212-a38b-4532-95f3-4cb2b6d226e9","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false},{"action":{"$id":"7b785f0d-fa4d-406b-aad7-f3ad668a3ca4","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fdd86591-ed94-46c9-b501-b512e8450bb7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"fdd86591-ed94-46c9-b501-b512e8450bb7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"a73be25e-3826-4df6-959e-797559ca1967","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-7e09467b-0e9c-49db-bbe0-af8c9e11c56e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"c9a8a2e1-7261-4892-b2e0-2e624267a62d","root":false,"$title":"Minions: The Rise of Gru","$position":{"top":"832px","left":"858px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a73be25e-3826-4df6-959e-797559ca1967":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a6c2f799-ee0d-4be7-a7f5-7e2097102aa9","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"47a50028-b923-42bc-b2f8-1611bc6421cd","typeOfStateId":"state","$connId":"con_43","$id":"c9e7f68a-e2c3-4650-a146-3caa4fdc74af","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"isModuleResponse"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c266e9b2-2833-401f-be72-410c42fe56de","$typeOfContent":"","type":"ExecuteScript","$title":"SET isModuleResponse","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(message) {\n\treturn isModuleResponse(message, '{{state.id}}')\n}","inputVariables":["message"],"outputVariable":"isModuleResponse","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"45c91a41-fb12-4f09-8a62-8a1ac15572ad","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect (Call module)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds = JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservce: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.id}}',\n\t\tstateName: '{{state.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.ProductConfirmation\n\t})\n\t\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["false"],"source":"context","comparison":"equals","variable":"isModuleResponse"}]},{"$id":"269ee677-4328-4119-bd90-54b6011c2e67","$typeOfContent":"","type":"SetVariable","$title":"RESET message","$invalid":false,"settings":{"variable":"message","value":""},"conditions":[{"values":["true"],"source":"context","comparison":"equals","variable":"isModuleResponse"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-f5218e09-3ed0-4dc0-a96a-b1f782f747ef","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-8627be7d-5598-4426-9a66-f1312a0467e2","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"a73be25e-3826-4df6-959e-797559ca1967","root":false,"$title":"Call Product Confirmation Module","$position":{"top":"1039px","left":"853px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"addonsSettings":{"backgroundColor":"#d1c4e9"}},"47a50028-b923-42bc-b2f8-1611bc6421cd":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a2b42ffe-d8be-4e66-9ca4-5f2aec0d3a09","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"2883b3cb-42c2-4079-8825-b11e7863970f","typeOfStateId":"state","$connId":"con_48","$id":"1b8f47df-dfd7-4958-b293-e5945f20ef11","conditions":[{"source":"context","comparison":"equals","values":["Yes","Sim"],"variable":"wasProductConfirmed"}],"$invalid":false},{"stateId":"60543dbb-b4ae-4b77-afdf-be8e8aa552a8","typeOfStateId":"state","$connId":"con_53","$id":"c2f471c8-3ba6-4fd9-ab46-6b29f9b3c31f","conditions":[{"source":"context","comparison":"equals","values":["No","Nao"],"variable":"wasProductConfirmed"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"47a50028-b923-42bc-b2f8-1611bc6421cd","root":false,"$title":"Was product confirmed?","$position":{"top":"1228px","left":"853px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"60543dbb-b4ae-4b77-afdf-be8e8aa552a8":{"$contentActions":[{"action":{"$id":"9ad3d7ef-714b-4999-b58e-084b0c232589","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"9cb90903-91da-495e-aeb8-8ea75fe73985","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"9cb90903-91da-495e-aeb8-8ea75fe73985","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"3c84f099-b811-49a8-b30c-f998799b61dd","$typeOfContent":"media","type":"SendMessage","settings":{"id":"9281540a-91e2-4b40-9cba-7380cd59aba9","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://d26oc3sg82pgk3.cloudfront.net/files/media/edit/image/38912/article_full%401x.jpg","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"9281540a-91e2-4b40-9cba-7380cd59aba9","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/jpeg","uri":"https://d26oc3sg82pgk3.cloudfront.net/files/media/edit/image/38912/article_full%401x.jpg","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"2864e515-3580-4aa9-952d-0bd003b00792","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1f497090-6259-4a2f-b694-fcf1bdf21fb5","typeOfStateId":"state","$connId":"con_58","$id":"56b20808-a37f-4b52-9dd4-98a1ec2262bd","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-36bf01b4-3a80-479b-b315-7dee7c24704a","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"60543dbb-b4ae-4b77-afdf-be8e8aa552a8","root":false,"$title":"No","$position":{"top":"1372.25px","left":"655px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2883b3cb-42c2-4079-8825-b11e7863970f":{"$contentActions":[{"action":{"$id":"7cfa3d3f-8548-42a9-86ad-793e77f6d36d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8f1b6611-5d70-4e14-8946-09bb5e97d6d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8f1b6611-5d70-4e14-8946-09bb5e97d6d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"43099915-27ab-4ff9-bc28-13a9f08764d6","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ed37a757-2192-4d89-88aa-91d5c588a3c3","type":"text/plain","content":"Great! I'm sure you will enjoy the <b>{{product}}</b> a lot!","metadata":{}},"$cardContent":{"document":{"id":"ed37a757-2192-4d89-88aa-91d5c588a3c3","type":"text/plain","content":"Great! I'm sure you will enjoy the <b>{{product}}</b> a lot!"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ad7f7d0a-7103-4fd0-a90d-adae55a52412","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"1d1bd117-7e22-42a7-bfbd-a0f550e54446","typeOfStateId":"state","$connId":"con_63","$id":"08c2df73-c531-4ce6-b7bf-527b52c2877e","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-df4030e0-1c70-4e21-98f4-b33b5510cf9d","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"2883b3cb-42c2-4079-8825-b11e7863970f","root":false,"$title":"Yes","$position":{"top":"1372.5px","left":"1042.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1c227206-f7d9-44b8-a5da-63c99ebd79d8":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"67cd7fdd-27bd-4f2c-9a52-974e60e6f1f1","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"492bb893-6928-4909-ad32-ea8278a23e18","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow);\n\tsubflowIds = JSON.parse(subflowIds);\n\t\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateName: '{{state.previous.name}}',\n\t\tstateId: '{{state.previous.id}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.MainMenu\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-a3018677-4d13-47d4-91ff-6d18e1cbcc43","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1c227206-f7d9-44b8-a5da-63c99ebd79d8","root":false,"$title":"Redirect to Main Menu","$position":{"top":"472px","left":"1138px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1d1bd117-7e22-42a7-bfbd-a0f550e54446":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cd9368ef-e327-43a8-81eb-407b9368003b","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"4edf9c4c-2964-4d2f-9b7b-a0eb20e6e2b0","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Purchase\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d32097e4-52c1-4881-8ca0-390a8f06cb52","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1d1bd117-7e22-42a7-bfbd-a0f550e54446","root":false,"$title":"Redirect to Purchase","$position":{"top":"1534px","left":"1043px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1f497090-6259-4a2f-b694-fcf1bdf21fb5":{"$contentActions":[{"action":{"$id":"38df379c-bfa3-4d05-a0aa-02e9f3b519ff","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"642afc3e-1287-47e9-b617-461fe750d854","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"642afc3e-1287-47e9-b617-461fe750d854","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:6062"},{"action":{"$id":"9a8a4a3e-7299-45af-b338-0de978206fcc","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:6063"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"3db5ff1c-fb18-42d1-8967-cf3adf003e9f","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:6064"}],"$conditionOutputs":[{"stateId":"58e7a773-b995-48ab-a01d-6468195a6f0c","typeOfStateId":"state","$connId":"con_68","$id":"92d03830-7126-428e-b79c-d112cb14b5d9","conditions":[{"source":"context","comparison":"equals","values":["Category"],"variable":"userInput@selection","$$hashKey":"object:6094"}],"$invalid":false,"$$hashKey":"object:6072"},{"stateId":"0a8ca33f-7f5e-4f1b-af7c-2094c7a409c4","typeOfStateId":"state","$connId":"con_73","$id":"59f9f51a-c57e-4868-b065-0a8ab04b60e8","conditions":[{"source":"context","comparison":"equals","values":["Subcategory"],"variable":"userInput@selection","$$hashKey":"object:6112"}],"$invalid":false,"$$hashKey":"object:6073"},{"stateId":"03619409-97c9-4969-ad05-053ad210d576","typeOfStateId":"state","$connId":"con_78","$id":"19addc33-1e8d-4e51-9b88-82d2858f0a00","conditions":[{"source":"context","comparison":"equals","values":["Product"],"variable":"userInput@selection","$$hashKey":"object:6130"}],"$invalid":false,"$$hashKey":"object:6074"},{"stateId":"b8ee73da-d9a0-419b-9a15-073e202e6d84","typeOfStateId":"state","$connId":"con_83","$id":"efc2a3e9-00eb-4fcd-a6a7-5ed0bfddd9a3","conditions":[{"source":"context","comparison":"equals","values":["End convesation"],"variable":"userInput@selection","$$hashKey":"object:6146"}],"$invalid":false,"$$hashKey":"object:6075"}],"$enteringCustomActions":[{"$id":"eab94649-f2e8-430a-8d83-c0e42af26c83","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildMenuList({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'So, what would you like to do?',\n\t\toptions: [\n\t\t\t{\n\t\t\t\tsection: 'default',\n\t\t\t\trows: [\n\t\t\t\t\t{ title: 'Change Category', description: '' },\n\t\t\t\t\t{ title: 'Change Subcategory', description: '' },\n\t\t\t\t\t{ title: 'Change Product', description: '' },\n\t\t\t\t\t{ title: 'End Conversation', description: '' }\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"69f36687-26dd-4dca-b1dd-f4c879247a9b","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(change\\\\s*category)$': 'Category',\n\t\t'^(2)$|^(change\\\\s*subcategory)$': 'Subcategory',\n\t\t'^(3)$|^(change\\\\s*product)$': 'Product',\n\t\t'^(4)$|^(end\\\\s*conversation)$': 'End convesation'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"7b09c8e9-2524-4d3c-9ae8-469473189432","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'QuickReplyError', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': 'default'\n\t} \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-346853d3-bdde-4b5e-a1b5-a10f50474199","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-0262a236-fda6-4aa1-af0a-781e33d5a98e","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-b1e06540-ae7c-4b9a-af8a-23595bdc8a87","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"1f497090-6259-4a2f-b694-fcf1bdf21fb5","root":false,"$title":"What would you like to do?","$position":{"top":"1537.25px","left":"655px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"58e7a773-b995-48ab-a01d-6468195a6f0c":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"34b1f34a-5740-4f79-8dac-acf6c4eab0bf","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"1ed00f73-d60c-4745-b24e-f98bf957a731","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.MainMenu\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-68101f96-ecdd-4a02-a004-347711532ee6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"58e7a773-b995-48ab-a01d-6468195a6f0c","root":false,"$title":"Change Category","$position":{"top":"1403.25px","left":"316.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0a8ca33f-7f5e-4f1b-af7c-2094c7a409c4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"decf378d-95e1-496a-9989-c3952ee6660a","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"21f93e2d-2b19-4bcd-ae03-fff4c87d4779","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"0a8ca33f-7f5e-4f1b-af7c-2094c7a409c4","root":false,"$title":"Change Subcategory","$position":{"top":"1548px","left":"316.143px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"03619409-97c9-4969-ad05-053ad210d576":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"aae47635-ee67-4332-b45e-72f39e47022a","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{subcategoryMenuId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"03619409-97c9-4969-ad05-053ad210d576","root":false,"$title":"Change product","$position":{"top":"1694px","left":"312px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b8ee73da-d9a0-419b-9a15-073e202e6d84":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b10d879d-cc3e-423a-8573-2e71975724b8","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"bb20c640-2be9-4554-a1af-88019425a1fb","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Finalization\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-2d7b9c60-de45-4589-ba63-b824d863f82e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"b8ee73da-d9a0-419b-9a15-073e202e6d84","root":false,"$title":"Redirect to Finalization","$position":{"top":"1744px","left":"655px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"productconfirmation","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"fd93213c-00d9-46d2-8a99-046a0b1a43df","typeOfStateId":"state","$connId":"con_8","$id":"770ccbd5-3f7b-47ec-9295-e0a08e2273b4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"64b79f8f-8fdf-4c80-adc3-fedc632cf54c","$typeOfContent":"","type":"TrackEvent","$title":"Service origem","$invalid":false,"settings":{"extras":{},"category":"{{subflow@name}} origem","action":"{{origin}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-32850db1-a8f5-4b6f-86e8-4e687ddead70","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"144px","left":"675px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"112c47c1-ab63-4bfa-af27-8b5d5740da88","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-b48ffd23-bfc1-4ed1-9cb0-2a90103b278e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"154px","left":"1546px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"330px","left":"1755px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_13","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false,"stateId":"end"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"38791e7d-8eb3-493a-b124-0a8e35caf416","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, callerMessage) {\n\tsubflow = JSON.parse(subflow)\n\tcallerMessage = JSON.parse(callerMessage)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id, \n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\tconst destination = setDestination({\n\t\tstateName: callerMessage.from.service,\n\t\tstateId: callerMessage.from.serviceId,\n\t\tsubflowStateName: callerMessage.from.stateName,\n\t\tsubflowStateId: callerMessage.from.stateId\n\t})\n\n\treturn redirect(origin, destination, { isModuleResponse: true });\n}","inputVariables":["subflow","callerMessage"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-d9f82dd7-f120-4b9a-be87-0b2ab036411e","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"154px","left":"1755px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"143px","left":"922px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fd93213c-00d9-46d2-8a99-046a0b1a43df":{"$contentActions":[{"action":{"$id":"f797b4c0-7d51-4453-aef3-0663a8afd662","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"905d7286-6294-4fbe-a9d4-e6fdad60e305","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"905d7286-6294-4fbe-a9d4-e6fdad60e305","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:6883"},{"action":{"$id":"d9f79421-84d0-4dd7-9516-503858bb853c","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:6884"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"c1e1acd3-b1a6-4b00-8662-6c5fc6f54dee","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:6885"}],"$conditionOutputs":[{"stateId":"d5bbc463-6408-4906-8f1c-8c21ecf54b8f","typeOfStateId":"state","$connId":"con_18","$id":"f170bd12-e8c3-4aba-ab82-7e451ddc9882","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"userInput@isValid","$$hashKey":"object:6907"}],"$invalid":false,"$$hashKey":"object:6893"}],"$enteringCustomActions":[{"$id":"c47b3bfe-9e68-4d35-b155-b62ded9d1a30","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run(product) {\n\treturn buildQuickReply({\n\t\tchannel: '{{channel}}',\n\t\ttext: `Do you confirm the product <b>${product}</b> selection?`,\n\t\toptions: [ 'Yes', 'No' ]\n\t})\n}","inputVariables":["product"],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"32853dc7-875a-44c6-b96f-45c6a6134f7a","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(yes)$': 'Yes',\n\t\t'^(2)$|^(no)$': 'No'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"2e72ab68-25fe-4f2b-89d5-a8540920ab63","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'QuickReplyError', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': 'default'\n\t} \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-3802a837-b951-41ca-99ce-4f1185b55299","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-c4d32eda-9c3e-4c00-8d5a-859538c65b86","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-f7835e85-62a0-4c1c-8a99-10a7c9513547","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"fd93213c-00d9-46d2-8a99-046a0b1a43df","root":false,"$title":"Confirm product menu","$position":{"top":"307px","left":"675px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d5bbc463-6408-4906-8f1c-8c21ecf54b8f":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9b64d4ee-87cb-4f32-a43e-fa7eaac86c8f","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"6a796bd6-c2d9-4454-9727-8ead8e2425a3","$typeOfContent":"","type":"SetVariable","$title":"SET wasProductConfirmed","$invalid":false,"settings":{"variable":"wasProductConfirmed","value":"{{userInput@selection}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-e8d7acd6-f081-4c64-9f27-d95f9e17fbbf","label":"SetVariable","background":"#FF4A1E","canChangeBackground":false}],"id":"d5bbc463-6408-4906-8f1c-8c21ecf54b8f","root":false,"$title":"Save module answer","$position":{"top":"491px","left":"675px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}},{"shortName":"purchase","flow":{"onboarding":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"8c447ece-a028-4124-aa3e-d966dfeace69","type":"text/plain","content":"User input"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"b7598244-4148-498b-a4a7-6723cf33edd4","typeOfStateId":"state","$connId":"con_3","$id":"bea2dc50-239c-424a-8e36-c6587e1688e4","conditions":[{"values":[],"source":"context","comparison":"exists","variable":"message@to.subflowStateId"},{"values":["default"],"source":"context","comparison":"notEquals","variable":"message@to.subflowStateId"}],"$invalid":false},{"stateId":"55aed708-d508-4c7f-b840-55f7de0205d4","typeOfStateId":"state","$connId":"con_8","$id":"5db33892-d0ba-4419-a881-5ca1795a4d23","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"64b79f8f-8fdf-4c80-adc3-fedc632cf54c","$typeOfContent":"","type":"TrackEvent","$title":"Service origem","$invalid":false,"settings":{"extras":{},"category":"{{subflow@name}} origem","action":"{{origin}}"},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-9a587edd-a1ea-4072-a1e6-1902ff738758","label":"TrackEvent","background":"#61D36F","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"145px","left":"674px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"f721da4c-1898-4b4a-aed7-817a1fec4991","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"369b2cbe-a364-4144-997a-974de88da360","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-dc798428-7d25-4dae-a616-a80e614078f5","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"fallback","$title":"Exceptions","$position":{"top":"148px","left":"1590px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"end":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a4ae7f2a-eb06-4615-90c5-8789c855fd6d","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"end","end":true,"$title":"End","$position":{"top":"303.778px","left":"1799.56px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1cfaf1d7-a23d-4356-a858-178830d2a3ab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"b20faea7-2eae-43e9-9f4a-261db2073b01","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"typeOfStateId":"state","$connId":"con_13","$id":"5f15f6e7-44c6-486e-9ba0-2ea67597de53","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false,"stateId":"end"}],"$enteringCustomActions":[{"$id":"47b3a282-0f29-408d-8c22-0f58fa5a5120","$typeOfContent":"","type":"ExecuteScript","$title":"SET subflow (disable)","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(stateId, stateName) {\n\treturn disableSubflowMode(stateId, stateName);\n}","inputVariables":["state.id","state.name"],"outputVariable":"subflow","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[{"$id":"483e3d9e-688c-4627-8863-fa055ffacca7","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow) {\n\tsubflow = JSON.parse(subflow)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id, \n\t\tstateId: '{{state.previous.id}}', \n\t\tstateName: '{{state.previous.name}}'\n\t});\n\n\treturn redirect(origin);\n}","inputVariables":["subflow"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[{"values":["default"],"source":"context","comparison":"equals","variable":"redirect"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"end","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-be097968-aeb2-4464-976b-2f3f7aeefdca","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false}],"id":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","root":false,"$title":"Leave Subflow","$position":{"top":"147px","left":"1800px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false,"invalidOutputs":true},"b7598244-4148-498b-a4a7-6723cf33edd4":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"48b64c7d-32e8-4a27-ab76-ce05e2fa9b6d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"{{message@to.subflowStateId}}","$invalid":false,"typeOfStateId":"variable"},"isAiGenerated":false,"$tags":[],"id":"b7598244-4148-498b-a4a7-6723cf33edd4","root":false,"$title":"Go to subflowStateId","$position":{"top":"144px","left":"922px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"55aed708-d508-4c7f-b840-55f7de0205d4":{"$contentActions":[{"action":{"$id":"5a86f55e-dbd4-4a74-9bfe-a7a8386a0c95","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fe9a4ac8-284f-4e0d-b8c1-8059579af8e4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fe9a4ac8-284f-4e0d-b8c1-8059579af8e4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:7521"},{"action":{"$id":"c8981146-c261-41b4-92d0-97de7c09d7e2","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{menu@type}}","rawContent":"{{menu@content}}"}},"$invalid":false,"$$hashKey":"object:7522"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"fa7ea989-8b23-4338-bc07-733584b08790","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:7523"}],"$conditionOutputs":[{"stateId":"8260133c-ca8b-406b-8caf-fb41bdba8cda","typeOfStateId":"state","$connId":"con_18","$id":"bf4a0029-c025-41a3-8ad9-fd3efd585f2b","conditions":[{"source":"context","comparison":"equals","values":["No"],"variable":"userInput@selection","$$hashKey":"object:7549"}],"$invalid":false,"$$hashKey":"object:7531"},{"stateId":"29d5a501-403f-4e67-b20b-7cea4352f806","typeOfStateId":"state","$connId":"con_23","$id":"c2ee5686-d620-447f-a7e1-3f18508e7e6e","conditions":[{"source":"context","comparison":"equals","values":["Yes"],"variable":"userInput@selection","$$hashKey":"object:7565"}],"$invalid":false,"$$hashKey":"object:7532"}],"$enteringCustomActions":[{"$id":"b55e6834-77e0-4dcd-8dd9-75e0bf2060d8","$typeOfContent":"","type":"ExecuteScript","$title":"SET menu","$invalid":false,"settings":{"function":"run","source":"{{components}}\n\nfunction run() {\n\treturn buildQuickReply({\n\t\tchannel: '{{channel}}',\n\t\ttext: 'Confirm the purchase?',\n\t\toptions: [ 'Yes', 'No' ]\n\t})\n}","inputVariables":[],"outputVariable":"menu","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"dba53094-aa74-478c-b7c1-7d900144dd22","$typeOfContent":"","type":"TrackEvent","$title":"Purchase menu exhibition","$invalid":false,"settings":{"extras":{},"category":"Purchase menu exhibition","action":"Exhibition"},"conditions":[]}],"$leavingCustomActions":[{"$id":"fcd6d984-d682-49f6-84ff-b46f01178f9c","$typeOfContent":"","type":"ExecuteScript","$title":"SET userInput","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(input) {\n\treturn processUserInput(input, {\n\t\t'^(1)$|^(yes|ok)$': 'Yes',\n\t\t'^(2)$|^(no)$': 'No'\n\t})\n}","inputVariables":["input.content"],"outputVariable":"userInput","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"78bbad26-00e3-45a2-86cb-1ba620bea7a7","$typeOfContent":"","type":"TrackEvent","$title":"Purchase menu selection","$invalid":false,"settings":{"extras":{},"category":"Purchase menu selection","action":"{{userInput@selection}}"},"conditions":[]},{"$id":"840fd3a0-d2c3-494a-b915-1b2209c5d393","$typeOfContent":"","type":"TrackEvent","$title":"Purchase menu unexpected input","$invalid":false,"settings":{"extras":{},"category":"Purchase menu unexpected input","action":"{{input.content}}"},"conditions":[{"values":["false"],"source":"context","comparison":"equals","variable":"userInput@isValid"}]},{"$id":"09050886-cc60-474c-8269-a2b5662eb9f5","$typeOfContent":"","type":"ExecuteScript","$title":"SET error","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn {\n\t\t'id': 'QuickReplyError', \n\t\t'hasAIValidation': false,\n\t\t'hasSmalltalksValidation': true,\n\t\t'hasGlobalRegexValidation': true,\n\t\t'customErrorMessage': 'default'\n\t} \n}","inputVariables":[],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"id":"blip-tag-8b753966-aeaa-4e4c-bbb7-72c496b62f15","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-51ae0aee-65f5-49b8-87cb-b1b467fb9ada","label":"TrackEvent","background":"#61D36F","canChangeBackground":false},{"id":"blip-tag-8c3ea387-b52f-4cda-a9ff-1cb0934d44c6","label":"SendMessage","background":"#EE82EE","canChangeBackground":false},{"id":"blip-tag-e9f49b07-b35e-4c64-bf29-06e51ec04c18","label":"UserInput","background":"#000000","canChangeBackground":false}],"id":"55aed708-d508-4c7f-b840-55f7de0205d4","root":false,"$title":"QuickReply Component","$position":{"top":"319px","left":"674.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"29d5a501-403f-4e67-b20b-7cea4352f806":{"$contentActions":[{"action":{"$id":"282bc270-476c-431f-9cf5-84ba30c0096c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4c7b0a97-6bab-4494-b372-68cb42a9f78c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4c7b0a97-6bab-4494-b372-68cb42a9f78c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"63b8d6ed-b8a9-420c-a3d4-58cd048f7b3b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"68493333-c930-43dc-915d-f7ecb1da42fb","type":"text/plain","content":"Nice!","metadata":{}},"$cardContent":{"document":{"id":"68493333-c930-43dc-915d-f7ecb1da42fb","type":"text/plain","content":"Nice!"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"65bc9266-6ae1-4aa8-826e-3f61c974d2ec","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"0d015a3f-3ff4-4420-88b9-c48db3f5127e","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Desk\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-116c0a99-460b-4178-be8c-744cdeafddd6","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-e866143b-4f92-4c3f-823e-14b476d41a55","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"29d5a501-403f-4e67-b20b-7cea4352f806","root":false,"$title":"Yes","$position":{"top":"483px","left":"841.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8260133c-ca8b-406b-8caf-fb41bdba8cda":{"$contentActions":[{"action":{"$id":"64bbc239-cec2-43a3-8ab5-3bcf7e648baa","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ef3cee34-0fb2-4954-b452-5eaf1a94b024","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ef3cee34-0fb2-4954-b452-5eaf1a94b024","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"6fe66226-1599-4dcd-84ce-c1f07b2eb0ea","$typeOfContent":"text","type":"SendMessage","settings":{"id":"fe6ef13f-b07e-4900-9f64-34d5be9a9106","type":"text/plain","content":"Ok! I will finish this conversation...","metadata":{}},"$cardContent":{"document":{"id":"fe6ef13f-b07e-4900-9f64-34d5be9a9106","type":"text/plain","content":"Ok! I will finish this conversation..."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"57df644c-9ba0-4100-8c96-0e5606c1b901","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"a377a3a7-850a-4a99-a8f0-16ab658e2f07","$typeOfContent":"","type":"ExecuteScript","$title":"SET redirect","$invalid":false,"settings":{"function":"run","source":"{{globalScripts}}\n\nfunction run(subflow, subflowIds) {\n\tsubflow = JSON.parse(subflow)\n\tsubflowIds =  JSON.parse(subflowIds)\n\n\tconst origin = setOrigin({\n\t\tservice: subflow.name,\n\t\tserviceId: subflow.id,\n\t\tstateId: '{{state.previous.id}}',\n\t\tstateName: '{{state.previous.name}}'\n\t})\n\n\tconst destination = setDestination({\n\t\tstateId: subflowIds.Finalization\n\t})\n\n\treturn redirect(origin, destination)\n}","inputVariables":["subflow","subflowIds"],"outputVariable":"redirect","LocalTimeZoneEnabled":false},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"1cfaf1d7-a23d-4356-a858-178830d2a3ab","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"id":"blip-tag-280b792b-fcde-4ab0-9564-1455beb3af17","label":"ExecuteScript","background":"#FF961E","canChangeBackground":false},{"id":"blip-tag-3369d795-250d-4948-8c90-3a3aaa717a2c","label":"SendMessage","background":"#EE82EE","canChangeBackground":false}],"id":"8260133c-ca8b-406b-8caf-fb41bdba8cda","root":false,"$title":"No","$position":{"top":"483px","left":"521.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"configuration":{"builder:minimumIntentScore":"0.5","builder:stateTrack":"false","builder:#localTimeZone":"E.South America Standard Time"}}]}
